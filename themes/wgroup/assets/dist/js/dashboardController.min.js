"use strict";app.factory("DashboardFilterService",function(){var t={},r=null,n=null;return t.setFirstCustomer=function(t){r=t},t.getFirstCustomer=function(){return r},t.setSecondCustomer=function(t){n=t},t.getSecondCustomer=function(){return n},t.getCurrentCustomer=function(){return r?n?n:r:null},t});
"use strict";app.controller("dashboardDiagnosticEconomicGroupCtrl",["$scope","$stateParams","$log","DTOptionsBuilder","DTColumnBuilder","DTColumnDefBuilder","$compile","toaster","$state","$rootScope","$timeout","$http","SweetAlert","ListService",function(o,r,e,t,n,i,a,c,u,l,s,m,d,f){function p(){var r={customerId:G},e=[{name:"customer_has_economic_group",value:null,criteria:r},{name:"dashboard_year",value:null}];f.getDataList(e).then(function(r){o.economicGroupList=r.data.data.customerHasEconomicGroupList,o.yearList=r.data.data.yearList},function(r){o.status="Unable to load customer data: "+r.message})}function y(){var r={parentId:o.filter.economicGroup.value},e=[{name:"customer_economic_group",value:null,criteria:r}];f.getDataList(e).then(function(r){o.customerList=r.data.data.customerEconomicGroupList},function(r){o.status="Unable to load customer data: "+r.message})}function v(){var r={parent_id:o.filter.economicGroup?o.filter.economicGroup.value:0,year:o.filter.year?o.filter.year.value:0};return m({method:"POST",url:"api/diagnostic/report-economic-group-indicator",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(r)}).then(function(r){s(function(){o.indicators=r.data.result})})["catch"](function(o){e.error(o),d.swal("Error del servidor","Ha ocurrido un error cargando los datos!","error")})["finally"](function(){})}function g(){var r={parent_id:o.filter.economicGroup?o.filter.economicGroup.value:0,customer_id:o.filter.customer?o.filter.customer.value:0,year:o.filter.year?o.filter.year.value:0};return m({method:"POST",url:"api/diagnostic/report-economic-group-customer-indicator",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(r)}).then(function(r){s(function(){o.indicators=r.data.result})})["catch"](function(o){e.error(o),d.swal("Error del servidor","Ha ocurrido un error cargando los datos!","error")})["finally"](function(){})}o.isAgent=l.isAgent(),o.isAdmin=l.isAdmin(),o.isCustomer=l.isCustomer();var G=o.isCustomer?l.currentUser().company:null;o.filter={economicGroup:null,customer:null,year:null},o.economicGroupList=[],o.customerList=[],o.yearList=[],o.indicators=null,p(),o.onSelectEconomicGroup=function(){o.filter.economicGroup&&(o.filter.customer=null,y(),v())},o.onClearEconomicGroup=function(){o.filter.economicGroup=null,o.filter.customer=null,o.filter.year=null,o.customerList=[],o.indicators=null},o.onSelectCustomer=function(){g()},o.onClearCustomer=function(){o.filter.customer=null,null!=o.filter.economicGroup&&v()},o.onSelectYear=function(){null!=o.filter.customer?g():v()},o.onClearYear=function(){o.filter.year=null,null!=o.filter.customer?g():v()}}]);
"use strict";app.controller("dashboardDiagnosticContractorCtrl",["$scope","$stateParams","$log","DTOptionsBuilder","DTColumnBuilder","DTColumnDefBuilder","$compile","toaster","$state","$rootScope","$timeout","$http","SweetAlert","ListService",function(t,r,e,o,a,n,i,c,l,u,s,d,f,m){function p(){var r={customerId:g},e=[{name:"customer_employeer",value:null,criteria:r},{name:"dashboard_year",value:null}];m.getDataList(e).then(function(r){t.customerList=r.data.data.customerEmployeerList,t.yearList=r.data.data.yearList},function(r){t.status="Unable to load customer data: "+r.message})}function y(){var r={parentId:t.filter.customer.value},e=[{name:"customer_contractor",value:null,criteria:r}];m.getDataList(e).then(function(r){t.contractorList=r.data.data.customerContractorList},function(r){t.status="Unable to load customer data: "+r.message})}function v(){var r={parent_id:t.filter.customer?t.filter.customer.value:0,year:t.filter.year?t.filter.year.value:0};return d({method:"POST",url:"api/diagnostic/report-contracting-indicator",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(r)}).then(function(r){s(function(){t.indicators=r.data.result})})["catch"](function(t){e.error(t),f.swal("Error del servidor","Ha ocurrido un error cargando los datos!","error")})["finally"](function(){})}function C(){var r={parent_id:t.filter.customer?t.filter.customer.value:0,customer_id:t.filter.contractor?t.filter.contractor.value:0,year:t.filter.year?t.filter.year.value:0};return d({method:"POST",url:"api/diagnostic/report-contracting-customer-indicator",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(r)}).then(function(r){s(function(){t.indicators=r.data.result})})["catch"](function(t){e.error(t),f.swal("Error del servidor","Ha ocurrido un error cargando los datos!","error")})["finally"](function(){})}t.isAgent=u.isAgent(),t.isAdmin=u.isAdmin(),t.isCustomer=u.isCustomer();var g=t.isCustomer?u.currentUser().company:null;t.filter={customer:null,contractor:null,year:null},t.customerList=[],t.contractorList=[],t.yearList=[],p(),t.onSelectCustomer=function(){t.filter.customer&&(t.filter.contractor=null,y(),v())},t.onClearCustomer=function(){t.filter.customer=null,t.filter.contractor=null,t.filter.year=null,t.contractorList=[],t.indicators=null},t.onSelectContractor=function(){C()},t.onClearContractor=function(){t.filter.contractor=null,null!=t.filter.customer&&v()},t.onSelectYear=function(){null!=t.filter.contractor?C():v()},t.onClearYear=function(){t.filter.year=null,null!=t.filter.contractor?C():v()}}]);
"use strict";app.controller("dashboardDiagnosticCustomerCtrl",["$scope","$stateParams","$log","DTOptionsBuilder","DTColumnBuilder","DTColumnDefBuilder","$compile","toaster","$state","$rootScope","$timeout","$http","SweetAlert","ChartService","$aside","$filter","ListService","DashboardFilterService",function(t,e,o,n,r,i,a,s,u,l,c,m,d,p,C,h,f,g){function w(){var e={customerId:S,isAdmin:t.isAdmin,isAgent:t.isAgent,isCustomer:t.isCustomer,userId:l.currentUser().id},o=[{name:"customer_employeer",value:null,criteria:e}];f.getDataList(o).then(function(e){t.customerList=e.data.data.customerEmployeerList},function(e){t.status="Unable to load customer data: "+e.message})}function D(){var e=[{name:"chart_line_options",criteria:null},{name:"chart_pie_options",criteria:null}];p.getDataChart(e).then(function(e){t.chart.pie.options=e.data.data.chartPieOptions,t.chart.pie.options.legend.position="bottom",t.chart.line.options=e.data.data.chartLineOptions,t.chart.line.options.legend.position="bottom"},function(e){t.status="Unable to load customer data: "+e.message})}function O(){var e={customerId:S,parentId:t.filter.customer.value,isAdmin:t.isAdmin,isAgent:t.isAgent,isCustomer:t.isCustomer},o=[{name:"customer_contractor",value:null,criteria:e},{name:"customer_information_relationships",value:null,criteria:e}];f.getDataList(o).then(function(e){t.contractorList=e.data.data.customerContractorList,t.contractorList=e.data.data.customerContractorList,t.customerInformation=e.data.data.customerInformationRelationships,t.isCustomer&&t.filter.customer.value!=S&&(t.filter.contractor=t.contractorList.length>0?t.contractorList[0]:null,g.setSecondCustomer(t.filter.contractor),t.$broadcast("onBroadcastChangeFilterCustomer"))},function(e){t.status="Unable to load customer data: "+e.message})}t.isAgent=l.isAgent(),t.isAdmin=l.isAdmin(),t.isCustomer=l.isCustomer();var S=t.isCustomer?l.currentUser().company:null;t.mainCustomerId=t.isCustomer?l.currentUser().company:null,t.filter={customer:null,contractor:null},t.chart={doughnut:{options:null},bar:{options:null},line:{options:null},pie:{options:null},data:{minimalStandarProgressPie:null,minimalStandarComparativeLineChart:null,roadSafetyChartLine:null}},t.customerList=[],t.contractorList=[],t.customerInformation=null,t.isOpenGridDetailCustomerInformation=!0,w(),D(),t.onSelectCustomer=function(){t.filter.customer&&(t.filter.contractor=null,t.isOpenGridDetailCustomerInformation=!0,g.setFirstCustomer(t.filter.customer),g.setSecondCustomer(null),(!t.isCustomer||t.isCustomer&&t.filter.customer.value==S)&&t.$broadcast("onBroadcastChangeFilterCustomer"),O())},t.onSelectContractor=function(){g.setSecondCustomer(t.filter.contractor),t.$broadcast("onBroadcastChangeFilterCustomer")},t.onClearContractor=function(){t.filter.contractor=null,g.setSecondCustomer(null),t.$broadcast("onBroadcastChangeFilterCustomer")},t.onShowDetailCustomerInfo=function(){t.isOpenGridDetailCustomerInformation=!t.isOpenGridDetailCustomerInformation,t.dtInstanceCustomerRelationshipGrid.reloadData()},t.dtInstanceCustomerRelationshipGridCallback=function(e){t.dtInstanceCustomerRelationshipGrid=e},t.dtOptionsCustomerRelationshipGrid=n.newOptions().withBootstrap().withOption("responsive",!0).withOption("ajax",{data:function(e){return e.parentId=t.filter.customer.value,JSON.stringify(e)},url:"api/customer-contractor/customer-relationships",type:"POST"}).withDataProp("data").withOption("order",[[0,"desc"]]).withOption("serverSide",!0).withOption("processing",!0).withOption("fnPreDrawCallback",function(){return 0==t.isOpenGridDetailCustomerInformation}).withPaginationType("full_numbers").withOption("createdRow",function(e){a(angular.element(e).contents())(t)}),t.dtColumnsCustomerRelationshipGrid=[r.newColumn("documentNumber").withTitle("Nro Documento"),r.newColumn("businessName").withTitle("Razón Social"),r.newColumn("relationship").withTitle("Relación"),r.newColumn("status").withTitle("Estado")]}]);
app.controller("TopManagementTabsCtrl",["$scope","$rootScope","$state",function(a,e,t){e.availableUserTopManagement||t.go("app.clientes.list",{reload:!0}),a.switchTab=function(e){a.activeTab=e}}]);
"use strict";app.controller("dashboardTopManagementCtrl",["$scope","$stateParams","$log","DTOptionsBuilder","DTColumnBuilder","DTColumnDefBuilder","$compile","toaster","$state","$rootScope","$timeout","$http","SweetAlert","ChartService","$filter","ListService","ngNotify","$aside",function(t,e,a,n,i,o,s,r,l,c,p,d,u,m,h,w,f,g){function T(){var e=[{name:"export_url",value:null},{name:"dashboard_top_management_periods",value:null},{name:"customer_vr_employee_satisfactions_answers_types",value:null}];w.getDataList(e).then(function(e){t.exportUrl=e.data.data.exportUrl.item,t.periodList=e.data.data.dashboardTopManagementPeriods,t.santisfactionAnswerTypes=e.data.data.customerVrEmployeeSatisfactionsAnswersTypes,t.periodList.length>0&&(t.filter.period=t.periodList[0],y())},function(e){t.status="Unable to load customer data: "+e.message})}function y(){var e={period:t.filter.period?t.filter.period.value:-1},a=[{name:"chart_line_options",criteria:null},{name:"chart_bar_options",criteria:null},{name:"chart_bar_with_scales_options",criteria:null},{name:"chart_pie_options",criteria:null},{name:"dashboard_top_management_cost_historical",criteria:e}];m.getDataChart(a).then(function(e){t.chart.line.options=angular.copy(e.data.data.chartLineOptions),t.chart.line.options.legend.position="bottom",t.chart.line.options.scaleShowValues=!0,t.chart.line.options.scales={xAxes:[{ticks:{autoSkip:!1}}],yAxes:[{ticks:{beginAtZero:!0}}]},t.chart.lineFormatMoney.options=angular.copy(e.data.data.chartLineOptions),t.chart.lineFormatMoney.options.legend.position="bottom",t.chart.lineFormatMoney.options.scales.yAxes=[{ticks:{callback:function(t){return"$ "+h("number")(t,0)}}}],t.chart.lineFormatMoney.options.tooltips={callbacks:{label:function(t,e){var a=h("number")(t.yLabel,2),n=e.datasets[t.datasetIndex].label;return n+":  $ "+a}}},t.chart.bar.options=angular.copy(e.data.data.chartBarOptions),t.chart.bar.options.legend.position="bottom",t.chart.barFormatMoney.options=angular.copy(e.data.data.chartBarOptions),t.chart.barFormatMoney.options.legend.position="bottom",t.chart.barFormatMoney.options.scales.yAxes=[{ticks:{autoSkip:!1,min:0,callback:function(t){return"$ "+h("number")(t,0)}}}],t.chart.barFormatMoney.options.tooltips={callbacks:{label:function(t,e){var a=h("number")(t.yLabel,2),n=e.datasets[t.datasetIndex].label;return n+":  $ "+a}}},t.chart.barWithScales.options=angular.copy(e.data.data.chartBarOptionsWithScales),t.chart.barWithScalesMoney.options=angular.copy(e.data.data.chartBarOptionsWithScales),t.chart.barWithScalesMoney.options.legend.display=!1,t.chart.barWithScalesMoney.options.scales.yAxes=[{ticks:{callback:function(t){return"$ "+h("number")(t,0)}}}],t.chart.barWithScalesMoney.options.tooltips={callbacks:{title:function(t,e){var a=t[0].datasetIndex;return e.datasets[a].stack},label:function(t,e){var a=h("number")(t.yLabel,2),n=e.datasets[t.datasetIndex].label;if("Ejecutado"==n){var i=e.datasets[t.datasetIndex].stack,o=0;h("filter")(e.datasets,{stack:i}).forEach(function(t){t.data.forEach(function(t){o+=parseFloat(t)})});var s=h("number")(o,2);return n+":  $ "+a+" Programado: "+s}return n+":  $ "+a}}},t.chart.pie.options=e.data.data.chartPieOptions,t.chart.pie.options.legend.position="bottom",t.chart.data.dashboardTopManagementCostHistorical=e.data.data.dashboardTopManagementCostHistorical,t.chart.data.dashboardTopManagementCostTotalCurrentYear=e.data.data.dashboardTopManagementCostTotalCurrentYear,t.chart.data.dashboardTopManagementCostTypesByStates=e.data.data.dashboardTopManagementCostTypesByStates},function(e){t.status="Unable to load customer data: "+e.message})}function O(){var e=[{name:"dashboard_top_management_cost_summary",criteria:t.filters}];m.getDataChart(e).then(function(e){t.chart.data.dashboardTopManagementCostByType=e.data.data.dashboardTopManagementCostByType,t.chart.data.dashboardTopManagementCostByConcept=e.data.data.dashboardTopManagementCostByConcept,t.chart.data.dashboardTopManagementCostByClassification=e.data.data.dashboardTopManagementCostByClassification,t.chart.data.dashboardTopManagementCostByMonths=e.data.data.dashboardTopManagementCostByMonths,t.chart.data.dashboardTopManagementExperiencesByMoths=e.data.data.dashboardTopManagementExperiencesByMoths,t.chart.data.dashboardTopManagementSatisfactionByExperience=e.data.data.dashboardTopManagementSatisfactionByExperience,t.chart.data.registeredVsParticipantsAllClientsAndPeriods=e.data.data.registeredVsParticipantsAllClientsAndPeriods,t.chart.data.registeredVsParticipantsByMonths=e.data.data.registeredVsParticipantsByMonths,t.chart.data.dashboardTopManagementPerformanceByConcultant=e.data.data.dashboardTopManagementPerformanceByConcultant},function(e){t.status="Unable to load customer data: "+e.message})}function C(e){return e.startDate=t.filters.startDate,e.endDate=t.filters.endDate,e.type=t.filters.type?t.filters.type.value:null,e.concept=t.filters.concept?t.filters.concept.value:null,e.classification=t.filters.classification?t.filters.classification.value:null,e.customer=t.filters.customer?t.filters.customer.id:null,e.administrator=t.filters.administrator?t.filters.administrator.id:null,e}t.typeList=c.parameters("project_type"),t.performanceLevelList=c.parameters("project_performance_level"),t.showIndicators=!1,t.customerList=[],t.administratorList=[],t.periodList=[],t.santisfactionAnswerTypes=null,t.filter={performanceLevel:null},t.init=function(){t.filters={startDate:null,endDate:null,type:null,concept:null,classification:null,customer:null,administrator:null,period:null},t.hideGrids()},t.hideGrids=function(){t.isOpenGridHistoricalSales=!0,t.isOpenGridTotalSales=!0,t.isOpenGridSalesByType=!0,t.isOpenGridSalesByConcept=!0,t.isOpenGridSalesByClassification=!0,t.isOpenGridExperiencesByMonths=!0,t.isOpenGridSatisfactionByExperience=!0,t.isOpenGridRegisteredVsParticipants=!0,t.isOpenGridPerformanceByConsultant=!0,t.isOpenGridProgrammedVsExecutedSales=!0},t.datePickerConfig={culture:"es-CO",format:"dd/MM/yyyy"},t.chart={line:{options:null},lineFormatMoney:{options:null},bar:{options:null},barFormatMoney:{options:null},barWithScalesMoney:{options:null},barWithScales:{options:null},pie:{options:null},data:{dashboardTopManagementCostHistorical:null,dashboardTopManagementCostTotalCurrentYear:null,dashboardTopManagementCostTypesByStates:null,dashboardTopManagementCostTypesByStates2:null,dashboardTopManagementCostByMonths:null,dashboardTopManagementCostByType:null,dashboardTopManagementCostByConcept:null,dashboardTopManagementCostByClassification:null,dashboardTopManagementExperiencesByMoths:null,dashboardTopManagementSatisfactionByExperience:null,registeredVsParticipantsByMonths:null,registeredVsParticipantsAllClientsAndPeriods:null,dashboardTopManagementPerformanceByConcultant:null}},t.init(),T(),y(),t.dtInstanceTopManagementPerformanceLevel={},t.dtOptionsTopManagementPerformanceLevel=n.newOptions().withBootstrap().withOption("responsive",!0).withOption("ajax",{data:function(e){return e.startDate=t.filters.startDate,e.endDate=t.filters.endDate,e.levelCompliance=null==t.filter.performanceLevel?null:t.filter.performanceLevel.item,t.filters.customer&&(e.customerId=t.filters.customer.id),JSON.stringify(e)},url:"api/dashboard/top-management/performance-level",contentType:"application/json",type:"POST"}).withDataProp("data").withOption("order",[[0,"desc"]]).withOption("serverSide",!0).withOption("processing",!0).withOption("fnPreDrawCallback",function(){return null!=t.filters.startDate&&null!=t.filters.endDate}).withOption("fnDrawCallback",function(){b()}).withPaginationType("full_numbers").withOption("createdRow",function(e){s(angular.element(e).contents())(t)}),t.dtColumnsTopManagementPerformanceLevel=[i.newColumn(null).withTitle("Acciones").withOption("width",120).notSortable().renderWith(function(t){var e="",a='<a class="btn btn-primary btn-xs exportRow lnk" href="#" uib-tooltip="Exportar" data-id="'+t.id+'"  >   <i class="fa fa-download"></i></a> ';return e+=a}),i.newColumn("consultant").withTitle("Asesor"),i.newColumn("availability").withTitle("Disponibilidad"),i.newColumn("assigned").withTitle("Asignado"),i.newColumn("executed").withTitle("Ejecutado"),i.newColumn("percentCompliance").withTitle("% Cumplimiento"),i.newColumn("levelCompliance").withTitle("Nivel de Cumplimiento").renderWith(function(t){var e="";switch(t){case"Muy Alto":e="bg-level-high-green";break;case"Alto":e="bg-level-green";break;case"Medio":e="bg-level-medium";break;case"Bajo":default:e="bg-level-low"}return'<span class="label '+e+'">'+t+"</span>"})],t.dtInstanceSalesHistoricalGridCallback=function(e){t.dtInstanceSalesHistoricalGrid=e},t.dtOptionsSalesHistoricalGrid=n.newOptions().withBootstrap().withOption("responsive",!0).withOption("ajax",{data:function(e){return null!=t.filter.period&&(e.period=t.filter.period.vlaue),JSON.stringify(e)},url:"api/dashboard/top-management/sales-historical",contentType:"application/json",type:"POST"}).withDataProp("data").withOption("order",[[0,"desc"]]).withOption("searching",!1).withOption("ordering",!1).withOption("serverSide",!0).withOption("processing",!0).withOption("fnPreDrawCallback",function(){return 1==t.isOpenGridHistoricalSales}).withOption("paginate",!1).withPaginationType("full_numbers").withOption("createdRow",function(e){s(angular.element(e).contents())(t)}),t.dtColumnsSalesHistoricalGrid=[i.newColumn("year").withTitle("AÑO"),i.newColumn("sst").withTitle("SST"),i.newColumn("vr").withTitle("REALIDAD VIRTUAL"),i.newColumn("sylogi").withTitle("SYLOGI"),i.newColumn("total").withTitle("TOTAL VENTAS")];var b=function(){$("#dtTopManagementPerformanceLevel a.exportRow").on("click",function(){var e=$(this).data("id"),n={userId:c.currentUser().id,id:e,startDate:t.filters.startDate,endDate:t.filters.endDate};t.filters.customer&&(n.customerId=t.filters.customer.id);var i={data:Base64.encode(JSON.stringify(n))};return d({method:"POST",url:t.exportUrl+"api/v1/customer-vr-satisfaction-export",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(i)}).then(function(e){var a=t.exportUrl+"storage/"+e.data.filename,n='<a class="btn btn-wide btn-default" href="'+a+'" target="_self"><i class="glyphicon glyphicon-download"></i> Descargar el reporte</a>';e.data.isQueue&&(a="app/user/messages",n=e.data.message+' <a  class="btn btn-wide btn-default" href="'+a+'" translate="Ver mensajes"> Ver mensajes </a>'),f.set(n,{position:"bottom",sticky:!0,type:e.data.isQueue?"info":"success",button:!0,html:!0})})["catch"](function(t){a.error(t),null!=response.data&&void 0!==response.data.message?f.set(response.data.message,{position:"bottom",sticky:!0,type:"error",button:!0,html:!0}):f.set("Lo sentimos, ha ocurrido un error en la generación del reporte",{position:"bottom",sticky:!0,type:"error",button:!0,html:!0})})})};t.reloadData=function(){t.dtInstanceTopManagementPerformanceLevel.reloadData()},t.dtInstanceTopManagementTotalSalesCallback=function(e){t.dtInstanceTopManagementTotalSales=e},t.dtOptionsTopManagementTotalSales=n.newOptions().withBootstrap().withOption("responsive",!0).withOption("ajax",{data:function(t){return t=C(t),JSON.stringify(t)},url:"api/dashboard/top-management/total-sales",contentType:"application/json",type:"POST"}).withDataProp("data").withOption("searching",!1).withOption("ordering",!1).withOption("serverSide",!0).withOption("processing",!0).withOption("fnPreDrawCallback",function(){return 1==t.showIndicators&&0==t.isOpenGridTotalSales}).withPaginationType("full_numbers").withOption("createdRow",function(e){s(angular.element(e).contents())(t)}),t.dtColumnsTopManagementTotalSales=[i.newColumn("period").withTitle("Periodo"),i.newColumn("programmed").withTitle("Programado"),i.newColumn("executed").withTitle("Ejecutado"),i.newColumn("balance").withTitle("Balance")],t.dtInstanceTopManagementSalesByTypeCallback=function(e){t.dtInstanceTopManagementSalesByType=e},t.dtOptionsTopManagementSalesByType=n.newOptions().withBootstrap().withOption("responsive",!0).withOption("ajax",{data:function(t){return t=C(t),JSON.stringify(t)},url:"api/dashboard/top-management/sales-by-type",contentType:"application/json",type:"POST"}).withDataProp("data").withOption("searching",!1).withOption("ordering",!1).withOption("serverSide",!0).withOption("processing",!0).withOption("fnPreDrawCallback",function(){return 1==t.showIndicators&&0==t.isOpenGridSalesByType}).withPaginationType("full_numbers").withOption("createdRow",function(e){s(angular.element(e).contents())(t)}),t.dtColumnsTopManagementSalesByType=[i.newColumn("period").withTitle("Periodo"),i.newColumn("group").withTitle("Tipo"),i.newColumn("sales").withTitle("Total Ventas")],t.dtInstanceTopManagementSalesByConceptCallback=function(e){t.dtInstanceTopManagementSalesByConcept=e},t.dtOptionsTopManagementSalesByConcept=n.newOptions().withBootstrap().withOption("responsive",!0).withOption("ajax",{data:function(t){return t=C(t),JSON.stringify(t)},url:"api/dashboard/top-management/sales-by-concept",contentType:"application/json",type:"POST"}).withDataProp("data").withOption("searching",!1).withOption("ordering",!1).withOption("serverSide",!0).withOption("processing",!0).withOption("fnPreDrawCallback",function(){return 1==t.showIndicators&&0==t.isOpenGridSalesByConcept}).withPaginationType("full_numbers").withOption("createdRow",function(e){s(angular.element(e).contents())(t)}),t.dtColumnsTopManagementSalesByConcept=[i.newColumn("period").withTitle("Periodo"),i.newColumn("group").withTitle("Concepto"),i.newColumn("sales").withTitle("Total Ventas")],t.dtInstanceTopManagementSalesByClassificationCallback=function(e){t.dtInstanceTopManagementSalesByClassification=e},t.dtOptionsTopManagementSalesByClassification=n.newOptions().withBootstrap().withOption("responsive",!0).withOption("ajax",{data:function(t){return t=C(t),JSON.stringify(t)},url:"api/dashboard/top-management/sales-by-classification",contentType:"application/json",type:"POST"}).withDataProp("data").withOption("searching",!1).withOption("ordering",!1).withOption("serverSide",!0).withOption("processing",!0).withOption("fnPreDrawCallback",function(){return 1==t.showIndicators&&0==t.isOpenGridSalesByClassification}).withPaginationType("full_numbers").withOption("createdRow",function(e){s(angular.element(e).contents())(t)}),t.dtColumnsTopManagementSalesByClassification=[i.newColumn("period").withTitle("Periodo"),i.newColumn("group").withTitle("Clasificación"),i.newColumn("sales").withTitle("Total Ventas")],t.dtInstanceTopManagementExperienesByMonthsCallback=function(e){t.dtInstanceTopManagementExperienesByMonths=e},t.dtOptionsTopManagementExperienesByMonths=n.newOptions().withBootstrap().withOption("responsive",!0).withOption("ajax",{data:function(t){return t=C(t),JSON.stringify(t)},url:"api/dashboard/top-management/experiencies-by-months",contentType:"application/json",type:"POST"}).withDataProp("data").withOption("searching",!1).withOption("ordering",!1).withOption("serverSide",!0).withOption("processing",!0).withOption("fnPreDrawCallback",function(){return 1==t.showIndicators&&0==t.isOpenGridExperiencesByMonths}).withPaginationType("full_numbers").withOption("createdRow",function(e){s(angular.element(e).contents())(t)}),t.dtColumnsTopManagementExperienesByMonths=[i.newColumn("period").withTitle("Periodo"),i.newColumn("experience").withTitle("Experiencia"),i.newColumn("sales").withTitle("Total Ventas")],t.dtInstanceTopManagementAmountBySatisfactionLevelCallback=function(e){t.dtInstanceTopManagementAmountBySatisfactionLevel=e},t.dtOptionsTopManagementAmountBySatisfactionLevel=n.newOptions().withBootstrap().withOption("responsive",!0).withOption("ajax",{data:function(t){return t=C(t),JSON.stringify(t)},url:"api/dashboard/top-management/amount-by-satistaction-level",contentType:"application/json",type:"POST"}).withDataProp("data").withOption("searching",!1).withOption("ordering",!1).withOption("serverSide",!0).withOption("processing",!0).withOption("fnPreDrawCallback",function(){return 1==t.showIndicators&&0==t.isOpenGridSatisfactionByExperience}).withPaginationType("full_numbers").withOption("createdRow",function(e){s(angular.element(e).contents())(t)}),t.dtColumnsTopManagementAmountBySatisfactionLevel=[i.newColumn("period").withTitle("Periodo"),i.newColumn("experience").withTitle("Experiencia"),i.newColumn("excelente").withTitle("Excelente"),i.newColumn("bueno").withTitle("Bueno"),i.newColumn("regular").withTitle("Regular"),i.newColumn("malo").withTitle("Malo")],t.dtInstanceTopManagementRegisteredVsParticipantsCallback=function(e){t.dtInstanceTopManagementRegisteredVsParticipants=e},t.dtOptionsTopManagementRegisteredVsParticipants=n.newOptions().withBootstrap().withOption("responsive",!0).withOption("ajax",{data:function(t){return t=C(t),JSON.stringify(t)},url:"api/dashboard/top-management/registered-vs-participants",contentType:"application/json",type:"POST"}).withDataProp("data").withOption("searching",!1).withOption("ordering",!1).withOption("serverSide",!0).withOption("processing",!0).withOption("fnPreDrawCallback",function(){return 1==t.showIndicators&&0==t.isOpenGridRegisteredVsParticipants}).withPaginationType("full_numbers").withOption("createdRow",function(e){s(angular.element(e).contents())(t)}),t.dtColumnsTopManagementRegisteredVsParticipants=[i.newColumn("period").withTitle("Periodo"),i.newColumn("amountParticipants").withTitle("Participantes"),i.newColumn("amountSurveyed").withTitle("Encuestados")],t.dtInstanceTopManagementPerformanceByConsultantCallback=function(e){t.dtInstanceTopManagementPerformanceByConsultant=e},t.dtOptionsTopManagementPerformanceByConsultant=n.newOptions().withBootstrap().withOption("responsive",!0).withOption("ajax",{data:function(t){return t=C(t),JSON.stringify(t)},url:"api/dashboard/top-management/performance-by-consultant",contentType:"application/json",type:"POST"}).withDataProp("data").withOption("searching",!1).withOption("ordering",!1).withOption("serverSide",!0).withOption("processing",!0).withOption("fnPreDrawCallback",function(){return 1==t.showIndicators&&0==t.isOpenGridPerformanceByConsultant}).withPaginationType("full_numbers").withOption("createdRow",function(e){s(angular.element(e).contents())(t)}),t.dtColumnsTopManagementPerformanceByConsultant=[i.newColumn("consultant").withTitle("Asesor"),i.newColumn("assigned").withTitle("Asignado"),i.newColumn("executed").withTitle("Ejecutado"),i.newColumn("balance").withTitle("Balance")],t.dtInstanceTopManagementProgrammedVsExecutedSalesCallback=function(e){t.dtInstanceTopManagementProgrammedVsExecutedSales=e},t.dtOptionsTopManagementProgrammedVsExecutedSales=n.newOptions().withBootstrap().withOption("responsive",!0).withOption("ajax",{data:function(t){return t=C(t),JSON.stringify(t)},url:"api/dashboard/top-management/programmed-vs-executed-sales",contentType:"application/json",type:"POST"}).withDataProp("data").withOption("searching",!1).withOption("ordering",!1).withOption("serverSide",!0).withOption("processing",!0).withOption("fnPreDrawCallback",function(){return 0==t.isOpenGridProgrammedVsExecutedSales}).withPaginationType("full_numbers").withOption("createdRow",function(e){s(angular.element(e).contents())(t)}),t.dtColumnsTopManagementProgrammedVsExecutedSales=[i.newColumn("year").withTitle("Año"),i.newColumn("vrProgrammed").withTitle("RV. Programado"),i.newColumn("vrExecute").withTitle("RV. Ejecutado"),i.newColumn("vrBalance").withTitle("RV. Balance"),i.newColumn("sstProgrammed").withTitle("SST Programado"),i.newColumn("sstExecute").withTitle("SST Ejecutado"),i.newColumn("sstBalance").withTitle("SST Balance"),i.newColumn("sylProgrammed").withTitle("SYLOGI Programado"),i.newColumn("sylExecute").withTitle("SYLOGI Ejecutado"),i.newColumn("sylBalance").withTitle("SYLOGI Balance")],t.onFilter=function(){return null==t.filters.startDate||null==t.filters.endDate?void u.swal("Campos incorretos","Seleccione las fechas de inicio y fin para continuar","warning"):(t.hideGrids(),t.showIndicators=!0,O(),void t.reloadData())},t.onCancel=function(){t.showIndicators=!1,t.init()},t.onConsolidate=function(){return d({method:"POST",url:"api/dashboard/top-management/consolidate",headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(){t.refreshAll(),u.swal("Proceso Exitoso",".","success")})["catch"](function(t){a.error(t),u.swal("Error al consolidar",t.data.message,"error")})},t.onChangeType=function(){var e=h("filter")(c.parameters("project_concepts"),{code:t.filters.type.value}),a=h("filter")(c.parameters("project_concepts"),{value:"PCOSGA"});t.conceptList=e.concat(a),t.classificationList=[]},t.onChangeConcept=function(){t.classificationList=h("filter")(c.parameters("project_classifications"),{code:t.filters.concept.value})},t.onChangePerformanceLevelFilter=function(){t.reloadData()},t.onSearchCustomer=function(){var e=g.open({templateUrl:c.app.views.urlRoot+"modules/common/modals/data_table_list_modal.htm",placement:"right",size:"lg",backdrop:!0,controller:"ModalInstanceSideDashboardTopManagementSearchCustomerCtrl",scope:t,windowTopClass:"top-modal"});e.result.then(function(e){var a=h("filter")(t.customerList,{id:e.id});0==a.length&&t.customerList.push(e),t.filters.customer=e,t.filters.administrator=null,t.administratorList=[]})},t.onClearCustomer=function(){t.filters.customer=null},t.onSearchAdministrator=function(){if(!t.filters.customer)return void u.swal("Cliente requerido","Debes indicar el cliente.","warning");var e=g.open({templateUrl:c.app.views.urlRoot+"modules/common/modals/data_table_list_modal.htm",placement:"right",size:"lg",backdrop:!0,controller:"ModalInstanceSideDashboardTopManagementSearchAdministratorCtrl",scope:t,windowTopClass:"top-modal",resolve:{customerId:t.filters.customer}});e.result.then(function(e){var a=h("filter")(t.administratorList,{id:e.id});0==a.length&&t.administratorList.push(e),t.filters.administrator=e})},t.onClearAdministrator=function(){t.filters.administrator=null},t.onOpenGridHisotricalSales=function(){t.isOpenGridHistoricalSales=!t.isOpenGridHistoricalSales,t.dtInstanceSalesHistoricalGrid.reloadData()},t.onOpenGridProgrammedVsExecutedSales=function(){t.isOpenGridProgrammedVsExecutedSales=!t.isOpenGridProgrammedVsExecutedSales,console.log("asdfasdf"),t.dtInstanceTopManagementProgrammedVsExecutedSales.reloadData()},t.onOpenGridTotalSales=function(){t.isOpenGridTotalSales=!t.isOpenGridTotalSales,t.dtInstanceTopManagementTotalSales.reloadData()},t.onOpenGridSalesByType=function(){t.isOpenGridSalesByType=!t.isOpenGridSalesByType,t.dtInstanceTopManagementSalesByType.reloadData()},t.onOpenGridSalesByConcept=function(){t.isOpenGridSalesByConcept=!t.isOpenGridSalesByConcept,t.dtInstanceTopManagementSalesByConcept.reloadData()},t.onOpenGridSalesByClassification=function(){t.isOpenGridSalesByClassification=!t.isOpenGridSalesByClassification,t.dtInstanceTopManagementSalesByClassification.reloadData()},t.onOpenGridExperiencesByMonths=function(){t.isOpenGridExperiencesByMonths=!t.isOpenGridExperiencesByMonths,t.dtInstanceTopManagementExperienesByMonths.reloadData()},t.onOpenGridSatisfactionByExperience=function(){if(t.isOpenGridSatisfactionByExperience=!t.isOpenGridSatisfactionByExperience,t.santisfactionAnswerTypes){var e=t.santisfactionAnswerTypes.veryGood?t.santisfactionAnswerTypes.veryGood.answer:"Excelente",a=t.santisfactionAnswerTypes.good?t.santisfactionAnswerTypes.good.answer:"Bueno",n=t.santisfactionAnswerTypes.regular?t.santisfactionAnswerTypes.regular.answer:"Regular",i=t.santisfactionAnswerTypes.bad?t.santisfactionAnswerTypes.bad.answer:"Malo";t.santisfactionAnswerTypes.veryBad?t.santisfactionAnswerTypes.veryBad.answer:"Muy Malo";t.dtInstanceTopManagementAmountBySatisfactionLevel.DataTable.column(2).header().innerHTML=e,t.dtInstanceTopManagementAmountBySatisfactionLevel.DataTable.column(3).header().innerHTML=a,t.dtInstanceTopManagementAmountBySatisfactionLevel.DataTable.column(4).header().innerHTML=n,t.dtInstanceTopManagementAmountBySatisfactionLevel.DataTable.column(5).header().innerHTML=i}t.dtInstanceTopManagementAmountBySatisfactionLevel.reloadData()},t.onOpenGridRegisteredVsParticipants=function(){t.isOpenGridRegisteredVsParticipants=!t.isOpenGridRegisteredVsParticipants,t.dtInstanceTopManagementRegisteredVsParticipants.reloadData()},t.onOpenGridPerformanceByConsultant=function(){t.isOpenGridPerformanceByConsultant=!t.isOpenGridPerformanceByConsultant,t.dtInstanceTopManagementPerformanceByConsultant.reloadData()},t.clearFilterPerformanceLevel=function(){t.filter.performanceLevel=null,t.reloadData()},t.refreshAll=function(){t.hideGrids(),y(),t.showIndicators&&(O(),t.reloadData())},t.onChangePeriod=function(){y()}}]);
app.controller("ModalInstanceSideDashboardTopManagementSearchCustomerCtrl",["$rootScope","$stateParams","$scope","$uibModalInstance","$log","$timeout","SweetAlert","$http","toaster","$filter","FileUploader","DTColumnBuilder","DTOptionsBuilder","$compile",function(t,n,e,i,a,o,l,r,s,c,u,d,m,p){e.title="CLIENTES DISPONIBLES";t.isAgent();e.entity={id:0},e.onCloseModal=function(){var t={id:e.entity.id,item:e.entity.businessName,value:e.entity.id,arl:e.entity.arl?e.entity.arl.item:null};i.close(t)},e.onCancel=function(){i.dismiss("cancel")};var w=function(t){if(0!=t){var n={id:t};r({method:"GET",url:"api/customer",params:n})["catch"](function(t,n){if(403==n){var e=null!==t.message&&void 0!==t.message?t.message:"app.clientes.list";l.swal("No Autorizado","No estas autorizado para ver esta información.","error"),o(function(){$state.go(e)},3e3)}else 404==n?l.swal("Información no disponible","Diagnóstico no encontrado","error"):l.swal("Error","Se ha presentado un error al intentar acceder a la información del proceso","error")}).then(function(t){o(function(){e.entity=t.data.result})})["finally"](function(){o(function(){e.onCloseModal()},400)})}else e.loading=!1};e.dtOptionsCommonDataTableList=m.newOptions().withBootstrap().withOption("responsive",!0).withOption("ajax",{data:function(t){return t.operation="customer",JSON.stringify(t)},url:"api/dashboard/top-management/get-customers",contentType:"application/json",type:"POST"}).withDataProp("data").withOption("order",[[0,"desc"]]).withOption("serverSide",!0).withOption("processing",!0).withOption("fnDrawCallback",function(){h()}).withPaginationType("full_numbers").withOption("createdRow",function(t,n,i){p(angular.element(t).contents())(e)}),e.dtColumnsCommonDataTableList=[d.newColumn(null).withTitle("Acciones").withOption("width",80).notSortable().renderWith(function(t){var n="",e="",i='<a class="btn btn-success btn-xs editRow lnk" href="#" uib-tooltip="Adicionar causa"  data-id="'+t.id+'"'+e+' >   <i class="fa fa-plus-square"></i></a> ';return n+=i}),d.newColumn("documentType").withTitle("Tipo de Documento").withOption("width",200),d.newColumn("documentNumber").withTitle("Nro Documento").withOption("width",200),d.newColumn("businessName").withTitle("Razón Social").withOption("width",200),d.newColumn("type").withTitle("Tipo de Cliente").withOption("width",200),d.newColumn("classification").withTitle("Clasificación").withOption("width",200).renderWith(function(t,n,e,i){return null==t||void 0==t?"":t}),d.newColumn("status").withTitle("Estado").withOption("width",200).renderWith(function(t,n,e,i){var a="";switch(t){case"Activo":a="label label-success";break;case"Inactivo":a="label label-danger";break;case"Retirado":a="label label-warning"}var o='<span class="'+a+'">'+t+"</span>";return o})];var h=function(){angular.element("#dtCommonDataTableList a.editRow").on("click",function(){var t=angular.element(this).data("id");w(t)})};e.dtInstanceCommonDataTableListCallback=function(t){e.dtInstanceCommonDataTableList=t},e.reloadData=function(){e.dtInstanceCommonDataTableList.reloadData()}}]);
app.controller("ModalInstanceSideDashboardTopManagementSearchAdministratorCtrl",["$rootScope","$stateParams","$scope","$uibModalInstance","$log","$timeout","SweetAlert","$http","toaster","$filter","FileUploader","DTColumnBuilder","DTOptionsBuilder","$compile","customerId",function(t,n,a,i,e,o,l,s,r,c,d,u,m,p,h){a.title="ADMINISTRADORES",a.entity={id:0},a.onCloseModal=function(){var t={id:a.entity.id,value:a.entity.id,item:a.entity.name};i.close(t)},a.onCancel=function(){i.dismiss("cancel")},a.dtOptionsCommonDataTableList=m.newOptions().withBootstrap().withOption("responsive",!0).withOption("ajax",{data:function(t){return t.customerId=h,JSON.stringify(t)},url:"api/dashboard/top-management/get-administrators",contentType:"application/json",type:"POST"}).withDataProp("data").withOption("order",[[0,"desc"]]).withOption("serverSide",!0).withOption("processing",!0).withOption("fnDrawCallback",function(){w()}).withPaginationType("full_numbers").withOption("createdRow",function(t,n,i){p(angular.element(t).contents())(a)}),a.dtColumnsCommonDataTableList=[u.newColumn(null).withTitle("Acciones").withOption("width",80).notSortable().renderWith(function(t){var n="",a="",i='<a class="btn btn-success btn-xs editRow lnk" href="#" uib-tooltip="Adicionar causa"  data-id="'+t.id+'"'+a+' >   <i class="fa fa-plus-square"></i></a> ';return n+=i}),u.newColumn("name").withTitle("Nombre").withOption("width",200)];var w=function(){angular.element("#dtCommonDataTableList a.editRow").on("click",function(){var t=angular.element(this).data("id");f(t)})};a.dtInstanceCommonDataTableListCallback=function(t){a.dtInstanceCommonDataTableList=t},a.reloadData=function(){a.dtInstanceCommonDataTableList.reloadData()};var f=function(t){var n={id:t};s({method:"GET",url:"api/users/get",params:n}).then(function(t){a.entity=t.data.result})["finally"](function(){a.onCloseModal()})}}]);
"use strict";app.controller("dashboardTopManagementSummaryCtrl",["$scope","$rootScope","$stateParams","$log","$http","$timeout","calendarConfig","SweetAlert","$filter",function(e,a,t,r,n,l,o,c,i){function u(){var a=d(),t={year:e.calendarDate.getFullYear(),types:a};return n({method:"POST",url:"api/dashboard/top-management/summary/calendar",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(t)}).then(function(a){l(function(){a.data.data.map(function(e){e.startsAt=new Date(e.startsAt)}),e.events=a.data.data})})["catch"](function(e){r.error(e),c.swal("Error al cargar la información","Error al cargar la información","error")})}function d(){var a=i("filter")(e.typeLists,{isActive:!0}),t=[];return a.forEach(function(e){t.push(e.value)}),t}var s=new Date;s.getDate(),s.getMonth(),s.getFullYear();e.IsEdited=!1,e.events=[],e.calendarView="month",e.calendarDay=new Date,e.calendarDate=new Date,e.calendarTitle=null,e.currentFilteredYear=(new Date).getFullYear(),e.typeLists=a.parameters("project_type"),u(),e.onChangeTypeFilter=function(){u()},e.onChangeFilter=function(){e.calendarDate.getFullYear()!=e.currentFilteredYear&&(e.currentFilteredYear=e.calendarDate.getFullYear(),u())}}]);
"use strict";app.controller("CommercialDashboardCtrl",["$scope","$stateParams","$log","DTOptionsBuilder","DTColumnBuilder","DTColumnDefBuilder","$compile","toaster","$state","$rootScope","$timeout","$http","SweetAlert","ChartService","$filter","ListService","ngNotify",function(e,t,a,i,n,o,r,l,s,c,u,d,m,p,h,w,y){function f(){var t=[{name:"chart_line_options",criteria:null},{name:"chart_pie_options",criteria:null},{name:"dashboard_commercial_summary",criteria:null}];p.getDataChart(t).then(function(t){e.chart.pie.options=t.data.data.chartPieOptions,e.chart.pie.options.legend.position="bottom",e.chart.line.options=angular.copy(t.data.data.chartLineOptions),e.chart.line.options.legend.position="bottom",e.chart.data.amountLicensesByYearsHistorical=t.data.data.amountLicensesByYearsHistorical,e.chart.data.amountLicensesByTypeAndYearsHistorical=t.data.data.amountLicensesByTypeAndYearsHistorical,e.chart.data.amountActiveLicensesByType=t.data.data.amountActiveLicensesByType,e.chart.data.amountActiveLicensesByState=t.data.data.amountActiveLicensesByState},function(t){e.status="Unable to load customer data: "+t.message})}c.canShowCommercialDashboard()||s.go("app.clientes.list",{reload:!0}),e.licenseList=c.parameters("wg_customer_licenses_types"),e.filter={licenseType:null},e.chart={line:{options:null},pie:{options:null},data:{amountLicensesByYearsHistorical:null,amountLicensesByTypeAndYearsHistorical:null,amountActiveLicensesByType:null,amountActiveLicensesByState:null}},f(),e.dtInstanceCommercialDashboard={},e.dtOptionsCommercialDashboard=i.newOptions().withBootstrap().withOption("responsive",!0).withOption("ajax",{data:function(t){return t.license=null==e.filter.licenseType?null:e.filter.licenseType.item,JSON.stringify(t)},url:"api/dashboard/commercial/next-expired",type:"POST"}).withDataProp("data").withOption("order",[[3,"desc"]]).withOption("serverSide",!0).withOption("processing",!0).withOption("fnPreDrawCallback",function(){return!0}).withPaginationType("full_numbers").withOption("createdRow",function(t){r(angular.element(t).contents())(e)}),e.dtColumnsCommercialDashboard=[n.newColumn("customer").withTitle("Cliente").withOption("width",200),n.newColumn("license").withTitle("Tipo de Licencia"),n.newColumn("startDate").withTitle("Fecha Inicio"),n.newColumn("finishDate").withTitle("Fecha Finalización"),n.newColumn("agent").withTitle("Comercial"),n.newColumn("value").withTitle("Valor").renderWith(function(e){return"$ "+h("number")(e,2)}),n.newColumn("state").withTitle("Estado")],e.reloadData=function(){e.dtInstanceCommercialDashboard.reloadData()},e.onConsolidate=function(){return d({method:"POST",url:"api/dashboard/commercial/consolidate",headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(){e.refreshAll(),m.swal("Proceso Exitoso",".","success")})["catch"](function(e){a.error(e),m.swal("Error al consolidar",e.data.message,"error")})},e.onChangeLicenseTypeFilter=function(){e.reloadData()},e.onClearLicenseTypeFilter=function(){e.filter.licenseType=null,e.reloadData()},e.refreshAll=function(){f(),e.reloadData()}}]);
"use strict";app.controller("dashboardDiagnosticCustomerEmployeesCtrl",["$scope","$stateParams","$log","DTOptionsBuilder","DTColumnBuilder","DTColumnDefBuilder","$compile","toaster","$state","$rootScope","$timeout","$http","SweetAlert","ChartService","$aside","$filter","ListService",function(e,t,o,r,i,s,l,a,$,c,u,p,m,n,d,C,D){}]);
"use strict";app.controller("dashboardDiagnosticCustomerGeneralCtrl",["$scope",function(o){}]);
"use strict";app.controller("dashboardDiagnosticCustomerBusinessProgramCtrl",["$scope","$rootScope","$filter","ChartService","ListService","DashboardFilterService",function(a,t,r,e,o,n){function i(){a.init(),a.currentCustomer=n.getCurrentCustomer(),a.currentCustomer&&s()}function s(){var t=[{name:"dashboard_business_program",criteria:{customerId:a.currentCustomer.id}}];o.getDataList(t).then(function(t){a.allFilters=t.data.data.dashboardBusinessProgramWorkplaces,a.allFilters.forEach(function(t){var r=a.workplaceList.some(function(a){return a.value==t.id});r||a.workplaceList.push({value:t.id,name:t.name})})},function(t){a.status="Unable to load customer data: "+t.message})}function c(){if(a.entity.period&&a.entity.workplace){var t={customerId:a.currentCustomer.id,period:a.entity.period?a.entity.period.value:null,workplaceId:a.entity.workplace?a.entity.workplace.value:null},r=[{name:"chart_bar_with_scales_options",criteria:null},{name:"dashboard_occupational_investigation_data",criteria:t}];e.getDataChart(r).then(function(t){a.chart.bar.options=t.data.data.chartBarOptionsWithScales,a.chart.data.programs=t.data.data.dashboardOccupationalInvestigationData,a.chart.data.rates=t.data.data.dashboardOccupationalInvestigationRates,a.chart.data.programs.map(function(t){return t.options=angular.copy(a.options),t})},function(t){a.status="Unable to load customer data: "+t.message})}}function u(){a.periods=[],a.allFilters.filter(function(t){return t.id==a.entity.workplace.value}).forEach(function(t){var r=a.periods.some(function(a){return a.value==t.period});r||a.periods.push({value:t.period,item:t.period})})}a.currentCustomer=null,a.init=function(){a.periods=[],a.workplaceList=[],a.allFilters=[],a.entity={workplace:null,period:null},a.chart={bar:{options:null},data:{programs:null}}},a.options={readOnly:!0,displayPrevious:!0,barCap:5,trackWidth:10,barWidth:5,trackColor:"rgba(92,184,92,.1)",barColor:"#5BC01E",textColor:"#000",size:150,unit:"%",subText:{enabled:!0,text:""}},i(),a.$on("onBroadcastChangeFilterCustomer",function(){i()}),a.onRefresh=function(){c()},a.onChangeWorkplace=function(){a.entity.period=null,u()},a.getProgramValue=function(a,t){var r=0;switch(a.code){case"c":r=t.cumple;break;case"cp":r=t.parcial;break;case"nc":r=t.nocumple;break;case"na":r=t.noaplica}return r}}]);
"use strict";app.controller("dashboardDiagnosticCustomerImprovimentPlanCtrl",["$scope","$rootScope","ChartService","ListService","DashboardFilterService",function(t,a,e,r,o){function n(){t.init(),t.currentCustomer=o.getCurrentCustomer(),t.currentCustomer&&i()}function i(){var a=[{name:"dashboard_improvement_plan",criteria:{customerId:t.currentCustomer.id}}];r.getDataList(a).then(function(a){t.periods=a.data.data.dashboardImprovementPlanPeriods,t.periods.length>0&&(t.entity.period=t.periods[0],t.onRefresh())},function(a){t.status="Unable to load customer data: "+a.message})}function s(){var a={customerId:t.currentCustomer.id,period:t.entity.period?t.entity.period.value:null},r=[{name:"chart_bar_with_scales_options",criteria:null},{name:"dashboard_improvement_plan",criteria:a}];e.getDataChart(r).then(function(a){t.chart.bar.options=a.data.data.chartBarOptionsWithScales,t.chart.bar.options.scales.xAxes[0].ticks.autoSkip=!1,t.chart.data.dashboardImprovementPlan=a.data.data.dashboardImprovementPlan},function(a){t.status="Unable to load customer data: "+a.message})}t.currentCustomer=null,t.init=function(){t.periods=[],t.entity={period:null},t.chart={bar:{options:null},data:{dashboardImprovementPlan:{}}}},n(),t.$on("onBroadcastChangeFilterCustomer",function(){n()}),t.onRefresh=function(){s()}}]);
"use strict";app.controller("dashboardDiagnosticCustomerUnsafeConditionsCtrl",["$scope","$rootScope","ChartService","ListService","DashboardFilterService",function(t,a,e,r,n){function o(){t.init(),t.currentCustomer=n.getCurrentCustomer(),t.currentCustomer&&s()}function s(){var a=[{name:"customer_unsafe_act_years",criteria:{customerId:t.currentCustomer.id}}];r.getDataList(a).then(function(a){t.periods=a.data.data.customerUnsafeActYears,t.workplaceList=a.data.data.customerUnsafeActWorkplace,t.periods.length>0&&(t.entity.period=t.periods[0],c(!1),t.onRefresh())},function(a){t.status="Unable to load customer data: "+a.message})}function c(a){var e=[{name:"customer_unsafe_act_workplace",criteria:{customerId:t.currentCustomer.id,year:t.entity.period?t.entity.period.value:-1}}];r.getDataList(e).then(function(e){t.workplaceList=e.data.data.customerUnsafeActWorkplace;var r=t.entity.workplace;if(t.entity.workplace=null,r){var n=t.workplaceList.find(function(t){return t.value==r.value});t.entity.workplace=n}a&&u()},function(a){t.status="Unable to load customer data: "+a.message})}function u(){var a={customerId:t.currentCustomer.id,year:t.entity.period.value,workplace:t.entity.workplace?t.entity.workplace.value:null,month:null},r=[{name:"chart_bar_options",criteria:null}];0==t.entity.typeIndicator.value?r.push({name:"dashboard_unsafe_act_hazard",criteria:a}):r.push({name:"dashboard_unsafe_act_status",criteria:a}),e.getDataChart(r).then(function(a){t.chart.bar.options=a.data.data.chartBarOptions,t.chart.bar.options.legend.display=!1,a.data.data.customerUnsafeActHazard&&(t.chart.data.customerUnsafeActHazard=a.data.data.customerUnsafeActHazard),a.data.data.customerUnsafeActStatus&&(t.chart.data.customerUnsafeActStatus=a.data.data.customerUnsafeActStatus),t.amount=a.data.data.customerCountUnsafeActHazard},function(a){t.status="Unable to load customer data: "+a.message})}t.currentCustomer=null,t.typeIndicators=[{value:0,item:"Peligros"},{value:1,item:"Estado"}],t.init=function(){t.amount=0,t.periods=[],t.workplaceList=[],t.entity={typeIndicator:t.typeIndicators[0],workplace:null,period:null},t.chart={bar:{options:null},data:{customerUnsafeActHazard:{},customerUnsafeActStatus:{}}}},o(),t.$on("onBroadcastChangeFilterCustomer",function(){o()}),t.onRefresh=function(){u()},t.onRefreshWorkplace=function(){c(!0)},t.onClearWorkplace=function(){t.entity.workplace=null,t.onRefresh()}}]);
"use strict";app.controller("dashboardDiagnosticCustomerGeneralHazardMatrixCtrl",["$scope","$stateParams","$state","$rootScope","ChartService","ListService","DashboardFilterService",function(a,t,r,e,o,i,n){function c(){a.init(),a.currentCustomer=n.getCurrentCustomer(),a.currentCustomer&&(d(),s())}function d(){var t=[{name:"customer_config_acitivty_hazard_workplace_list",criteria:{customerId:a.currentCustomer.id}}];i.getDataList(t).then(function(t){a.workplaceList=t.data.data.customerConfigAcitivtyHazardWorkplaceList},function(t){a.status="Unable to load customer data: "+t.message})}function s(){var t={customerId:a.currentCustomer.id,workplace:a.entity.workplace},r=[{name:"chart_bar_options",criteria:null}];0==a.entity.typeIndicator.value?r.push({name:"dashboard_hazard_matrix",criteria:t}):r.push({name:"dashboard_hazard_matrix_acceptability",criteria:t}),o.getDataChart(r).then(function(t){a.chart.bar.options=t.data.data.chartBarOptions,a.chart.bar.options.legend.display=!1,a.chart.bar.options.scales={xAxes:[{ticks:{autoSkip:!1}}],yAxes:[{ticks:{beginAtZero:!0}}]},a.totalHazard=t.data.data.dashboardHazardMatrixAmountRecords,t.data.data.dashboardHazardMatrixChartBar&&(a.chart.data.roadSafetyChartBar=t.data.data.dashboardHazardMatrixChartBar),t.data.data.dashboardHazardMatrixAcceptabilityChartBar&&(a.chart.data.roadSafetyChartBar=t.data.data.dashboardHazardMatrixAcceptabilityChartBar)},function(t){a.status="Unable to load customer data: "+t.message})}a.currentCustomer=null,a.typeIndicators=[{value:0,item:"Peligros"},{value:1,item:"Aceptabilidad del riesgo"}],a.init=function(){a.workplaceList=[],a.totalHazard=0,a.entity={typeIndicator:a.typeIndicators[0],workplace:null},a.chart={bar:{options:null},data:{roadSafetyChartBar:null}}},c(),a.$on("onBroadcastChangeFilterCustomer",function(){c()}),a.onSelecttypeIndicator=function(){s()},a.onSelectworkPlace=function(){s()},a.onClearWorkplace=function(){a.entity.workplace=null,s()}}]);
"use strict";app.controller("dashboardDiagnosticCustomerGeneralRoadSafetyCtrl",["$scope","$rootScope","ChartService","ListService","DashboardFilterService",function(t,e,o,r,a){function n(){t.init(),t.currentCustomer=a.getCurrentCustomer(),t.currentCustomer&&(s(),c())}function i(){t.allPeriods.forEach(function(e){var o=t.periods.some(function(t){return t.value==e.year});o||t.periods.push({value:e.year,item:e.year})})}function s(){var e=[{name:"customer_road_safety_periods",criteria:{customerId:t.currentCustomer.id}}];r.getDataList(e).then(function(e){t.allPeriods=e.data.data.customerRoadSafetyPeriods,i(),t.periods.length&&(t.periods[0]&&(t.entity.period=t.periods[0],t.entity.period&&(u(!0),t.entity.month=t.months[t.months.length-1])),t.periods[1]&&(t.entity.comparePeriod=t.periods[1],t.entity.comparePeriod&&(u(!1),t.entity.compareMonth=t.compareMonths[t.compareMonths.length-1]))),c()},function(e){t.status="Unable to load customer data: "+e.message})}function c(){if(t.entity.period&&t.entity.month&&t.entity.comparePeriod&&t.entity.compareMonth){var e={customerId:t.currentCustomer.id,period:t.entity.period.value,month:t.entity.month.value,comparePeriod:t.entity.comparePeriod.value,compareMonth:t.entity.compareMonth.value},r=[{name:"chart_bar_options",criteria:null},{name:"dashboard_road_safety",criteria:e}];o.getDataChart(r).then(function(e){t.chart.bar.options=e.data.data.chartBarOptions,t.chart.bar.options.legend.position="top",t.chart.bar.options.scales={xAxes:[{ticks:{autoSkip:!1}}],yAxes:[{ticks:{beginAtZero:!0}}]},t.chart.data.roadSafetyChartBar=e.data.data.dashboardRoadSafetyChartBar,t.percent=e.data.data.customerRoadSafetyAverage},function(e){t.status="Unable to load customer data: "+e.message})}}function u(e){if(e){t.months=[];var o=t.allPeriods.filter(function(e){return e.year==t.entity.period.value});t.months=o.map(function(t){return{name:t.monthName,value:t.month}})}else{t.compareMonths=[];var o=t.allPeriods.filter(function(e){return e.year==t.entity.comparePeriod.value});t.compareMonths=o.map(function(t){return{name:t.monthName,value:t.month}})}}t.currentCustomer=null,t.init=function(){t.percent=0,t.allPeriods=[],t.periods=[],t.months=[],t.compareMonths=[],t.entity={period:null,month:null,comparePeriod:null,compareMonth:null},t.chart={bar:{options:null},data:{roadSafetyChartBar:null}}},n(),t.$on("onBroadcastChangeFilterCustomer",function(){n()}),t.onRefresh=function(){c()},t.onChangePeriod=function(){u(!0),t.entity.month=null},t.onChangeComparePeriod=function(){u(!1),t.entity.compareMonth=null}}]);
"use strict";app.controller("dashboardDiagnosticCustomerGeneralMinimalStandarsCtrl",["$scope","$stateParams","$log","$state","$rootScope","$timeout","$http","SweetAlert","ChartService","$aside","$filter","ListService","DashboardFilterService",function(t,a,e,r,n,o,i,l,c,d,s,u,p){function m(){t.init(),t.currentCustomer=p.getCurrentCustomer(),t.currentCustomer&&(h(),C())}function h(){var a=[{name:"customer_standard_minimal_periods",criteria:{customerId:t.currentCustomer.id}}];u.getDataList(a).then(function(a){t.periods=a.data.data.customerStandardMinimalPeriods,t.periods.length&&(t.entity.period=t.periods[0],C())},function(a){t.status="Unable to load customer data: "+a.message})}function C(){if(t.entity.period){var a={customerId:t.currentCustomer.id,period:t.entity.period.value,comparePeriod:t.entity.comparePeriod?t.entity.comparePeriod.value:null},e=[{name:"chart_bar_options",criteria:null}];0==t.entity.typeIndicator.value?e.push({name:"dashboard_minimal_standard_progress",criteria:a}):e.push({name:"dashboard_minimal_standard_compare",criteria:a}),c.getDataChart(e).then(function(a){if(t.currentCycle=null,t.chart.bar.options=a.data.data.chartBarOptions,t.chart.bar.options.legend.display=!1,a.data.data.dashboardMinimalStandardProgress){var e=a.data.data.dashboardStats;t.chart.data.all=a.data.data.dashboardMinimalStandardProgress,t.chart.data.general=t.chart.data.all.length?t.chart.data.all[0]:{total:0,accomplish_percent_total:0,no_accomplish_percent_total:0,no_apply_with_justification_percent_total:0,no_checked_percent_total:0},t.chart.data.general.total=e?parseFloat(e.total):t.chart.data.general.total,t.chart.data.all.map(function(a){var e=angular.copy(t.optionsCycles);return e.subText.text=a.name,a.options=e,a})}a.data.data.dashboardMinimalStandardCompareChartLine&&(t.chart.data.minimalStandarComparativeChartLine=a.data.data.dashboardMinimalStandardCompareChartLine)},function(a){t.status="Unable to load customer data: "+a.message})}}t.currentCustomer=null,t.typeIndicators=[{value:0,item:"Avance Evaluación"},{value:1,item:"Comparativo"}],t.init=function(){t.currentCycle=null,t.periods=[],t.entity={typeIndicator:t.typeIndicators[0],period:null,comparePeriod:null},t.chart={bar:{options:null},line:{options:null},data:{all:[],general:{total:0,accomplish_percent_total:0,no_accomplish_percent_total:0,no_apply_with_justification_percent_total:0,no_checked_percent_total:0},minimalStandarComparativeChartLine:null}}},t.options={readOnly:!0,displayPrevious:!0,barCap:25,trackWidth:20,barWidth:20,trackColor:"rgba(92,184,92,.1)",barColor:"#5BC01E",textColor:"#000",unit:"%",step:.01,subText:{enabled:!0,text:"Total"}},t.optionsCycles={readOnly:!0,displayPrevious:!0,barCap:25,trackWidth:10,barWidth:10,trackColor:"rgba(92,184,92,.1)",barColor:"#5BC01E",textColor:"#000",size:120,unit:"%",subText:{enabled:!0,text:""}},m(),t.$on("onBroadcastChangeFilterCustomer",function(){m()}),t.onSelecttypeIndicator=function(){C()},t.onSelectperiod=function(){C()},t.onSelectComparePeriod=function(){C()},t.onClearComparePeriod=function(){t.entity.comparePeriod=null,C()},t.onCycle=function(a){return t.currentCycle&&t.currentCycle.name==a.name?void(t.currentCycle=null):void(t.currentCycle=a)}}]);
"use strict";app.controller("dashboardDiagnosticCustomerGeneralSstCtrl",["$scope","$stateParams","$state","$rootScope","ChartService","ListService","DashboardFilterService","$timeout",function(t,a,r,e,o,n,i,s){function c(){t.init(),t.currentCustomer=i.getCurrentCustomer(),t.currentCustomer&&l()}function l(){var a=[{name:"customer_sst_periods",criteria:{customerId:t.currentCustomer.id}}];n.getDataList(a).then(function(a){0==t.entity.typeIndicator.value?t.periods=a.data.data.customerSstPeriods:t.periods=a.data.data.customerSstPeriodsCompare,t.periods.length&&(t.entity.period=t.periods[0],u())},function(a){t.status="Unable to load customer data: "+a.message})}function u(){if(t.entity.period){var a={customerId:t.currentCustomer.id,period:t.entity.period.value,comparePeriod:t.entity.comparePeriod?t.entity.comparePeriod.value:null},r=[{name:"chart_line_options",criteria:null}];0==t.entity.typeIndicator.value?r.push({name:"dashboard_sst_progress",criteria:a}):r.push({name:"dashboard_sst_compare",criteria:a}),o.getDataChart(r).then(function(a){if(t.currentCycle=null,t.chart.line.options=a.data.data.chartLineOptions,t.chart.rates.c=d(a.data.data.rates,"c"),t.chart.rates.cp=d(a.data.data.rates,"cp"),t.chart.rates.nc=d(a.data.data.rates,"nc"),t.chart.rates.na=d(a.data.data.rates,"na"),a.data.data.customerDiagnosticProgress){t.chart.data.progressAll=a.data.data.customerDiagnosticProgress,t.chart.data.progress=a.data.data.customerDiagnosticProgress[0];var r=parseFloat(t.chart.data.progress.total_percent);t.chart.data.progress.total_percent=0,t.chart.data.progressAll.map(function(a){var r=angular.copy(t.optionsCycles);return r.subText.text=a.name,a.options=r,a}),s(function(){t.chart.data.progress.total_percent=r},100)}a.data.data.customerDiagnosticProgressCompareChartLine&&(t.chart.data.minimalStandarComparativeChartLine=a.data.data.customerDiagnosticProgressCompareChartLine)},function(a){t.status="Unable to load customer data: "+a.message})}}function d(t,a){var r=t.filter(function(t){return t.value==a});return r.length>0?r[0]:null}t.currentCustomer=null,t.init=function(){t.currentCycle=null,t.periods=[],t.comparePeriods=[],t.entity={typeIndicator:t.typeIndicators[0],period:null,comparePeriod:null},t.chart={doughnut:{options:null},bar:{options:null},line:{options:null},pie:{options:null},rates:{c:null,cp:null,nc:null,na:null},data:{progressAll:[],progress:{total_percent:null,cumple_percent:0,parcial_percent:0,nocumple_percent:0,noaplica_percent:0,nocontesta_percent:0},minimalStandarComparativeChartLine:null}}},t.typeIndicators=[{value:0,item:"Avance Evaluación"},{value:1,item:"Comparativo"}],t.options={readOnly:!0,displayPrevious:!0,barCap:25,trackWidth:20,barWidth:20,trackColor:"rgba(92,184,92,.1)",barColor:"#5BC01E",textColor:"#000",unit:"%",subText:{enabled:!0,text:"Total"}},t.optionsTotal={readOnly:!0,displayPrevious:!0,barCap:25,trackWidth:20,barWidth:20,trackColor:"rgba(92,184,92,.1)",barColor:"#5BC01E",textColor:"#000",step:.01,unit:"%",subText:{enabled:!0,text:"Total"}},t.optionsCycles={readOnly:!0,displayPrevious:!0,barCap:25,trackWidth:10,barWidth:10,trackColor:"rgba(92,184,92,.1)",barColor:"#5BC01E",textColor:"#000",size:120,unit:"%",subText:{enabled:!0,text:""}},c(),t.$on("onBroadcastChangeFilterCustomer",function(){c()}),t.onSelecttypeIndicator=function(){l()},t.onRefresh=function(){u()},t.onClearComparePeriod=function(){t.entity.comparePeriod=null,u()},t.onCycle=function(a){return t.currentCycle&&t.currentCycle.name==a.name?void(t.currentCycle=null):void(t.currentCycle=a)}}]);
"use strict";app.controller("dashboardDiagnosticCustomerEmployeeEmployeesCtrl",["$scope","$rootScope","ChartService","DashboardFilterService",function(t,a,o,e){function r(){t.init(),t.currentCustomer=e.getCurrentCustomer(),t.currentCustomer&&s()}function s(){var a={customerId:t.currentCustomer.id},e=[{name:"chart_bar_with_scales_options",criteria:null},{name:"dashboard_customer_employees_amounts",criteria:a}];o.getDataChart(e).then(function(a){t.chart.bar.options=a.data.data.chartBarOptionsWithScales,t.chart.bar.options.legend.display=!1,t.chart.data.countEmployees=a.data.data.dashboardCustomerEmployeesAmounts.countEmployees,t.chart.data.countEmployeesEconomicGroup=a.data.data.dashboardCustomerEmployeesAmounts.countEmployeesEconomicGroup,t.chart.data.countEmployeesContrators=a.data.data.dashboardCustomerEmployeesAmounts.countEmployeesContrators,t.chart.data.total=a.data.data.dashboardCustomerEmployeesAmounts.total,t.chart.data.amountEmployeesChartStackedBar=a.data.data.dashboardCustomerEmployeesAmountsChartStackedBar},function(a){t.status="Unable to load customer data: "+a.message})}t.currentCustomer=null,t.init=function(){t.chart={bar:{options:null},data:{countEmployees:0,countEmployeesEconomicGroup:0,countEmployeesContrators:0,total:0,amountEmployeesChartStackedBar:null}}},r(),t.$on("onBroadcastChangeFilterCustomer",function(){r()})}]);
"use strict";app.controller("dashboardDiagnosticCustomerEmployeeOccupationalMedicineCtrl",["$scope","$rootScope","ChartService","ListService","DashboardFilterService",function(t,e,a,i,n){function o(){t.init(),t.currentCustomer=n.getCurrentCustomer(),t.currentCustomer&&r()}function r(){var e=[{name:"absenteeism_disability_causes_years",value:t.currentCustomer.id}];i.getDataList(e).then(function(e){t.periods=e.data.data.absenteeism_disability_causes_years,t.periods.length>0&&(t.entity.period=t.periods[0],t.onRefresh(),s())},function(e){t.status="Unable to load customer data: "+e.message})}function s(){var e=[{name:"absenteeism_disability_workplace_list",criteria:{customerId:t.currentCustomer.id,period:t.entity.period.value}}];i.getDataList(e).then(function(e){t.workplaceList=e.data.data.workplaceList,t.entity.workplace=null,t.onRefresh()},function(e){t.status="Unable to load customer data: "+e.message})}function c(){if(t.entity.period){var e={customerId:t.currentCustomer.id,period:t.entity.period?t.entity.period.value:null,workplaceId:t.entity.workplace?t.entity.workplace.id:null},i=[{name:"chart_bar_with_scales_options",criteria:null},{name:"chart_doughnut_options",criteria:null},{name:"dashboard_occupational_medicine",criteria:e}];a.getDataChart(i).then(function(e){t.chart.bar.options=e.data.data.chartBarOptionsWithScales,t.chart.bar.options.legend.display=!1,t.chart.bar.options.tooltips={callbacks:{title:function(){return""}}},t.chart.doughnut.options=e.data.data.chartDoughnutOptions,t.chart.doughnut.options.legend.position="bottom",t.chart.data.ausentismVsInvestigationAT=e.data.data.getChartStackedBarAusentismVsInvestigationAT,t.chart.data.kpis=e.data.data.getKpiOccupationalMedicineDashboard,t.chart.data.chartPieAbsenteeisByCause=e.data.data.chartPieAbsenteeisByCause},function(e){t.status="Unable to load customer data: "+e.message})}}t.currentCustomer=null,t.init=function(){t.periods=[],t.workplaceList=[],t.entity={period:null,workplace:null},t.chart={bar:{options:null},doughnut:{options:null},data:{ausentismVsInvestigationAT:{},chartPieAbsenteeisByCause:{},kpis:{eventNumberAT:0,eventNumberEL:0,eventNumberEC:0,disabilityDaysAT:0,disabilityDaysEL:0,disabilityDaysEC:0,disabilityDaysTotal:0,eventNumberTotal:0}}}},o(),t.$on("onBroadcastChangeFilterCustomer",function(){o()}),t.onRefresh=function(){c()},t.onSelectPeriod=function(){s()},t.onClearWorkplace=function(){t.entity.workplace=null,t.onRefresh()}}]);
"use strict";app.controller("dashboardDiagnosticCustomerEmployeeAbsenteeismCtrl",["$scope","$rootScope","$filter","ChartService","ListService","DashboardFilterService",function(e,t,a,i,n,r){function s(){e.init(),e.currentCustomer=r.getCurrentCustomer(),e.currentCustomer&&o()}function o(){var t={customerId:e.currentCustomer.id},a=[{name:"dashboard_absenteeism_disability_causes_only",criteria:t}];n.getDataList(a).then(function(t){e.causes=t.data.data.absenteeism_disability_causes_only;var a=e.causes.find(function(e){return"AL"==e.value});a&&(e.entity.cause=a,u())},function(t){e.status="Unable to load customer data: "+t.message})}function u(){var t={customerId:e.currentCustomer.id,cause:e.entity.cause?e.entity.cause.value:null},i=[{name:"current_year"},{name:"dashboard_absenteeism_disability_indicator_years",criteria:t}];n.getDataList(i).then(function(t){e.periods=t.data.data.absenteeism_disability_indicator_years;e.entity.period,e.entity.comparePeriod;e.entity.period=null,e.entity.comparePeriod=null,e.chart.data.customerAbsenteeismDisabilityGeneralEvent=null;var i=t.data.data.currentYear,n=e.periods.length?e.periods[0]:null,r=a("filter")(e.periods,{value:i});e.entity.period=r.length?r[0]:n,c()},function(t){e.status="Unable to load customer data: "+t.message})}function c(){if(e.entity.cause){var t=[e.entity.period?e.entity.period.value:-1];e.entity.comparePeriod&&t.push(e.entity.comparePeriod.value);var a={customerId:e.currentCustomer.id,cause:e.entity.cause,yearList:t},n=[{name:"chart_line_options",criteria:null},{name:"customer_absenteeism_disability_general_event",criteria:a}];i.getDataChart(n).then(function(t){e.chart.line.options=t.data.data.chartLineOptions,e.chart.data.customerAbsenteeismDisabilityGeneralEvent=t.data.data.customerAbsenteeismDisabilityGeneralEvent},function(e){})}}e.currentCustomer=null,e.init=function(){e.causes=[],e.periods=[],e.entity={cause:null,period:null,comparePeriod:null},e.chart={line:{options:null},data:{customerAbsenteeismDisabilityGeneralEvent:null}}},s(),e.$on("onBroadcastChangeFilterCustomer",function(){s()}),e.onRefresh=function(){u()},e.onRefreshChart=function(){c()},e.onClearComparePeriod=function(){e.entity.comparePeriod=null,e.onRefresh()}}]);
"use strict";app.controller("dashboardDiagnosticCustomerEmployeeAccidentCtrl",["$scope","$rootScope","ChartService","ListService","DashboardFilterService",function(a,t,e,n,o){function r(){a.init(),a.currentCustomer=o.getCurrentCustomer(),a.currentCustomer&&i()}function i(){var t=[{name:"dashboard_occupational_investigation_periods",criteria:{customerId:a.currentCustomer.id}}];n.getDataList(t).then(function(t){a.periods=t.data.data.dashboardOccupationalInvestigationPeriods,a.periods.length>0&&(a.entity.period=a.periods[0],a.onRefresh())},function(t){a.status="Unable to load customer data: "+t.message})}function d(){var t={customerId:a.currentCustomer.id,period:a.entity.period?a.entity.period.value:null,year:a.entity.period?a.entity.period.value:null},n=[{name:"chart_bar_options",criteria:null},{name:"dashboard_accidents",criteria:t}];e.getDataChart(n).then(function(t){a.chart.bar.options=t.data.data.chartBarOptions,a.chart.bar.options.scales.xAxes[0].ticks.autoSkip=!1,a.data=t.data.data.dashboardAccidents,a.chart.data.chartBarBody=t.data.data.chartBarBody,a.chart.data.chartBarFactor=t.data.data.chartBarFactor,a.days=angular.copy(a.allDays),a.days.forEach(function(t,e){a.data.amountByDayOfWeek.forEach(function(a){t.index==a.day&&(t.count=a.count)})})},function(t){a.status="Unable to load customer data: "+t.message})}a.currentCustomer=null,a.init=function(){a.periods=[],a.data={totalInvestigationAt:0,workingDay:[],amountByDayOfWeek:[],totalCasesWithOrigen:0,totalMissedGrade:0,totalCasesWithRestrictions:0,chartBarBody:{},chartBarFactor:{},gender:{male:0,female:0}},a.entity={period:null},a.chart={bar:{options:null},data:{deathCause:null,accidentAgents:null,partesdelcuerpoafectadas:null}},a.days=angular.copy(a.allDays)},a.allDays=[{day:"Do",count:0,index:1},{day:"Lu",count:0,index:2},{day:"Ma",count:0,index:3},{day:"Mi",count:0,index:4},{day:"Ju",count:0,index:5},{day:"Vi",count:0,index:6},{day:"Sa",count:0,index:7}],r(),a.$on("onBroadcastChangeFilterCustomer",function(){r()}),a.onRefresh=function(){d()}}]);
"use strict";app.controller("dashboardDiagnosticCustomerEmployeeJobConditionsCtrl",["$scope","$rootScope","$compile","DTOptionsBuilder","DTColumnBuilder","DTColumnDefBuilder","$localStorage","ChartService","ListService","ModuleListService","DashboardFilterService",function(t,i,n,o,e,r,a,s,l,c,u){function d(){t.init(),t.currentCustomer=u.getCurrentCustomer(),t.currentCustomer&&h()}function h(){var i=[{name:"general_indicators_get_years",customerId:t.currentCustomer.id}];c.getDataList("/customer-jobconditions/config",i).then(function(i){t.periods=i.data.result.yearsGeneralIndicators,t.periods.length>0&&(t.entity.period=t.periods[0],w(),t.onRefresh()),t.dtInstanceJobConditionsIndicatorsLevelRisksByMonths.reloadData()})}function w(){t.entity.workplace=null;var i=[{name:"general_indicators_get_locations",customerId:t.currentCustomer.id,year:t.entity.period.year}];c.getDataList("/customer-jobconditions/config",i).then(function(i){t.workplaceList=i.data.result.locationsGeneralIndicators})}function p(){var i={customerId:t.currentCustomer.id,year:t.entity.period?t.entity.period.year:null,location:t.entity.workplace?t.entity.workplace.value:null},n=[{name:"chart_bar_options",criteria:null},{name:"dashboard_job_condition_indicators",criteria:i}];s.getDataChart(n).then(function(i){t.chart.bar.options=i.data.data.chartBarOptions,t.chart.bar.options.legend.position="bottom",t.chart.data.levelRisks=i.data.data.customerJobConditionIndicatorsLevelRiskByMonth},function(i){t.status="Unable to load customer data: "+i.message})}function m(){var i={customerId:t.currentCustomer.id,year:t.entity.period?t.entity.period.year:null,location:t.entity.workplace?t.entity.workplace.value:null},n=[{name:"customer_job_conditions_intervention_list",criteria:i}];c.getDataList("/customer-jobconditions/config",n).then(function(i){t.generalStats=i.data.result.jobConditionsInterventionGetStast})}t.currentCustomer=null,t.init=function(){t.periods=[],t.workplaceList=[],t.entity={period:null,workplace:null},t.chart={bar:{options:null},data:{levelRisks:{}}},t.generalStats={highPriorityPercent:0,mediumPriorityPercent:0,lowPriorityPercent:0,highPriority:0,mediumPriority:0,lowPriority:0}},t.dtInstanceJobConditionsIndicatorsLevelRisksByMonths={},t.dtOptionsJobConditionsIndicatorsLevelRisksByMonths=o.newOptions().withBootstrap().withOption("responsive",!0).withOption("ajax",{data:function(i){return i.customerId=t.currentCustomer.id,i.year=t.entity.period?t.entity.period.year:null,i.location=t.entity.workplace?t.entity.workplace.value:null,JSON.stringify(i)},url:"api/customer-jobconditions/indicators/get-level-risks-by-months-list",contentType:"application/json",type:"POST"}).withDataProp("data").withOption("serverSide",!0).withOption("processing",!0).withOption("fnPreDrawCallback",function(){return null!=t.currentCustomer}).withOption("fnDrawCallback",function(){}).withOption("info",!1).withOption("ordering",!1).withOption("paging",!1).withOption("searching",!1).withOption("createdRow",function(i){n(angular.element(i).contents())(t)}),t.dtColumnsJobConditionsIndicatorsLevelRisksByMonths=[e.newColumn("indicator").withTitle("INDICADORES").withOption("width",200).withOption("defaultContent",""),e.newColumn("JAN").withTitle("ENE").withOption("width",200),e.newColumn("FEB").withTitle("FEB").withOption("width",200),e.newColumn("MAR").withTitle("MAR").withOption("width",200),e.newColumn("APR").withTitle("ABR").withOption("width",200),e.newColumn("MAY").withTitle("MAY").withOption("width",200),e.newColumn("JUN").withTitle("JUN").withOption("width",200),e.newColumn("JUL").withTitle("JUL").withOption("width",200),e.newColumn("AUG").withTitle("AGO").withOption("width",200),e.newColumn("SEP").withTitle("SEP").withOption("width",200),e.newColumn("OCT").withTitle("OCT").withOption("width",200),e.newColumn("NOV").withTitle("NOV").withOption("width",200),e.newColumn("DEC").withTitle("DIC").withOption("width",200)],d(),t.$on("onBroadcastChangeFilterCustomer",function(){d()}),t.onRefresh=function(){p(),m(),t.dtInstanceJobConditionsIndicatorsLevelRisksByMonths.reloadData()},t.onChangePeriod=function(){w(),t.onRefresh()},t.onClearWorkplace=function(){t.entity.workplace=null,t.onRefresh()}}]);
"use strict";app.controller("dashboardDiagnosticCustomerEmployeeVirtualRealityCtrl",["$scope","$rootScope","ChartService","ListService","DashboardFilterService",function(t,e,r,a,o){function n(){t.init(),t.currentCustomer=o.getCurrentCustomer(),t.currentCustomer&&i()}function i(){var e=[{name:"customer_vr_employee_indicators_period_list",criteria:{customerId:t.currentCustomer.id}}];a.getDataList(e).then(function(e){t.periods=e.data.data.periodList,t.periods.length>0&&(t.entity.period=t.periods[0],t.onRefresh())},function(e){t.status="Unable to load customer data: "+e.message})}function c(){var e=[{name:"chart_bar_options"},{name:"customer_vr_employee_indicators_charts",criteria:{customerId:t.currentCustomer.id,selectedYear:t.entity.period?t.entity.period.value:null}}];r.getDataChart(e).then(function(e){t.chart.bar.options=e.data.data.chartBarOptions,t.chart.data.genre=e.data.data.genre,t.chart.data.genreTotal=e.data.data.genreTotal,t.chart.data.competitorExperience=e.data.data.competitorExperience},function(e){t.status="Unable to load customer data: "+e.message})}t.currentCustomer=null,t.init=function(){t.periods=[],t.entity={period:null},t.chart={bar:{options:null},doughnut:{options:null},data:{genre:{},genreTotal:0,competitorExperience:{}}}},n(),t.$on("onBroadcastChangeFilterCustomer",function(){n()}),t.onRefresh=function(){c()}}]);