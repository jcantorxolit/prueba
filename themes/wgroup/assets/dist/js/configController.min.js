"use strict";app.controller("configurationTermConditionCtrl",["$scope","$stateParams","$log","$state","$rootScope","$timeout","$http","SweetAlert","$aside","$document",function(r,e,a,o,n,t,i,s,l,c){r.loading=!0,r.isView=!1,r.terms=n.parameters("wg_term_condition");var d=function(){r.parameter={id:r.terms.length>0?r.terms[0].id:0,namespace:"wgroup",group:"wg_term_condition",item:"",value:""}};d(),r.onLoadRecord=function(){i({method:"GET",url:"api/system-parameter/term-condition"}).then(function(e){t(function(){r.parameter=e.data.result})})["catch"](function(r){toaster.pop("Error","Error inesperado",r)})["finally"](function(){t(function(){c.scrollTop(40,2e3)})})},r.onLoadRecord(),r.form={submit:function(e){var a=null;if(e.$invalid){var o=null,a=null;for(o in e)"$"!=o[0]&&(null!==a||e[o].$valid||(a=e[o].$name),e[o].$pristine&&(e[o].$dirty=!0));return log.info(r.parameter),angular.element(".ng-invalid[name="+a+"]").focus(),void s.swal("Error guardando","Se han encontrado errores en el proceso de validación por favor verifique los datos del formulario y vuelva a intentarlo","error")}u()},reset:function(r){r.$setPristine(!0)}},r.onCancel=function(){t(function(){initialize()})};var u=function(){var e={},o=JSON.stringify(r.parameter);return e.data=Base64.encode(o),i({method:"POST",url:"api/system-parameter/save",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(e)}).then(function(e){r.parameter=e.data.result,s.swal("Operación Exitosa","La información ha sido guardada satisfactoriamente","success")})["catch"](function(r){a.error(r),s.swal("Error de guardado","Error guardando el proceso por favor verifique los datos ingresados!","error")})["finally"](function(){})}}]);
"use strict";app.controller("configurationPrivacyPolicyCtrl",["$scope","$stateParams","$log","DTOptionsBuilder","DTColumnBuilder","DTColumnDefBuilder","$compile","toaster","$state","$rootScope","$timeout","$http","SweetAlert","$aside","$document","$location","$window",function(r,e,a,o,n,t,i,l,c,s,u,d,p,f,m,v,g){r.loading=!0,r.isView=!1,r.terms=s.parameters("wg_privacy_policy");var y=function(){r.parameter={id:r.terms.length>0?r.terms[0].id:0,namespace:"wgroup",group:"wg_privacy_policy",item:"",value:""}};y(),r.onLoadRecord=function(){d({method:"GET",url:"api/system-parameter/privacy-policy"}).then(function(e){u(function(){r.parameter=e.data.result})})["catch"](function(r){l.pop("Error","Error inesperado",r)})["finally"](function(){u(function(){m.scrollTop(40,2e3)})})},r.onLoadRecord(),r.form={submit:function(e){var a=null;if(e.$invalid){var o=null,a=null;for(o in e)"$"!=o[0]&&(null!==a||e[o].$valid||(a=e[o].$name),e[o].$pristine&&(e[o].$dirty=!0));return log.info(r.parameter),angular.element(".ng-invalid[name="+a+"]").focus(),void p.swal("Error guardando","Se han encontrado errores en el proceso de validación por favor verifique los datos del formulario y vuelva a intentarlo","error")}w()},reset:function(r){r.$setPristine(!0)}},r.onCancel=function(){u(function(){initialize()})};var w=function(){var e={},o=JSON.stringify(r.parameter);return e.data=Base64.encode(o),d({method:"POST",url:"api/system-parameter/save",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(e)}).then(function(e){r.parameter=e.data.result,p.swal("Operación Exitosa","La información ha sido guardada satisfactoriamente","success")})["catch"](function(r){a.error(r),p.swal("Error de guardado","Error guardando el proceso por favor verifique los datos ingresados!","error")})["finally"](function(){})}}]);
"use strict";app.controller("configurationGeneralParameterCtrl",["$scope","$stateParams","$log","DTOptionsBuilder","DTColumnBuilder","DTColumnDefBuilder","$compile","toaster","$state","$rootScope","$timeout","$http","SweetAlert","$aside","$document",function(e,a,r,t,n,i,o,l,s,c,u,d,m,p,f){var w=r;w.info("loading..configurationGeneralParameterCtrl "),e.loading=!0,e.isView=!1,e.parameters=[],e.filter={selectedParameter:null};var h=function(){e.request={},e.parameter={id:0,namespace:"wgroup",group:"",item:"",value:""}},g=function(){d({method:"POST",url:"api/system-parameter/group",headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(a){u(function(){e.parameters=a.data.data})})["catch"](function(e){})["finally"](function(){})};h(),g(),e.onLoadRecord=function(){if(0!=e.parameter.id){var a={id:e.parameter.id};d({method:"GET",url:"api/system-parameter",params:a})["catch"](function(e,a){if(403==a){var r=null!==e.message&&void 0!==e.message?e.message:"app.clientes.list";m.swal("No Autorizado","No estas autorizado para ver esta información.","error"),u(function(){s.go(r)},3e3)}else 404==a?m.swal("Información no disponible","Diagnóstico no encontrado","error"):m.swal("Error","Se ha presentado un error al intentar acceder a la información del proceso","error")}).then(function(a){u(function(){e.parameter=a.data.result})})["finally"](function(){u(function(){e.loading=!1},400),u(function(){f.scrollTop(40,2e3)})})}else e.loading=!1},e.onLoadRecord(),e.master=e.parameter,e.form={submit:function(a){var r=null;if(a.$invalid){var t=null,r=null;for(t in a)"$"!=t[0]&&(null!==r||a[t].$valid||(r=a[t].$name),a[t].$pristine&&(a[t].$dirty=!0));return w.info(e.parameter),angular.element(".ng-invalid[name="+r+"]").focus(),void m.swal("El formulario contiene errores!","Por favor corrige los errores del formulario e Intentalo de nuevo.","error")}m.swal("Validación exitosa","Guardando información del parametero...","success"),v()},reset:function(a){e.parameter=angular.copy(e.master),a.$setPristine(!0)}},e.onCancel=function(){u(function(){h()},30),e.isView=!1};var v=function(){var a={},t=JSON.stringify(e.parameter);return a.data=Base64.encode(t),d({method:"POST",url:"api/system-parameter/save",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(a)}).then(function(a){u(function(){e.parameter=a.data.result,e.reloadData()})})["catch"](function(e){r.error(e),m.swal("Error de guardado","Error guardando el registro. Por favor verifique los datos ingresados!","error")})["finally"](function(){e.onCancel()})};e.changeParameter=function(a,r){u(function(){e.request.operation="parameter",e.request.namespace="wgroup",e.request.group=a.value,e.parameter.group=a.value,e.reloadData()})},e.clearParameter=function(){u(function(){e.filter.selectedParameter=null,e.request.operation="parameter",e.request.namespace="wgroup",e.request.group="",e.parameter.group="",e.reloadData()})},e.request.operation="parameter",e.request.namespace="wgroup",e.request.group="",e.dtInstanceGeneralParameter={},e.dtOptionsGeneralParameter=t.newOptions().withBootstrap().withOption("responsive",!0).withOption("ajax",{data:e.request,url:"api/system-parameter",type:"POST",beforeSend:function(){},complete:function(){}}).withDataProp("data").withOption("order",[[0,"desc"]]).withOption("serverSide",!0).withOption("processing",!0).withOption("fnPreDrawCallback",function(){return!0}).withOption("fnDrawCallback",function(){P()}).withOption("language",{}).withPaginationType("full_numbers").withOption("createdRow",function(a,r,t){o(angular.element(a).contents())(e)}),e.dtColumnsGeneralParameter=[n.newColumn(null).withTitle("Acciones").withOption("width",150).notSortable().renderWith(function(e,a,r,t){var n="",i="",o='<a class="btn btn-primary btn-xs editRow lnk" href="#" uib-tooltip="Editar"  data-id="'+e.id+'"'+i+' >   <i class="fa fa-edit"></i></a> ',l='<a class="btn btn-info btn-xs viewRow lnk" href="#"  uib-tooltip="Ver" data-id="'+e.id+'" >   <i class="fa fa-eye"></i></a> ',s='<a class="btn btn-danger btn-xs delRow lnk" href="#"  uib-tooltip="Eliminar" data-id="'+e.id+'"'+i+' >   <i class="fa fa-trash-o"></i></a> ';return c.can("clientes_view")&&(n+=l),c.can("clientes_edit")&&(n+=o),c.can("clientes_delete")&&(n+=s),n}),n.newColumn("value").withTitle("Código").withOption("width",200),n.newColumn("item").withTitle("Descripción")];var P=function(){$("#dtGeneralParameter a.editRow").on("click",function(){var a=$(this).data("id");e.editGeneralParameter(a)}),$("#dtGeneralParameter a.viewRow").on("click",function(){var a=$(this).data("id");e.parameter.id=a,e.viewGeneralParameter(a)}),$("#dtGeneralParameter a.delRow").on("click",function(){var a=$(this).data("id");w.info("intenta eliminar el registro: "+a),m.swal({title:"Está seguro?",text:"Eliminará el registro seleccionado.",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Si, eliminar!",cancelButtonText:"No, continuar!",closeOnConfirm:!0,closeOnCancel:!0},function(t){if(t){var n={};n.id=a,d({method:"POST",url:"api/system-parameter/delete",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(n)}).then(function(e){swal("Eliminado","Registro eliminado satisfactoriamente","info")})["catch"](function(e){r.error(e),m.swal("Error en la eliminación","Se ha presentado un error durante la eliminación del registro. Por favor inténtelo de nuevo, si el error persiste, comuníquese con el administrador del sistema","error")})["finally"](function(){e.reloadData()})}else swal("Cancelación","La operación ha sido cancelada","error")})})};e.reloadData=function(){e.dtInstanceGeneralParameter.reloadData()},e.viewGeneralParameter=function(a){e.parameter.id=a,e.isView=!0,e.onLoadRecord()},e.editGeneralParameter=function(a){e.parameter.id=a,e.isView=!1,e.onLoadRecord()}}]);
"use strict";app.controller("configurationArlCtrl",["$scope","$stateParams","$log","DTOptionsBuilder","DTColumnBuilder","DTColumnDefBuilder","$compile","toaster","$state","$rootScope","$timeout","$http","SweetAlert","$aside","$document","flowFactory",function(e,a,r,t,n,o,i,l,s,c,d,u,m,p,f,w){var g=r;g.info("loading..configurationArlCtrl "),e.flowConfig={target:"/api/system-parameter/upload",singleFile:!0},e.loading=!0,e.isView=!1,e.uploader=new Flow;var h=function(){e.request={},e.parameter={id:0,namespace:"wgroup",group:"arl",item:"",value:"",logo:""},""==e.parameter.logo&&(e.noImage=!0)};h(),e.onLoadRecord=function(){if(0!=e.parameter.id){var a={id:e.parameter.id};u({method:"GET",url:"api/system-parameter",params:a})["catch"](function(e,a){if(403==a){var r=null!==e.message&&void 0!==e.message?e.message:"app.clientes.list";m.swal("No Autorizado","No estas autorizado para ver esta información.","error"),d(function(){s.go(r)},3e3)}else 404==a?m.swal("Información no disponible","Diagnóstico no encontrado","error"):m.swal("Error","Se ha presentado un error al intentar acceder a la información del proceso","error")}).then(function(a){d(function(){e.parameter=a.data.result,null!=e.parameter.logo&&null!=e.parameter.logo&&null!=e.parameter.logo.path?e.noImage=!1:e.noImage=!0})})["finally"](function(){d(function(){e.loading=!1},400),d(function(){f.scrollTop(40,2e3)})})}else e.loading=!1},e.onLoadRecord(),e.master=e.parameter,e.form={submit:function(a){var r=null;if(a.$invalid){var t=null,r=null;for(t in a)"$"!=t[0]&&(null!==r||a[t].$valid||(r=a[t].$name),a[t].$pristine&&(a[t].$dirty=!0));return g.info(e.parameter),angular.element(".ng-invalid[name="+r+"]").focus(),void m.swal("El formulario contiene errores!","Por favor corrige los errores del formulario e Intentalo de nuevo.","error")}m.swal("Validación exitosa","Guardando información del parametero...","success"),v()},reset:function(a){e.parameter=angular.copy(e.master),a.$setPristine(!0)}},e.onCancel=function(){d(function(){h()},30),e.isView=!1},e.removeImage=function(){e.noImage=!0};var v=function(){var a={},t=JSON.stringify(e.parameter);return a.data=Base64.encode(t),u({method:"POST",url:"api/system-parameter/save",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(a)}).then(function(a){e.uploader.flow.opts.query.id=a.data.result.id,e.uploader.flow.resume(),d(function(){e.parameter=a.data.result,e.reloadData()})})["catch"](function(e){r.error(e),m.swal("Error de guardado","Error guardando el registro. Por favor verifique los datos ingresados!","error")})["finally"](function(){e.onCancel()})};e.request.operation="parameter",e.request.namespace="wgroup",e.request.group="arl",e.dtInstanceArl={},e.dtOptionsArl=t.newOptions().withBootstrap().withOption("responsive",!0).withOption("ajax",{data:e.request,url:"api/system-parameter",type:"POST",beforeSend:function(){},complete:function(){}}).withDataProp("data").withOption("order",[[0,"desc"]]).withOption("serverSide",!0).withOption("processing",!0).withOption("fnPreDrawCallback",function(){return!0}).withOption("fnDrawCallback",function(){C()}).withOption("language",{}).withPaginationType("full_numbers").withOption("createdRow",function(a,r,t){i(angular.element(a).contents())(e)}),e.dtColumnsArl=[n.newColumn(null).withTitle("Acciones").withOption("width",150).notSortable().renderWith(function(e,a,r,t){var n="",o="",i='<a class="btn btn-primary btn-xs editRow lnk" href="#" uib-tooltip="Editar"  data-id="'+e.id+'"'+o+' >   <i class="fa fa-edit"></i></a> ',l='<a class="btn btn-info btn-xs viewRow lnk" href="#"  uib-tooltip="Ver" data-id="'+e.id+'" >   <i class="fa fa-eye"></i></a> ',s='<a class="btn btn-danger btn-xs delRow lnk" href="#"  uib-tooltip="Eliminar" data-id="'+e.id+'"'+o+' >   <i class="fa fa-trash-o"></i></a> ';return c.can("clientes_view")&&(n+=l),c.can("clientes_edit")&&(n+=i),c.can("clientes_delete")&&(n+=s),n}),n.newColumn("value").withTitle("Código").withOption("width",200),n.newColumn("item").withTitle("Descripción")];var C=function(){$("#dtArl a.editRow").on("click",function(){var a=$(this).data("id");e.editGeneralParameter(a)}),$("#dtArl a.viewRow").on("click",function(){var a=$(this).data("id");e.parameter.id=a,e.viewGeneralParameter(a)}),$("#dtArl a.delRow").on("click",function(){var a=$(this).data("id");g.info("intenta eliminar el registro: "+a),m.swal({title:"Está seguro?",text:"Eliminará el registro seleccionado.",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Si, eliminar!",cancelButtonText:"No, continuar!",closeOnConfirm:!0,closeOnCancel:!0},function(t){if(t){var n={};n.id=a,u({method:"POST",url:"api/system-parameter/delete",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(n)}).then(function(e){swal("Eliminado","Registro eliminado satisfactoriamente","info")})["catch"](function(e){r.error(e),m.swal("Error en la eliminación","Se ha presentado un error durante la eliminación del registro. Por favor inténtelo de nuevo, si el error persiste, comuníquese con el administrador del sistema","error")})["finally"](function(){e.reloadData()})}else swal("Cancelación","La operación ha sido cancelada","error")})})};e.reloadData=function(){e.dtInstanceArl.reloadData()},e.viewGeneralParameter=function(a){e.parameter.id=a,e.isView=!0,e.onLoadRecord()},e.editGeneralParameter=function(a){e.parameter.id=a,e.isView=!1,e.onLoadRecord()}}]);
"use strict";app.controller("configurationDisabilityDiagnosticListCtrl",["$scope","$stateParams","$log","DTOptionsBuilder","DTColumnBuilder","DTColumnDefBuilder","$compile","toaster","$state","$rootScope","$timeout","$http","SweetAlert","$aside","$document",function(i,n,o,t,e,a,r,l,s,c,d,u,f,p,g){var m=o;m.info("loading..configurationDisabilityDiagnosticListCtrl "),i.loading=!0,i.isView=!1;var w=function(){i.diagnostic={id:0,code:"",description:"",isActive:!0}};w(),i.onLoadRecord=function(){if(0!=i.diagnostic.id){var n={id:i.diagnostic.id};u({method:"GET",url:"api/disability-diagnostic",params:n})["catch"](function(i,n){if(403==n){var o=null!==i.message&&void 0!==i.message?i.message:"app.clientes.list";f.swal("No Autorizado","No estas autorizado para ver esta información.","error"),d(function(){s.go(o)},3e3)}else 404==n?f.swal("Información no disponible","Diagnóstico no encontrado","error"):f.swal("Error","Se ha presentado un error al intentar acceder a la información del proceso","error")}).then(function(n){d(function(){i.diagnostic=n.data.result})})["finally"](function(){d(function(){i.loading=!1},400),d(function(){g.scrollTop(40,2e3)})})}else i.loading=!1},i.onLoadRecord(),i.master=i.diagnostic,i.form={submit:function(n){var o=null;if(n.$invalid){var t=null,o=null;for(t in n)"$"!=t[0]&&(null!==o||n[t].$valid||(o=n[t].$name),n[t].$pristine&&(n[t].$dirty=!0));return m.info(i.diagnostic),angular.element(".ng-invalid[name="+o+"]").focus(),void f.swal("El formulario contiene errores!","Por favor corrige los errores del formulario e Intentalo de nuevo.","error")}f.swal("Validación exitosa","Guardando información del diagnóstico...","success"),h()},reset:function(n){i.diagnostic=angular.copy(i.master),n.$setPristine(!0)}},i.onCancel=function(){d(function(){w()},30),i.isView=!1},i.cancelEdition=function(n){null!=i.$parent&&i.$parent.navToSection("summary","summary",i.diagnostic_id)};var h=function(){var n={},t=JSON.stringify(i.diagnostic);return n.data=Base64.encode(t),u({method:"POST",url:"api/disability-diagnostic/save",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(n)}).then(function(n){d(function(){i.diagnostic=n.data.result,i.reloadData()})})["catch"](function(i){o.error(i),f.swal("Error de guardado","Error guardando el registro. Por favor verifique los datos ingresados!","error")})["finally"](function(){i.onCancel()})};i.dtOptionsDisabilityDiagnostic=t.newOptions().withBootstrap().withOption("responsive",!0).withOption("ajax",{data:function(i){return JSON.stringify(i)},url:"api/disability-diagnostic",contentType:"application/json",type:"POST",beforeSend:function(){},complete:function(){}}).withDataProp("data").withOption("order",[[1,"asc"]]).withOption("serverSide",!0).withOption("processing",!0).withOption("fnPreDrawCallback",function(){return!0}).withOption("fnDrawCallback",function(){b()}).withOption("language",{}).withPaginationType("full_numbers").withOption("createdRow",function(n,o,t){r(angular.element(n).contents())(i)}),i.dtColumnsDisabilityDiagnostic=[e.newColumn(null).withTitle("Acciones").withOption("width",150).notSortable().renderWith(function(i,n,o,t){var e="",a="",r='<a class="btn btn-primary btn-xs editRow lnk" href="#" uib-tooltip="Editar"  data-id="'+i.id+'"'+a+' >   <i class="fa fa-edit"></i></a> ',l='<a class="btn btn-info btn-xs viewRow lnk" href="#"  uib-tooltip="Ver" data-id="'+i.id+'" >   <i class="fa fa-eye"></i></a> ',s='<a class="btn btn-danger btn-xs delRow lnk" href="#"  uib-tooltip="Eliminar" data-id="'+i.id+'"'+a+' >   <i class="fa fa-trash-o"></i></a> ';return c.can("clientes_view")&&(e+=l),c.can("clientes_edit")&&(e+=r),c.can("clientes_delete")&&(e+=s),e}),e.newColumn("code").withTitle("Código").withOption("width",200),e.newColumn("description").withTitle("Diagnóstico"),e.newColumn(null).withTitle("Estado").withOption("width",200).renderWith(function(i,n,o,t){var e="label label-danger";null==i.isActive&&void 0==i.isActive||(e=i.isActive?"label label-success":"label label-danger");var a='<span class="'+e+'">'+i.status+"</span>";return a})];var b=function(){$("#dtDisabilityDiagnostic a.editRow").on("click",function(){var n=$(this).data("id");i.editDisabilityDiagnostic(n)}),$("#dtDisabilityDiagnostic a.viewRow").on("click",function(){var n=$(this).data("id");i.diagnostic.id=n,i.viewDisabilityDiagnostic(n)}),$("#dtDisabilityDiagnostic a.delRow").on("click",function(){var n=$(this).data("id");m.info("intenta eliminar el registro: "+n),f.swal({title:"Está seguro?",text:"Eliminará el registro seleccionado.",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Si, eliminar!",cancelButtonText:"No, continuar!",closeOnConfirm:!0,closeOnCancel:!0},function(t){if(t){var e={};e.id=n,u({method:"POST",url:"api/disability-diagnostic/delete",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(e)}).then(function(i){swal("Eliminado","Registro eliminado satisfactoriamente","info")})["catch"](function(i){o.error(i),f.swal("Error en la eliminación","Se ha presentado un error durante la eliminación del registro. Por favor inténtelo de nuevo, si el error persiste, comuníquese con el administrador del sistema","error")})["finally"](function(){i.reloadData()})}else swal("Cancelación","La operación ha sido cancelada","error")})})};i.dtInstanceDisabilityDiagnosticCallback=function(n){i.dtInstanceDisabilityDiagnostic=n},i.reloadData=function(){i.dtInstanceDisabilityDiagnostic.reloadData()},i.viewDisabilityDiagnostic=function(n){i.diagnostic.id=n,i.isView=!0,i.onLoadRecord()},i.editDisabilityDiagnostic=function(n){i.diagnostic.id=n,i.isView=!1,i.onLoadRecord()},i.onUpload=function(){var n=p.open({templateUrl:"app_configuration_disability_diagnostic_import.htm",placement:"bottom",size:"lg",backdrop:!0,controller:"ModalInstanceSideUploadDisabilityDiagnosticCtrl",scope:i});n.result.then(function(){i.reloadData()})}}]),app.controller("ModalInstanceSideUploadDisabilityDiagnosticCtrl",["$stateParams","$scope","FileUploader","$uibModalInstance","$log","$timeout","SweetAlert","$http","toaster",function(i,n,o,t,e,a,r,l,s){var c=n.uploader=new o({url:"api/disability-diagnostic/import",formData:[]});c.filters.push({name:"customFilter",fn:function(i,n){return this.queue.length<10}}),c.onWhenAddingFileFailed=function(i,n,o){console.info("onWhenAddingFileFailed",i,n,o)},c.onAfterAddingFile=function(i){console.info("onAfterAddingFile",i)},c.onAfterAddingAll=function(i){console.info("onAfterAddingAll",i)},c.onBeforeUploadItem=function(i){console.info("onBeforeUploadItem",i)},c.onProgressItem=function(i,n){console.info("onProgressItem",i,n)},c.onProgressAll=function(i){console.info("onProgressAll",i)},c.onSuccessItem=function(i,n,o,t){console.info("onSuccessItem",i,n,o,t)},c.onErrorItem=function(i,n,o,t){console.info("onErrorItem",i,n,o,t)},c.onCancelItem=function(i,n,o,t){console.info("onCancelItem",i,n,o,t)},c.onCompleteItem=function(i,n,o,t){console.info("onCompleteItem",i,n,o,t)},c.onCompleteAll=function(){console.info("onCompleteAll"),t.close(1)}}]);
"use strict";app.controller("configurationProjectTaskTypeListCtrl",["$scope","$stateParams","$log","DTOptionsBuilder","DTColumnBuilder","DTColumnDefBuilder","$compile","toaster","$state","$rootScope","$timeout","$http","SweetAlert","$aside","$document",function(e,t,n,a,i,o,r,c,l,s,d,p,u,f,T){var w=n,m={};w.info("loading..configurationProjectTaskTypeListCtrl "),e.loading=!0,e.isView=!1;var h=function(){e.projectTaskType={id:0,code:"",description:"",price:0,isActive:!0}};h(),e.onLoadRecord=function(){if(0!=e.projectTaskType.id){var t={id:e.projectTaskType.id};p({method:"GET",url:"api/project-task-type",params:t})["catch"](function(e,t){if(403==t){var n=null!==e.message&&void 0!==e.message?e.message:"app.clientes.list";u.swal("No Autorizado","No estas autorizado para ver esta información.","error"),d(function(){l.go(n)},3e3)}else 404==t?u.swal("Información no disponible","Diagnóstico no encontrado","error"):u.swal("Error","Se ha presentado un error al intentar acceder a la información del proceso","error")}).then(function(t){d(function(){e.projectTaskType=t.data.result})})["finally"](function(){d(function(){e.loading=!1},400),d(function(){T.scrollTop(40,2e3)})})}else e.loading=!1},e.onLoadRecord(),e.master=e.projectTaskType,e.form={submit:function(t){var n=null;if(t.$invalid){var a=null,n=null;for(a in t)"$"!=a[0]&&(null!==n||t[a].$valid||(n=t[a].$name),t[a].$pristine&&(t[a].$dirty=!0));return w.info(e.projectTaskType),angular.element(".ng-invalid[name="+n+"]").focus(),void u.swal("El formulario contiene errores!","Por favor corrige los errores del formulario e Intentalo de nuevo.","error")}u.swal("Validación exitosa","Guardando información del projectTaskTypeo...","success"),y()},reset:function(t){e.projectTaskType=angular.copy(e.master),t.$setPristine(!0)}},e.onCancel=function(){d(function(){h()},30),e.isView=!1},e.cancelEdition=function(t){null!=e.$parent&&e.$parent.navToSection("summary","summary",e.projectTaskType_id)};var y=function(){var t={},a=JSON.stringify(e.projectTaskType);return t.data=Base64.encode(a),p({method:"POST",url:"api/project-task-type/save",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(t)}).then(function(t){d(function(){e.projectTaskType=t.data.result,e.reloadData()})})["catch"](function(e){n.error(e),u.swal("Error de guardado","Error guardando el registro. Por favor verifique los datos ingresados!","error")})["finally"](function(){e.onCancel()})};m.operation="projectTaskType",e.dtInstanceProjectTaskType={},e.dtOptionsProjectTaskType=a.newOptions().withBootstrap().withOption("responsive",!0).withOption("ajax",{data:m,url:"api/project-task-type",type:"POST",beforeSend:function(){},complete:function(){}}).withDataProp("data").withOption("order",[[0,"desc"]]).withOption("serverSide",!0).withOption("processing",!0).withOption("fnPreDrawCallback",function(){return!0}).withOption("fnDrawCallback",function(){v()}).withOption("language",{}).withPaginationType("full_numbers").withOption("createdRow",function(t,n,a){r(angular.element(t).contents())(e)}),e.dtColumnsProjectTaskType=[i.newColumn(null).withTitle("Acciones").withOption("width",150).notSortable().renderWith(function(e,t,n,a){var i="",o="",r='<a class="btn btn-primary btn-xs editRow lnk" href="#" uib-tooltip="Editar"  data-id="'+e.id+'"'+o+' >   <i class="fa fa-edit"></i></a> ',c='<a class="btn btn-info btn-xs viewRow lnk" href="#"  uib-tooltip="Ver" data-id="'+e.id+'" >   <i class="fa fa-eye"></i></a> ',l='<a class="btn btn-danger btn-xs delRow lnk" href="#"  uib-tooltip="Eliminar" data-id="'+e.id+'"'+o+' >   <i class="fa fa-trash-o"></i></a> ';return s.can("clientes_view")&&(i+=c),s.can("clientes_edit")&&(i+=r),s.can("clientes_delete")&&(i+=l),i}),i.newColumn("code").withTitle("Código").withOption("width",200),i.newColumn("description").withTitle("Tipo Tarea"),i.newColumn("price").withTitle("Valor Hora").withOption("width",200),i.newColumn(null).withTitle("Estado").withOption("width",200).renderWith(function(e,t,n,a){var i="label label-danger",o="Inactivo";null==e.isActive&&void 0==e.isActive||(e.isActive?(i="label label-success",o="Activo"):(i="label label-danger",o="Inactivo"));var r='<span class="'+i+'">'+o+"</span>";return r})];var v=function(){$("#dtProjectTaskType a.editRow").on("click",function(){var t=$(this).data("id");e.editProjectTaskType(t)}),$("#dtProjectTaskType a.viewRow").on("click",function(){var t=$(this).data("id");e.projectTaskType.id=t,e.viewProjectTaskType(t)}),$("#dtProjectTaskType a.delRow").on("click",function(){var t=$(this).data("id");w.info("intenta eliminar el registro: "+t),u.swal({title:"Está seguro?",text:"Eliminará el registro seleccionado.",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Si, eliminar!",cancelButtonText:"No, continuar!",closeOnConfirm:!0,closeOnCancel:!0},function(a){if(a){var i={};i.id=t,p({method:"POST",url:"api/project-task-type/delete",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(i)}).then(function(e){swal("Eliminado","Registro eliminado satisfactoriamente","info")})["catch"](function(e){n.error(e),u.swal("Error en la eliminación","Se ha presentado un error durante la eliminación del registro. Por favor inténtelo de nuevo, si el error persiste, comuníquese con el administrador del sistema","error")})["finally"](function(){e.reloadData()})}else swal("Cancelación","La operación ha sido cancelada","error")})})};e.reloadData=function(){e.dtInstanceProjectTaskType.reloadData()},e.viewProjectTaskType=function(t){e.projectTaskType.id=t,e.isView=!0,e.onLoadRecord()},e.editProjectTaskType=function(t){e.projectTaskType.id=t,e.isView=!1,e.onLoadRecord()}}]);
"use strict";app.controller("configurationProgramPreventionTabsCtrl",["$scope","$stateParams","$log","$compile","$rootScope","$timeout","$state","$filter","flowFactory","$http",function(t,e,i,a,r,c,n,s,o,m){n.is("app.certificate.admin.view")?t.certificate_admin_title_tab="view":n.is("app.certificate.admin.create")?t.certificate_admin_title_tab="create":t.certificate_admin_title_tab="edit",t.isAgent="agent"==r.currentUser().wg_type,t.isAdmin="system"==r.currentUser().wg_type,t.isCustomer="customerAdmin"==r.currentUser().wg_type||"customerUser"==r.currentUser().wg_type,t.tabsloaded=["program"],t.tabname="program",t.titletab=t.certificate_admin_title_tab,t.switchTab=function(e,i){c(function(){t.tabname=e,t.titletab=i,t.tabsloaded.push(e)})},t.switchSubTab=function(e){c(function(){t.subtab=e})}}]);
"use strict";app.controller("configurationProgramPreventionQuestionListCtrl",["$scope","$stateParams","$log","DTOptionsBuilder","DTColumnBuilder","DTColumnDefBuilder","$compile","toaster","$state","$rootScope","$timeout","$http","SweetAlert","$document","$aside",function(n,t,i,o,e,a,r,s,l,u,c,d,p,f,m){var g=i,w={};g.info("loading..customerConfigManagementQuestionesCtrl "),w.operation="diagnostic",n.dtInstanceProgramPreventionQuestion={},n.dtOptionsProgramPreventionQuestion=o.newOptions().withBootstrap().withOption("responsive",!0).withOption("ajax",{data:w,url:"api/configuration/program-prevention-question",type:"POST",beforeSend:function(){},complete:function(n){c(function(){})}}).withDataProp("data").withOption("order",[[0,"desc"]]).withOption("serverSide",!0).withOption("processing",!0).withOption("fnPreDrawCallback",function(){return!0}).withOption("fnDrawCallback",function(){h()}).withDOM("tr").withOption("language",{}).withOption("createdRow",function(t,i,o){r(angular.element(t).contents())(n)}),n.dtColumnsProgramPreventionQuestion=[e.newColumn(null).withTitle("").withOption("width",100).notSortable().renderWith(function(t,i,o,e){var a="",r="",s='<a class="btn btn-purple btn-xs configureRow lnk" href="#" uib-tooltip="Configurar pregunta"  data-id="'+t.id+'"'+r+' >   <i class="fa fa-gear"></i></a> ',l='<a class="btn btn-danger btn-xs configureSizeRow lnk" href="#" uib-tooltip="Clasificar pregunta"  data-id="'+t.id+'"'+r+' >   <i class="fa fa-bars"></i></a> ';return n.isAdmin,a+=s,a+=l}),e.newColumn("id").withTitle("ID").withOption("width",50),e.newColumn("program").withTitle("Programa").withOption("width",350),e.newColumn("category").withTitle("Categoría"),e.newColumn("article").withTitle("Artículo"),e.newColumn("question").withTitle("Pregunta"),e.newColumn("classification").withOption("width",200).withTitle("Clasificación"),e.newColumn("guide").withTitle("Guía").withOption("width",100).renderWith(function(n,t,i,o){var e="",a="";null!=n&&""!=n?(a="Tiene",e="label label-success"):(a="No tiene",e="label label-danger");var r='<span class="'+e+'">'+a+"</span>";return r})];var h=function(){$("#dtProgramPreventionQuestion a.configureRow").on("click",function(){var t=$(this).data("id");n.onEditQuestion(t)}),$("#dtProgramPreventionQuestion a.configureSizeRow").on("click",function(){var t=$(this).data("id");n.onClassifyQuestion(t)})};n.reloadData=function(){n.dtInstanceProgramPreventionQuestion.reloadData()},n.onEditQuestion=function(t){var i={id:t},o=m.open({templateUrl:u.app.views.urlRoot+"modules/configuration/business-programs/program_prevention_question_modal.htm",placement:"right",size:"lg",backdrop:!0,controller:"ModalInstanceSideProgramPreventionQuestionCtrl",scope:n,resolve:{question:function(){return i}}});o.result.then(function(){n.reloadData()})},n.onClassifyQuestion=function(t){var i={id:t},o=m.open({templateUrl:u.app.views.urlRoot+"modules/configuration/business-programs/program_prevention_question_modal.htm",placement:"right",size:"lg",backdrop:!0,controller:"ModalInstanceSideProgramPreventionQuestionClassificationCtrl",scope:n,resolve:{question:function(){return i}}});o.result.then(function(){n.reloadData()})}}]),app.controller("ModalInstanceSideProgramPreventionQuestionCtrl",["$rootScope","$scope","$uibModalInstance","question","$log","$timeout","SweetAlert","$http","toaster","$filter","FileUploader","DTColumnBuilder","DTOptionsBuilder","$compile","$document",function(n,t,i,o,e,a,r,s,l,u,c,d,p,f,m){t.isConfigurationMode=!0,t.workplaces=[],t.macros=[],t.processes=[],t.question=o,t.onCloseModal=function(){i.close(1)},t.onCancel=function(){i.dismiss("cancel")};var g=function(){if(t.question.id){var n={id:t.question.id};s({method:"GET",url:"api/configuration/program-prevention-question",params:n})["catch"](function(n,t){}).then(function(n){a(function(){t.question=n.data.result})})["finally"](function(){a(function(){t.loading=!1},400)})}};g(),t.onSave=function(){var n={},i=JSON.stringify(t.question);return n.data=Base64.encode(i),s({method:"POST",url:"api/configuration/program-prevention-question/save",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(n)}).then(function(n){a(function(){r.swal("Validación exitosa","Procediendo con el guardado...","success"),t.onCloseModal()})})["catch"](function(n){e.error(n),r.swal("Error de guardado","Error guardando el registro. Por favor verifique los datos ingresados!","error")})["finally"](function(){})}}]),app.controller("ModalInstanceSideProgramPreventionQuestionClassificationCtrl",["$rootScope","$scope","$uibModalInstance","question","$log","$timeout","SweetAlert","$http","toaster","$filter","FileUploader","DTColumnBuilder","DTOptionsBuilder","$compile","$document",function(n,t,i,o,e,a,r,s,l,u,c,d,p,f,m){t.isConfigurationMode=!1,t.customerSizeList=n.parameters("wg_customer_size"),t.question=o,t.entity={id:0,programPreventionQuestionId:o.id,size:null},t.onCloseModal=function(){i.close(1)},t.onCancel=function(){i.dismiss("cancel")};var g=function(){if(t.question.id){var n={id:t.question.id};s({method:"GET",url:"api/configuration/program-prevention-question",params:n})["catch"](function(n,t){}).then(function(n){a(function(){t.question=n.data.result})})["finally"](function(){a(function(){t.loading=!1},400)})}};g(),t.onSave=function(){if(null==t.entity.size)return void r.swal("Error de guardado","Debe seleccionar el tamaño de la empresa","error");var n={},i=JSON.stringify(t.entity);return n.data=Base64.encode(i),s({method:"POST",url:"api/configuration/program-prevention-question-classification/save",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(n)}).then(function(n){a(function(){r.swal("Validación exitosa","Procediendo con el guardado...","success"),t.reloadData(),t.entity={id:0,programPreventionQuestionId:o.id,size:null}})})["catch"](function(n){e.error(n),r.swal("Error de guardado",n.message,"error")})["finally"](function(){})};var w={};w.operation="diagnostic",w.program_prevention_question_id=o.id?o.id:0,t.dtInstanceProgramPreventionQuestionClassification={},t.dtOptionsProgramPreventionQuestionClassification=p.newOptions().withBootstrap().withOption("responsive",!0).withOption("ajax",{data:w,url:"api/configuration/program-prevention-question-classification",type:"POST",beforeSend:function(){},complete:function(n){a(function(){})}}).withDataProp("data").withOption("order",[[0,"desc"]]).withOption("serverSide",!0).withOption("processing",!0).withOption("fnPreDrawCallback",function(){return!0}).withOption("fnDrawCallback",function(){h()}).withPaginationType("full_numbers").withOption("language",{}).withOption("createdRow",function(n,i,o){f(angular.element(n).contents())(t)}),t.dtColumnsProgramPreventionQuestionClassification=[d.newColumn(null).withTitle("").withOption("width",70).notSortable().renderWith(function(n,i,o,e){var a="",r='<a class="btn btn-light-red btn-xs delRow lnk" href="#" uib-tooltip="Eliminar registro" data-id="'+n.id+'" >   <i class="fa fa-trash"></i></a> ';return t.isAdmin,a+=r}),d.newColumn("customerSize.item").withTitle("Clasificación").withOption("defaultContent","")];var h=function(){$("#dtProgramPreventionQuestionClassification a.delRow").on("click",function(){var n=$(this).data("id");r.swal({title:"Está seguro?",text:"Eliminará el registro seleccionado.",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Si, eliminar!",cancelButtonText:"No, cancelar!",closeOnConfirm:!0,closeOnCancel:!0},function(i){if(i){var o={};o.id=n,s({method:"POST",url:"api/configuration/program-prevention-question-classification/delete",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(o)}).then(function(n){swal("Eliminado","Registro eliminado satisfactoriamente","info")})["catch"](function(n){e.error(n),r.swal("Error en la eliminación","Se ha presentado un error durante la eliminación del registro. Por favor inténtelo de nuevo, si el error persiste, comuníquese con el administrador del sistema","error")})["finally"](function(){t.reloadData()})}else swal("Cancelación","La operación ha sido cancelada","error")})})};t.dtInstanceProgramPreventionQuestionClassificationCallback=function(n){t.dtInstanceProgramPreventionQuestionClassification=n},t.reloadData=function(){t.dtInstanceProgramPreventionQuestionClassification.reloadData()}}]);
"use strict";app.controller("configurationManagementTabsCtrl",["$scope","$stateParams","$log","$compile","$rootScope","$timeout","$state","$filter","flowFactory","$http",function(t,e,i,a,r,c,n,s,o,m){n.is("app.certificate.admin.view")?t.certificate_admin_title_tab="view":n.is("app.certificate.admin.create")?t.certificate_admin_title_tab="create":t.certificate_admin_title_tab="edit",t.isAgent="agent"==r.currentUser().wg_type,t.isAdmin="system"==r.currentUser().wg_type,t.isCustomer="customerAdmin"==r.currentUser().wg_type||"customerUser"==r.currentUser().wg_type,t.tabsloaded=["program"],t.tabname="program",t.titletab=t.certificate_admin_title_tab,t.switchTab=function(e,i){c(function(){t.tabname=e,t.titletab=i,t.tabsloaded.push(e)})},t.switchSubTab=function(e){c(function(){t.subtab=e})}}]);
"use strict";app.controller("configurationManagementProgramListCtrl",["$scope","$stateParams","$log","DTOptionsBuilder","DTColumnBuilder","DTColumnDefBuilder","$compile","toaster","$state","$rootScope","$timeout","$http","SweetAlert","$document",function(a,n,e,o,i,t,r,l,c,s,d,u,m,g){var f=e,p={};f.info("loading..customerConfigWorkPlaceListCtrl "),a.loading=!0,a.customerId=n.customerId,a.isview=!1,a.program={},a.status=s.parameters("config_workplace_status"),a.onLoadRecord=function(){if(0!=a.program.id){f.info("editando cliente con código: "+a.program.id);var n={id:a.program.id};u({method:"GET",url:"api/configuration/management-program",params:n})["catch"](function(a,n){if(403==n){var e=null!==a.message&&void 0!==a.message?a.message:"app.clientes.list";m.swal("No Autorizado","No estas autorizado para ver esta información.","error"),d(function(){c.go(e)},3e3)}else 404==n?m.swal("Información no disponible","Centro de trabajo no encontrado","error"):m.swal("Error","Se ha presentado un error al intentar acceder a la información del centro de trabajo","error")}).then(function(n){d(function(){a.program=n.data.result,a.program.isWeighted="Sí"==a.program.isWeighted})})["finally"](function(){d(function(){a.loading=!1},400),d(function(){g.scrollTop(40,2e3)})})}else f.info("creacion de nuevo cliente"),a.loading=!1};var w=function(){a.program={id:0,name:"",abbreviation:"",status:null,color:"#5cb85c",highlightColor:"#5cb85c",version:"1",isWeighted:!1}};w(),a.onLoadRecord();a.master=a.program,a.form={submit:function(n){var e=null;if(n.$invalid){var o=null,e=null;for(o in n)"$"!=o[0]&&(null!==e||n[o].$valid||(e=n[o].$name),n[o].$pristine&&(n[o].$dirty=!0));return f.info(a.program),angular.element(".ng-invalid[name="+e+"]").focus(),void m.swal("El formulario contiene errores!","Por favor corrige los errores del formulario e Intentalo de nuevo.","error")}m.swal("Validación exitosa","Guardando información del centro de trabajo...","success"),save()},reset:function(n){a.clear()}},a.clear=function(){d(function(){w()}),a.isview=!1},a.save=function(){var n={},o=JSON.stringify(a.program);return n.data=Base64.encode(o),u({method:"POST",url:"api/configuration/management-program/save",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(n)}).then(function(n){d(function(){a.program=n.data.result,m.swal("Validación exitosa","Información guardada","success"),a.reloadData()})})["catch"](function(a){e.error(a),m.swal("Error de guardado","Error guardando el registro. Por favor verifique los datos ingresados!","error")})["finally"](function(){a.clear()})},p.operation="diagnostic",p.customerId=a.customerId,a.dtInstanceConfigManagementProgram={},a.dtOptionsConfigManagementProgram=o.newOptions().withBootstrap().withOption("responsive",!0).withOption("ajax",{data:p,url:"api/configuration/management-program",type:"POST",beforeSend:function(){},complete:function(){}}).withDataProp("data").withOption("order",[[0,"desc"]]).withOption("serverSide",!0).withOption("processing",!0).withOption("fnPreDrawCallback",function(){return!0}).withOption("fnDrawCallback",function(){h()}).withOption("language",{}).withPaginationType("full_numbers").withOption("createdRow",function(n,e,o){r(angular.element(n).contents())(a)}),a.dtColumnsConfigManagementProgram=[i.newColumn(null).withTitle("Acciones").withOption("width",150).notSortable().renderWith(function(a,n,e,o){var i="",t="",r='<a class="btn btn-primary btn-xs editRow lnk" href="#" uib-tooltip="Editar"  data-id="'+a.id+'"'+t+' >   <i class="fa fa-edit"></i></a> ',l='<a class="btn btn-info btn-xs viewRow lnk" href="#"  uib-tooltip="Ver" data-id="'+a.id+'" >   <i class="fa fa-eye"></i></a> ',c='<a class="btn btn-danger btn-xs delRow lnk" href="#"  uib-tooltip="Inactivar" data-id="'+a.id+'"'+t+' >   <i class="fa fa-ban"></i></a> ';return s.can("clientes_view")&&(i+=l),s.can("clientes_edit")&&(i+=r),s.can("clientes_delete")&&(i+=c),i}),i.newColumn("name").withTitle("Programa").withOption("width",200),i.newColumn("abbreviation").withTitle("Abreviación").withOption("width",200),i.newColumn("color").withTitle("Color 1").withOption("width",200),i.newColumn("color").withTitle("Color 2").withOption("width",200),i.newColumn("status.item").withTitle("Estado").withOption("width",200).renderWith(function(a,n,e,o){var i="";switch(a){case"Activo":i="label label-success";break;case"Inactivo":i="label label-danger";break;case"Retirado":i="label label-warning"}var t='<span class="'+i+'">'+a+"</span>";return t}),i.newColumn("isWeighted").withTitle("Ponderado").withOption("width",200).renderWith(function(a,n,e,o){var i="";switch(a){case"Sí":i="label label-success";break;case"No":i="label label-danger"}var t='<span class="'+i+'">'+a+"</span>";return t})],a.viewConfigManagementProgram=function(n){a.program.id=n,a.isview=!0,a.onLoadRecord()},a.cancelEdition=function(n){null!=a.$parent&&a.$parent.navToSection("summary","summary",a.customerId)};var h=function(){$("#dtConfigManagementProgram a.editRow").on("click",function(){var n=$(this).data("id");a.editConfigManagementProgram(n)}),$("#dtConfigManagementProgram a.viewRow").on("click",function(){var n=$(this).data("id");a.program.id=n,a.viewConfigManagementProgram(n)}),$("#dtConfigManagementProgram a.delRow").on("click",function(){var n=$(this).data("id");f.info("intenta eliminar el registro: "+n),m.swal({title:"Está seguro?",text:"Eliminará el registro seleccionado.",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Si, eliminar!",cancelButtonText:"No, continuar!",closeOnConfirm:!0,closeOnCancel:!0},function(o){if(o){var i={};i.id=n,u({method:"POST",url:"api/configuration/management-program/delete",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(i)}).then(function(a){swal("Eliminado","Registro eliminado satisfactoriamente","info")})["catch"](function(a){e.error(a),m.swal("Error en la eliminación","Se ha presentado un error durante la eliminación del registro. Por favor inténtelo de nuevo, si el error persiste, comuníquese con el administrador del sistema","error")})["finally"](function(){a.reloadData()})}else swal("Cancelación","La operación ha sido cancelada","error")})})};a.reloadData=function(){a.dtInstanceConfigManagementProgram.reloadData()},a.editConfigManagementProgram=function(n){a.program.id=n,a.isview=!1,a.onLoadRecord()}}]);
"use strict";app.controller("configurationManagementCategoryListCtrl",["$scope","$stateParams","$log","DTOptionsBuilder","DTColumnBuilder","DTColumnDefBuilder","$compile","toaster","$state","$rootScope","$timeout","$http","SweetAlert","$document",function(a,e,n,t,o,r,i,c,l,s,d,u,f,g){var m=n,p={};m.info("loading..customerConfigCategoryManagementProcessesCtrl "),a.loading=!0,a.customerId=e.customerId,a.isview=!1,a.category={},a.status=s.parameters("config_workplace_status"),a.types=s.parameters("wg_structure_type"),a.programs=[],a.onLoadRecord=function(){if(0!=a.category.id){m.info("editando cliente con código: "+a.category.id);var e={id:a.category.id};u({method:"GET",url:"api/configuration/management-category",params:e})["catch"](function(a,e){if(403==e){var n=null!==a.message&&void 0!==a.message?a.message:"app.clientes.list";f.swal("No Autorizado","No estas autorizado para ver esta información.","error"),d(function(){l.go(n)},3e3)}else 404==e?f.swal("Información no disponible","Centro de trabajo no encontrado","error"):f.swal("Error","Se ha presentado un error al intentar acceder a la información del centro de trabajo","error")}).then(function(e){d(function(){a.category=e.data.result})})["finally"](function(){d(function(){a.loading=!1},400),d(function(){g.scrollTop(40,2e3)})})}else m.info("creacion de nuevo cliente"),a.loading=!1};var w=function(){var e={};return e.operation="diagnostic",e.customerId=a.customerId,u({method:"POST",url:"api/configuration/management-program/list",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(e)}).then(function(e){d(function(){a.programs=e.data.data})})["catch"](function(a){n.error(a),f.swal("Error de guardado","Error guardando el registro. Por favor verifique los datos ingresados!","error")})["finally"](function(){a.clear()})};w();var h=function(){a.category={id:0,program:null,name:"",status:null}};h(),a.onLoadRecord();a.master=a.category,a.form={submit:function(e){var n=null;if(e.$invalid){var t=null,n=null;for(t in e)"$"!=t[0]&&(null!==n||e[t].$valid||(n=e[t].$name),e[t].$pristine&&(e[t].$dirty=!0));return m.info(a.category),angular.element(".ng-invalid[name="+n+"]").focus(),void f.swal("El formulario contiene errores!","Por favor corrige los errores del formulario e Intentalo de nuevo.","error")}f.swal("Validación exitosa","Guardando información del centro de trabajo...","success"),save()},reset:function(e){a.clear()}},a.clear=function(){d(function(){h()}),a.isview=!1},a.save=function(){var e={},t=JSON.stringify(a.category);return e.data=Base64.encode(t),u({method:"POST",url:"api/configuration/management-category/save",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(e)}).then(function(e){d(function(){a.category=e.data.result,f.swal("Validación exitosa","Información guardada","success"),a.reloadData()})})["catch"](function(a){n.error(a),f.swal("Error de guardado","Error guardando el registro. Por favor verifique los datos ingresados!","error")})["finally"](function(){a.clear()})},p.operation="diagnostic",p.customerId=a.customerId,a.dtInstanceConfigCategoryManagement={},a.dtOptionsConfigCategoryManagement=t.newOptions().withBootstrap().withOption("responsive",!0).withOption("ajax",{data:p,url:"api/configuration/management-category",type:"POST",beforeSend:function(){},complete:function(){}}).withDataProp("data").withOption("order",[[0,"desc"]]).withOption("serverSide",!0).withOption("processing",!0).withOption("fnPreDrawCallback",function(){return!0}).withOption("fnDrawCallback",function(){v()}).withOption("language",{}).withPaginationType("full_numbers").withOption("createdRow",function(e,n,t){i(angular.element(e).contents())(a)}),a.dtColumnsConfigCategoryManagement=[o.newColumn(null).withTitle("Acciones").withOption("width",150).notSortable().renderWith(function(a,e,n,t){var o="",r="",i='<a class="btn btn-primary btn-xs editRow lnk" href="#" uib-tooltip="Editar"  data-id="'+a.id+'"'+r+' >   <i class="fa fa-edit"></i></a> ',c='<a class="btn btn-info btn-xs viewRow lnk" href="#"  uib-tooltip="Ver" data-id="'+a.id+'" >   <i class="fa fa-eye"></i></a> ',l='<a class="btn btn-danger btn-xs delRow lnk" href="#"  uib-tooltip="Eliminar" data-id="'+a.id+'"'+r+' >   <i class="fa fa-trash-o"></i></a> ';return s.can("clientes_view")&&(o+=c),s.can("clientes_edit")&&(o+=i),s.can("clientes_delete")&&(o+=l),o}),o.newColumn("program.name").withTitle("Programa").withOption("width",200).withOption("defaultContent",""),o.newColumn("name").withTitle("Categoría"),o.newColumn("status.item").withTitle("Estado").withOption("width",200).renderWith(function(a,e,n,t){var o="";switch(a){case"Activo":o="label label-success";break;case"Inactivo":o="label label-danger";break;case"Retirado":o="label label-warning"}var r='<span class="'+o+'">'+a+"</span>";return r})],a.viewConfigCategoryManagement=function(e){a.category.id=e,a.isview=!0,a.onLoadRecord()},a.cancelEdition=function(e){null!=a.$parent&&a.$parent.navToSection("summary","summary",a.customerId)};var v=function(){$("#dtConfigCategoryManagement a.editRow").on("click",function(){var e=$(this).data("id");a.editConfigCategoryManagement(e)}),$("#dtConfigCategoryManagement a.viewRow").on("click",function(){var e=$(this).data("id");a.category.id=e,a.viewConfigCategoryManagement(e)}),$("#dtConfigCategoryManagement a.delRow").on("click",function(){var e=$(this).data("id");m.info("intenta eliminar el registro: "+e),f.swal({title:"Está seguro?",text:"Eliminará el registro seleccionado.",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Si, eliminar!",cancelButtonText:"No, continuar!",closeOnConfirm:!0,closeOnCancel:!0},function(t){if(t){var o={};o.id=e,u({method:"POST",url:"api/configuration/management-category/delete",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(o)}).then(function(a){swal("Eliminado","Registro eliminado satisfactoriamente","info")})["catch"](function(a){n.error(a),f.swal("Error en la eliminación","Se ha presentado un error durante la eliminación del registro. Por favor inténtelo de nuevo, si el error persiste, comuníquese con el administrador del sistema","error")})["finally"](function(){a.reloadData()})}else swal("Cancelación","La operación ha sido cancelada","error")})})};a.reloadData=function(){a.dtInstanceConfigCategoryManagement.reloadData()},a.editConfigCategoryManagement=function(e){a.category.id=e,a.isview=!1,a.onLoadRecord()},a.createConfigCategoryManagement=function(){var t={},o={id:0,customerId:e.customerId,status:{id:0,item:"Iniciado",value:"iniciado"}},r=JSON.stringify(o);t.data=Base64.encode(r),u({method:"POST",url:"api/configuration/management-category/save",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(t)}).then(function(e){null!=a.$parent&&(a.reloadData(),swal("Creado","Centro de trabajo adicionado satisfactoriamente","info"))})["catch"](function(a){n.error(a),f.swal("Error Creando","Se ha presentado un error durante la creación del centro de trabajo por favor intentelo de nuevo","error")})["finally"](function(){})},a.refreshProgram=function(){w()}}]);
"use strict";app.controller("configurationManagemenEconomicSectorListCtrl",["$scope","$stateParams","$log","DTOptionsBuilder","DTColumnBuilder","DTColumnDefBuilder","$compile","toaster","$state","$rootScope","$timeout","$http","SweetAlert","$aside","ListService",function(n,e,t,o,a,r,i,c,l,s,m,u,d,g,f){var p=null,w=function(){var e=[{name:"economic_sector",value:null},{name:"management_program",value:null}];f.getDataList(e).then(function(e){n.economicSectorList=e.data.data.economicSectorList,n.programList=e.data.data.managementProgramList},function(n){})};w(),n.isAgent="agent"==s.currentUser().wg_type,n.isAdmin="system"==s.currentUser().wg_type,n.isCustomer="customerAdmin"==s.currentUser().wg_type||"customerUser"==s.currentUser().wg_type;var h=function(){n.entity={id:0,program:null,economicSector:null,isActive:!0},p&&p.$setPristine(!0)};h(),n.form={submit:function(n){p=n;var e=null;if(n.$invalid){var t=null,e=null;for(t in n)"$"!=t[0]&&(null!==e||n[t].$valid||(e=n[t].$name),n[t].$pristine&&(n[t].$dirty=!0));return angular.element(".ng-invalid[name="+e+"]").focus(),void d.swal("El formulario contiene errores!","Por favor corrige los errores del formulario e Intentalo de nuevo.","error")}v()},reset:function(n){n.$setPristine(!0)}};var v=function(){var e={},t=JSON.stringify(n.entity);return e.data=Base64.encode(t),u({method:"POST",url:"api/program-management-economic-sector/save",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(e)}).then(function(e){m(function(){d.swal("Registro","La información ha sido guardada satisfactoriamente","success"),n.onCancel(),n.reloadData()})})["catch"](function(n){400==n.status?d.swal("Error de guardado",n.data.message,"error"):d.swal("Error de guardado","Error guardando el registro por favor verifique los datos ingresados!","error")})["finally"](function(){})};n.onCancel=function(){h()},n.onRefresh=function(){w()},n.dtInstanceProgramManagementEconomicSector={},n.dtOptionsProgramManagementEconomicSector=o.newOptions().withBootstrap().withOption("responsive",!0).withOption("ajax",{data:function(n){return JSON.stringify(n)},url:"api/program-management-economic-sector",contentType:"application/json",type:"POST",beforeSend:function(){},complete:function(){}}).withDataProp("data").withOption("order",[[0,"desc"]]).withOption("serverSide",!0).withOption("processing",!0).withOption("fnPreDrawCallback",function(){return!0}).withOption("fnDrawCallback",function(){S()}).withOption("language",{}).withPaginationType("full_numbers").withOption("createdRow",function(e,t,o){i(angular.element(e).contents())(n)}),n.dtColumnsProgramManagementEconomicSector=[a.newColumn(null).withTitle("Acciones").withOption("width",80).notSortable().renderWith(function(n,e,t,o){var a="",r='<a class="btn btn-danger btn-xs delRow lnk" href="#" tooltip="Eliminar" data-id="'+n.id+'" >   <i class="fa fa-trash-o"></i></a> ';return a+=r}),a.newColumn("economicSector").withTitle("Sector Económico").withOption("defaultContent",""),a.newColumn("program").withTitle("Programa Empresarial").withOption("width",500).withOption("defaultContent","")];var S=function(){angular.element("#dtProgramManagementEconomicSector a.editRow").on("click",function(){var e=angular.element(this).data("id");n.onEdit(e)}),angular.element("#dtProgramManagementEconomicSector a.viewRow").on("click",function(){var e=angular.element(this).data("id");n.onView(e)}),angular.element("#dtProgramManagementEconomicSector a.delRow").on("click",function(){var e=angular.element(this).data("id");d.swal({title:"Está seguro?",text:"Eliminará el registro seleccionado.",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Si, eliminar!",cancelButtonText:"No, continuar!",closeOnConfirm:!0,closeOnCancel:!0},function(t){if(t){var o={};o.id=e,u({method:"POST",url:"api/program-management-economic-sector/delete",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(o)}).then(function(n){swal("Eliminado","Regitro eliminado satisfactoriamente","info")})["catch"](function(n){400==n.status?d.swal("Error de integridad",n.data.message,"error"):d.swal("Error","Se ha presentado un error inesperado intentando eliminar el registro por favor intente nuevamente!","error")})["finally"](function(){n.reloadData()})}else swal("Cancelado","Operacion cancelada","error")})})};n.dtInstanceProgramManagementEconomicSectorCallback=function(e){n.dtInstanceProgramManagementEconomicSector=e},n.reloadData=function(){null!=n.dtInstanceProgramManagementEconomicSector&&n.dtInstanceProgramManagementEconomicSector.reloadData()}}]);
"use strict";app.controller("configurationManagementQuestionListCtrl",["$scope","$stateParams","$log","DTOptionsBuilder","DTColumnBuilder","DTColumnDefBuilder","$compile","toaster","$state","$rootScope","$timeout","$http","SweetAlert","$document","$aside",function(n,e,a,t,i,o,r,l,s,u,c,d,f,g,m){var p=a,w={};p.info("loading..customerConfigManagementQuestionesCtrl "),n.loading=!0,n.isview=!1,n.question={},n.status=u.parameters("config_workplace_status"),n.types=u.parameters("wg_structure_type"),n.programs=[],n.categories=[],n.pendingValue=function(){var e=n.question.weightedValue-(isNaN(n.question.originalWeightedValue)?0:n.question.originalWeightedValue),a=(100-n.question.program.weightedValueTotal-(isNaN(e)?0:e)).toFixed(2);return isNaN(a)?0:a},n.onLoadRecord=function(){if(0!=n.question.id){p.info("editando cliente con código: "+n.question.id);var e={id:n.question.id};d({method:"GET",url:"api/configuration/management-question",params:e})["catch"](function(n,e){if(403==e){var a=null!==n.message&&void 0!==n.message?n.message:"app.clientes.list";f.swal("No Autorizado","No estas autorizado para ver esta información.","error"),c(function(){s.go(a)},3e3)}else 404==e?f.swal("Información no disponible","Registro no encontrado","error"):f.swal("Error","Se ha presentado un error al intentar acceder a la información del centro de trabajo","error")}).then(function(e){c(function(){n.question=e.data.result,n.question.originalWeightedValue=n.question.weightedValue})})["finally"](function(){c(function(){n.loading=!1},400),c(function(){g.scrollTop(40,2e3)})})}else p.info("creacion de nuevo cliente"),n.loading=!1};var h=function(){var e={};return e.operation="diagnostic",d({method:"POST",url:"api/configuration/management-program/list",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(e)}).then(function(e){c(function(){n.programs=e.data.data,console.log(n.programs)})})["catch"](function(n){a.error(n),f.swal("Error de guardado","Error guardando el registro. Por favor verifique los datos ingresados!","error")})["finally"](function(){n.clear()})},v=function(){n.question={id:0,name:"",article:"",program:null,category:null,status:null}};v(),h();var C=function(){if(null!=n.question.program){var e={};return e.operation="diagnostic",e.program_id=n.question.program.id,d({method:"POST",url:"api/configuration/management-category/list",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(e)}).then(function(e){c(function(){n.categories=e.data.data})})["catch"](function(n){})["finally"](function(){})}n.categories=[]};n.$watch("question.program",function(){C()}),n.onLoadRecord();n.master=n.question,n.form={submit:function(e){var a=null;if(e.$invalid){var t=null,a=null;for(t in e)"$"!=t[0]&&(null!==a||e[t].$valid||(a=e[t].$name),e[t].$pristine&&(e[t].$dirty=!0));return p.info(n.question),angular.element(".ng-invalid[name="+a+"]").focus(),void f.swal("El formulario contiene errores!","Por favor corrige los errores del formulario e Intentalo de nuevo.","error")}f.swal("Validación exitosa","Guardando información del centro de trabajo...","success"),b()},reset:function(e){n.clear()}},n.clear=function(){c(function(){v()}),n.isview=!1};var b=function(){var e=n.pendingValue();if(n.question.program.isWeighted&&e<0)return void f.swal("Error de validación","El valor ingresado supera el 100% para el programa seleccionado!","error");var t={},i=JSON.stringify(n.question);return t.data=Base64.encode(i),d({method:"POST",url:"api/configuration/management-question/save",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(t)}).then(function(e){c(function(){n.question=e.data.result,f.swal("Validación exitosa","Información guardada","success"),n.reloadData()})})["catch"](function(n){a.error(n),f.swal("Error de guardado","Error guardando el registro. Por favor verifique los datos ingresados!","error")})["finally"](function(){n.clear()})};w.operation="diagnostic",w.customerId=n.customerId,n.dtInstanceConfigManagementQuestion={},n.dtOptionsConfigManagementQuestion=t.newOptions().withBootstrap().withOption("responsive",!0).withOption("ajax",{data:w,url:"api/configuration/management-question",type:"POST",beforeSend:function(){},complete:function(){}}).withDataProp("data").withOption("order",[[0,"desc"]]).withOption("serverSide",!0).withOption("processing",!0).withOption("fnPreDrawCallback",function(){return!0}).withOption("fnDrawCallback",function(){q()}).withOption("language",{}).withPaginationType("full_numbers").withOption("createdRow",function(e,a,t){r(angular.element(e).contents())(n)}),n.dtColumnsConfigManagementQuestion=[i.newColumn(null).withTitle("Acciones").withOption("width",150).notSortable().renderWith(function(n,e,a,t){var i="",o="",r='<a class="btn btn-primary btn-xs editRow lnk" href="#" uib-tooltip="Editar"  data-id="'+n.id+'"'+o+' >   <i class="fa fa-edit"></i></a> ',l='<a class="btn btn-info btn-xs viewRow lnk" href="#"  uib-tooltip="Ver" data-id="'+n.id+'" >   <i class="fa fa-eye"></i></a> ',s='<a class="btn btn-danger btn-xs delRow lnk" href="#"  uib-tooltip="Eliminar" data-id="'+n.id+'"'+o+' >   <i class="fa fa-trash-o"></i></a> ',c='<a class="btn btn-dark-azure btn-xs configRow lnk" href="#"  uib-tooltip="Configurar" data-id="'+n.id+'"'+o+' >   <i class="fa fa-cogs"></i></a> ';return u.can("clientes_view")&&(i+=l),u.can("clientes_edit")&&(i+=r),u.can("clientes_delete")&&(i+=s),u.can("programa_empresarial_resource_manage")&&(i+=c),i}),i.newColumn("program.name").withTitle("Programa").withOption("width",200).withOption("defaultContent",""),i.newColumn("category.name").withTitle("Categoría").withOption("width",200).withOption("defaultContent",""),i.newColumn("name").withTitle("Pregunta"),i.newColumn("article").withTitle("Artículo").withOption("width",200),i.newColumn("weightedValue").withTitle("Vlr. Pond.").withOption("width",200).withOption("defaultContent",""),i.newColumn("status.item").withTitle("Estado").withOption("width",200).renderWith(function(n,e,a,t){var i="";switch(n){case"Activo":i="label label-success";break;case"Inactivo":i="label label-danger";break;case"Retirado":i="label label-warning"}var o='<span class="'+i+'">'+n+"</span>";return o})],n.viewConfigManagementQuestion=function(e){n.question.id=e,n.isview=!0,n.onLoadRecord()},n.cancelEdition=function(e){null!=n.$parent&&n.$parent.navToSection("summary","summary",n.customerId)};var q=function(){angular.element("#dtConfigManagementQuestion a.editRow").on("click",function(){var e=angular.element(this).data("id");n.editConfigManagementQuestion(e)}),angular.element("#dtConfigManagementQuestion a.viewRow").on("click",function(){var e=angular.element(this).data("id");n.question.id=e,n.viewConfigManagementQuestion(e)}),angular.element("#dtConfigManagementQuestion a.configRow").on("click",function(){var e=angular.element(this).data("id");n.onConfig({id:e})}),angular.element("#dtConfigManagementQuestion a.delRow").on("click",function(){var e=angular.element(this).data("id");p.info("intenta eliminar el registro: "+e),f.swal({title:"Está seguro?",text:"Eliminará el registro seleccionado.",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Si, eliminar!",cancelButtonText:"No, continuar!",closeOnConfirm:!0,closeOnCancel:!0},function(t){if(t){var i={};i.id=e,d({method:"POST",url:"api/configuration/management-question/delete",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(i)}).then(function(n){swal("Eliminado","Registro eliminado satisfactoriamente","info")})["catch"](function(n){a.error(n),f.swal("Error en la eliminación","Se ha presentado un error durante la eliminación del registro. Por favor inténtelo de nuevo, si el error persiste, comuníquese con el administrador del sistema","error")})["finally"](function(){n.reloadData()})}else swal("Cancelación","La operación ha sido cancelada","error")})})};n.reloadData=function(){n.dtInstanceConfigManagementQuestion.reloadData()},n.editConfigManagementQuestion=function(e){n.question.id=e,n.isview=!1,n.onLoadRecord()},n.createConfigManagementQuestion=function(){var t={},i={id:0,customerId:e.customerId,status:{id:0,item:"Iniciado",value:"iniciado"}},o=JSON.stringify(i);t.data=Base64.encode(o),d({method:"POST",url:"api/configuration/management-question/save",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(t)}).then(function(e){null!=n.$parent&&(n.reloadData(),swal("Creado","Pregunta adicionada satisfactoriamente","info"))})["catch"](function(n){a.error(n),f.swal("Error Creando","Se ha presentado un error durante la creación del centro de trabajo por favor intentelo de nuevo","error")})["finally"](function(){})},n.refreshWorkPlace=function(){h()},n.refreshMacro=function(){C()},n.onConfig=function(e){var t=m.open({templateUrl:u.app.views.urlRoot+"modules/configuration/business-programs/configuration_management_question_resource_modal.htm",placement:"right",size:"lg",backdrop:"static",controller:"ModalInstanceSideManagementQuestionResourceCtrl",scope:n,resolve:{dataItem:function(){return e},isView:function(){return n.isView}}});t.result.then(function(){},function(){a.info("Modal dismissed at: "+new Date)})},n.refreshProgram=function(){h()},n.refreshCategory=function(){C()}}]);
"use strict";app.controller("configurationProgramPreventionDocumentListCtrl",["$scope","$stateParams","$log","DTOptionsBuilder","DTColumnBuilder","DTColumnDefBuilder","$compile","toaster","$state","$rootScope","SweetAlert","$http",function(t,n,e,i,o,a,r,l,c,s,d,u){var p=e,m={};t.isAgent="agent"==s.currentUser().wg_type,t.isAdmin="system"==s.currentUser().wg_type,t.isCustomer="customerAdmin"==s.currentUser().wg_type||"customerUser"==s.currentUser().wg_type,t.isAgent?c.go("app.clientes.list"):t.isCustomer&&(p.info("Step 7"),c.go("app.clientes.view",{customerId:s.currentUser().company})),m.operation="quotes",t.dtInstanceProgramPreventionDocument={},t.dtOptionsProgramPreventionDocument=i.newOptions().withBootstrap().withOption("responsive",!0).withOption("ajax",{data:m,url:"api/configuration/program-prevention-document",type:"POST",beforeSend:function(){},complete:function(){}}).withDataProp("data").withOption("order",[[0,"desc"]]).withOption("serverSide",!0).withOption("processing",!0).withOption("fnPreDrawCallback",function(){return!0}).withOption("fnDrawCallback",function(){w()}).withOption("language",{}).withPaginationType("full_numbers").withOption("createdRow",function(n,e,i){r(angular.element(n).contents())(t)}),t.dtColumnsProgramPreventionDocument=[o.newColumn(null).withTitle("Acciones").withOption("width",200).notSortable().renderWith(function(n,e,i,o){var a=null!=n.document?n.document.path:"",r="",l='<a target="_self" class="btn btn-primary btn-xs editRow lnk" href="#" uib-tooltip="Editar" data-id="'+n.id+'">   <i class="fa fa-edit"></i></a> ',c='<a target="_self" class="btn btn-info btn-xs downloadRow lnk" href="#" uib-tooltip="Descargar" data-id="'+n.id+'" data-url="'+a+'" >   <i class="fa fa-download"></i></a> ',s='<a class="btn btn-light-red btn-xs delRow lnk" href="#" uib-tooltip="Eliminar" data-id="'+n.id+'" >   <i class="fa fa-ban"></i></a> ';return r+=c,r+=l,r+=s,t.isAdmin||t.isAgent||t.$parent.isCustomerContractor,r}),o.newColumn("classification").withTitle("Clasificación").withOption("width",200),o.newColumn("name").withTitle("Nombre").withOption("width",200),o.newColumn("description").withTitle("Descripción").withOption("width",200),o.newColumn("startDate").withTitle("Fecha de Inicio Vigencia").withOption("width",200),o.newColumn("endDate").withTitle("Fecha de Finalización Vigencia").withOption("width",200),o.newColumn("version").withTitle("Versión").withOption("width",200),o.newColumn("status").withTitle("Estado").withOption("width",200).renderWith(function(t,n,e,i){var o="";switch(t){case"Vigente":o="label label-success";break;case"Anulado":o="label label-danger"}var a='<span class="'+o+'">'+t+"</span>";return a})];var w=function(){$("#dtProgramPreventionDocument a.editRow").on("click",function(){var t=$(this).data("id");c.go("app.program-prevention-document.edit",{id:t})}),$("#dtProgramPreventionDocument a.downloadRow").on("click",function(){var t=$(this).data("id"),n=$(this).data("url");""==n?l.pop("error","Error en la descarga","No existe un anexo para descargar"):jQuery("#download")[0].src="api/configuration/program-prevention-document/download?id="+t}),$("#dtProgramPreventionDocument a.delRow").on("click",function(){var n=$(this).data("id");p.info("intenta eliminar el registro: "+n),d.swal({title:"Está seguro?",text:"Eliminará el registro seleccionado.",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Si, eliminar!",cancelButtonText:"No, cancelar!",closeOnConfirm:!0,closeOnCancel:!0},function(i){if(i){var o={};o.id=n,u({method:"POST",url:"api/configuration/program-prevention-document/delete",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(o)}).then(function(t){swal("Eliminado","Registro eliminado satisfactoriamente","info")})["catch"](function(t){e.error(t),d.swal("Error en la eliminación","Se ha presentado un error durante la eliminación del registro. Por favor inténtelo de nuevo, si el error persiste, comuníquese con el administrador del sistema","error")})["finally"](function(){t.reloadData()})}else swal("Cancelación","La operación ha sido cancelada","error")})})};t.onCreate=function(){c.go("app.program-prevention-document.create")},t.reloadData=function(){t.dtInstanceProgramPreventionDocument.reloadData()}}]);
"use strict";app.controller("configurationProgramPreventionDocumentEditCtrl",["$scope","$stateParams","$log","DTOptionsBuilder","DTColumnBuilder","DTColumnDefBuilder","$compile","toaster","$state","SweetAlert","$rootScope","$http","$timeout","$uibModal","flowFactory","cfpLoadingBar","$filter","$document","FileUploader","$localStorage","$aside",function(e,n,t,o,a,i,r,l,c,s,u,d,m,p,f,h,g,w,v,D,P){var C=t,O={},S=0;e.loading=!0,e.isView=c.is("app.program-prevention-document.view"),e.isCreate=c.is("app.program-prevention-document.create"),e.format="dd-MM-yyyy",e.minDate=new Date-1,e.classifications=u.parameters("program_prevention_document_classification"),e.documentStatus=u.parameters("customer_document_status");var b=function(){e.attachment={id:n.id?n.id:0,classification:null,name:"",description:"",status:null,version:1,startDate:null,endDate:null,questions:[]}};b();var T=function(){if(e.attachment.id){var n={id:e.attachment.id};d({method:"GET",url:"api/configuration/program-prevention-document",params:n})["catch"](function(e,n){if(403==n){var t=null!==e.message&&void 0!==e.message?e.message:"app.clientes.list";s.swal("No Autorizado","No estas autorizado para ver esta información.","error"),m(function(){c.go(t)},3e3)}else 404==n?(s.swal("Información no disponible","Anexo no encontrado","error"),m(function(){c.go("app.clientes.list")})):s.swal("Error","Se ha presentado un error al intentar acceder a la información del anexo","error")}).then(function(n){m(function(){e.attachment=n.data.result,q()})})["finally"](function(){m(function(){e.loading=!1},400)})}};T(),e.master=e.attachment,e.form={submit:function(n){var t=null;if(n.$invalid){var o=null,t=null;for(o in n)"$"!=o[0]&&(null!==t||n[o].$valid||(t=n[o].$name),n[o].$pristine&&(n[o].$dirty=!0));return angular.element(".ng-invalid[name="+t+"]").focus(),void s.swal("El formulario contiene errores!","Por favor corrige los errores del formulario e Intentalo de nuevo.","error")}0==e.uploader.queue.length,I()},reset:function(n){e.attachment=angular.copy(e.master),n.$setPristine(!0)}};var I=function(){var n={},o=JSON.stringify(e.attachment);return n.data=Base64.encode(o),d({method:"POST",url:"api/configuration/program-prevention-document/save",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(n)}).then(function(n){m(function(){e.attachment=n.data.result,S=n.data.result.id,O.program_prevention_document_id=S,q(),e.uploader.queue.length>0?A.uploadAll():(s.swal("Registro","La información ha sido guardada satisfactoriamente","success"),e.reloadData(),e.reloadDataSelected(),e.clear())})})["catch"](function(e){t.error(e),s.swal("Error de guardado","Error guardando el registro. Por favor verifique los datos ingresados!","error")})["finally"](function(){e.reloadData()})},q=function(){null!=e.attachment.startDate&&""!=e.attachment.startDate&&(e.attachment.startDate=new Date(e.attachment.startDate.date)),null!=e.attachment.endDate&&""!=e.attachment.endDate&&(e.attachment.endDate=new Date(e.attachment.endDate.date))},A=e.uploader=new v({url:"api/configuration/program-prevention-document/upload",formData:[],removeAfterUpload:!0});A.filters.push({name:"customFilter",fn:function(e,n){return this.queue.length<10}}),A.onWhenAddingFileFailed=function(e,n,t){console.info("onWhenAddingFileFailed",e,n,t)},A.onAfterAddingFile=function(e){console.info("onAfterAddingFile",e)},A.onAfterAddingAll=function(e){console.info("onAfterAddingAll",e)},A.onBeforeUploadItem=function(e){console.info("onBeforeUploadItem",e);var n={id:S};e.formData.push(n)},A.onProgressItem=function(e,n){console.info("onProgressItem",e,n)},A.onProgressAll=function(e){console.info("onProgressAll",e)},A.onSuccessItem=function(e,n,t,o){console.info("onSuccessItem",e,n,t,o)},A.onErrorItem=function(e,n,t,o){console.info("onErrorItem",e,n,t,o)},A.onCancelItem=function(e,n,t,o){console.info("onCancelItem",e,n,t,o)},A.onCompleteItem=function(e,n,t,o){console.info("onCompleteItem",e,n,t,o)},A.onCompleteAll=function(){console.info("onCompleteAll"),s.swal("Registro","La información ha sido guardada satisfactoriamente","success"),e.reloadData(),e.reloadDataSelected(),e.onClear()},e.onClear=function(){c.go("app.program-prevention-document.edit",{id:e.attachment.id})},e.onCancel=function(){c.go("app.program-prevention-document.list")},O.operation="management",O.program_prevention_document_id=n.id?n.id:0,e.dtInstanceProgramPreventionDocumentQuestionSelected={},e.dtOptionsProgramPreventionDocumentQuestionSelected=o.newOptions().withBootstrap().withOption("responsive",!0).withOption("ajax",{data:O,url:"api/configuration/program-prevention-document-question/selected",type:"POST",beforeSend:function(){},complete:function(e){m(function(){})}}).withDataProp("data").withOption("order",[[0,"desc"]]).withOption("serverSide",!0).withOption("processing",!0).withOption("fnPreDrawCallback",function(){return!0}).withOption("fnDrawCallback",function(){y()}).withDOM("tr").withOption("language",{}).withOption("createdRow",function(n,t,o){r(angular.element(n).contents())(e)}),e.dtColumnsProgramPreventionDocumentQuestionSelected=[a.newColumn(null).withTitle("").withOption("width",100).notSortable().renderWith(function(n,t,o,a){var i="",r="",l='<a class="btn btn-light-red btn-xs delRow lnk" href="#" uib-tooltip="Remover anexo" data-id="'+n.id+'" >   <i class="fa fa-ban"></i></a> ';'<a class="btn btn-purple btn-xs configureRow lnk" href="#" uib-tooltip="Configurar pregunta"  data-id="'+n.programPreventionQuestionId+'"'+r+' >   <i class="fa fa-gear"></i></a> ';return e.isAdmin,i+=l}),a.newColumn("programPreventionQuestionId").withTitle("ID").withOption("width",200),a.newColumn("program").withTitle("Programa").withOption("width",400),a.newColumn("category").withTitle("Categoría"),a.newColumn("article").withTitle("Artículo"),a.newColumn("question").withTitle("Pregunta"),a.newColumn("guide").withTitle("Guía").withOption("width",200).renderWith(function(e,n,t,o){var a="",i="";null!=e&&""!=e?(i="Tiene",a="label label-success"):(i="No tiene",a="label label-danger");var r='<span class="'+a+'">'+i+"</span>";return r})];var y=function(){$("#dtProgramPreventionDocumentQuestionSelected a.configureRow").on("click",function(){var n=$(this).data("id");e.onEditQuestion(n)}),$("#dtProgramPreventionDocumentQuestionSelected a.delRow").on("click",function(){var n=$(this).data("id");C.info("intenta eliminar el registro: "+n),s.swal({title:"Está seguro?",text:"Eliminará el registro seleccionado.",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Si, eliminar!",cancelButtonText:"No, cancelar!",closeOnConfirm:!0,closeOnCancel:!0},function(o){if(o){var a={};a.id=n,d({method:"POST",url:"api/configuration/program-prevention-document-question/delete",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(a)}).then(function(e){swal("Eliminado","Registro eliminado satisfactoriamente","info")})["catch"](function(e){t.error(e),s.swal("Error en la eliminación","Se ha presentado un error durante la eliminación del registro. Por favor inténtelo de nuevo, si el error persiste, comuníquese con el administrador del sistema","error")})["finally"](function(){e.reloadDataSelected(),e.reloadData()})}else swal("Cancelación","La operación ha sido cancelada","error")})})};e.reloadDataSelected=function(){e.dtInstanceProgramPreventionDocumentQuestionSelected.reloadData()},e.dtInstanceProgramPreventionDocumentQuestion={},e.dtOptionsProgramPreventionDocumentQuestion=o.newOptions().withBootstrap().withOption("responsive",!0).withOption("ajax",{data:O,url:"api/configuration/program-prevention-document-question",type:"POST",beforeSend:function(){},complete:function(e){m(function(){})}}).withDataProp("data").withOption("order",[[0,"desc"]]).withOption("serverSide",!0).withOption("processing",!0).withOption("fnPreDrawCallback",function(){return!0}).withOption("fnDrawCallback",function(){Q()}).withDOM("tr").withOption("language",{}).withOption("createdRow",function(n,t,o){r(angular.element(n).contents())(e)}),e.dtColumnsProgramPreventionDocumentQuestion=[a.newColumn("programPreventionQuestionId").withTitle("ID").withOption("width",150),a.newColumn("program").withTitle("Programa").withOption("width",400),a.newColumn("category").withTitle("Categoría"),a.newColumn("article").withTitle("Artículo"),a.newColumn("question").withTitle("Pregunta"),a.newColumn("guide").withTitle("Guía").withOption("width",200).renderWith(function(e,n,t,o){var a="",i="";null!=e&&""!=e?(i="Tiene",a="label label-success"):(i="No tiene",a="label label-danger");var r='<span class="'+a+'">'+i+"</span>";return r}),a.newColumn(null).withTitle("Acciones").notSortable().renderWith(function(e,n,t,o){var a="",i="1"==e.selected?"checked":"",r='<input bs-switch ng-model="isSelected" type="checkbox" switch-active="true" ng-click="edit('+e.id+')" name="'+e.id+'" ng-true-value="true" ng-false-value="false" switch-on-text="Si" switch-off-text="No"> ',r='<div class="checkbox clip-check check-success "><input class="editRow" type="checkbox" id="chk_'+e.programPreventionQuestionId+'" data-id="'+e.programPreventionQuestionId+'" data-value="'+e.selected+'" '+i+' ><label for="chk_'+e.programPreventionQuestionId+'"> Seleccionar </label></div>';return a+=r}).notSortable()];var Q=function(){$("input[type=checkbox]").on("change",function(){var n=$(this).data("id"),t=($(this).data("value"),$(this).is(":checked"));if(t){var o={programPreventionQuestionId:n};e.attachment.questions.push(o)}else e.attachment.questions=g("filter")(e.attachment.questions,{programPreventionQuestionId:"!"+n});C.info(e.attachment.questions)})};e.reloadData=function(){e.dtInstanceProgramPreventionDocumentQuestion.reloadData()},e.onEditQuestion=function(n){var t={id:n},o=P.open({templateUrl:u.app.views.urlRoot+"modules/configuration/guide/program_prevention_question_modal.htm",placement:"right",size:"lg",backdrop:!0,controller:"ModalInstanceSideProgramPreventionDocumentQuestionCtrl",scope:e,resolve:{question:function(){return t}}});o.result.then(function(){e.reloadData()})}}]),app.controller("ModalInstanceSideProgramPreventionDocumentQuestionCtrl",["$rootScope","$scope","$uibModalInstance","question","$log","$timeout","SweetAlert","$http","toaster","$filter","FileUploader","DTColumnBuilder","DTOptionsBuilder","$compile","$document",function(e,n,t,o,a,i,r,l,c,s,u,d,m,p,f){n.workplaces=[],n.macros=[],n.processes=[],n.question=o,n.onCloseModal=function(){t.close(1)},n.onCancel=function(){t.dismiss("cancel")};var h=function(){if(n.question.id){var e={id:n.question.id};l({method:"GET",url:"api/configuration/program-prevention-question",params:e})["catch"](function(e,n){}).then(function(e){i(function(){n.question=e.data.result})})["finally"](function(){i(function(){n.loading=!1},400)})}};h(),n.onSave=function(){var e={},t=JSON.stringify(n.question);return e.data=Base64.encode(t),l({method:"POST",url:"api/configuration/program-prevention-question/save",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(e)}).then(function(e){i(function(){r.swal("Validación exitosa","Procediendo con el guardado...","success"),n.onCloseModal()})})["catch"](function(e){a.error(e),r.swal("Error de guardado","Error guardando el registro. Por favor verifique los datos ingresados!","error")})["finally"](function(){})}}]);
"use strict";app.controller("configurationMinimumStandardItemCtrl",["$scope","$stateParams","$log","$compile","$rootScope","$timeout",function(t,n,o,a,i,r){var c=o;c.info("loading..configurationMinimumStandardItemCtrl!!! "),t.standard_section="list",t.currentId=0,t.dataSummary=[],t.navToSection=function(n,o,a){r(function(){t.standard_section=n,t.currentId=a})}}]);
"use strict";app.controller("configurationMinimumStandardItemListCtrl",["$scope","$stateParams","$log","DTOptionsBuilder","DTColumnBuilder","DTColumnDefBuilder","$compile","toaster","$state","$rootScope","$timeout","$http","SweetAlert","$aside",function(t,n,i,e,a,o,r,d,l,u,s,c,m,w){var p=i,h={};p.info("loading..configurationMinimumStandardItemItemListCtrl "),t.isNewMinimumStandardItem=!0,h.operation="diagnostic",t.dtInstanceMinimumStandardItem={},t.dtOptionsMinimumStandardItem=e.newOptions().withBootstrap().withOption("responsive",!0).withOption("ajax",{data:h,url:"api/minimum-standard-item",type:"POST",beforeSend:function(){},complete:function(){}}).withDataProp("data").withOption("order",[[0,"desc"]]).withOption("serverSide",!0).withOption("processing",!0).withOption("fnPreDrawCallback",function(){return!0}).withOption("fnDrawCallback",function(){f()}).withOption("language",{}).withPaginationType("full_numbers").withOption("createdRow",function(n,i,e){r(angular.element(n).contents())(t)}),t.dtColumnsMinimumStandardItem=[a.newColumn(null).withTitle("Acciones").withOption("width",180).notSortable().renderWith(function(t,n,i,e){var a="",o="",r='<a class="btn btn-primary btn-xs editRow lnk" href="#" uib-tooltip="Editar"  data-id="'+t.id+'"'+o+' >   <i class="fa fa-play-circle"></i></a> ',d='<a class="btn btn-danger btn-xs delRow lnk" href="#"  uib-tooltip="Eliminar" data-id="'+t.id+'"'+o+' >   <i class="fa fa-trash-o"></i></a> ',l=' | <a class="btn btn-info btn-xs configRow lnk" href="#"  uib-tooltip="Configurar sistema de gestión" data-id="'+t.id+'"'+o+' >   <i class="fa fa-cog"></i></a> ';return u.can("diagnostico_continue"),a+=r,u.can("clientes_delete"),a+=d,a+=l}),a.newColumn("minimumStandard.cycle.name").withTitle("Ciclo").withOption("width",200).withOption("defaultContent",""),a.newColumn("minimumStandard.parent.numeral").withTitle("Numeral (Padre)").withOption("width",200).withOption("defaultContent",""),a.newColumn("minimumStandard.parent.description").withTitle("Estándar (Padre)").withOption("width",200).withOption("defaultContent",""),a.newColumn("minimumStandard.numeral").withTitle("Numeral (Hijo)").withOption("width",200).withOption("defaultContent",""),a.newColumn("minimumStandard.description").withTitle("Estándar (Hijo)").withOption("width",200).withOption("defaultContent",""),a.newColumn("numeral").withTitle("Numeral").withOption("width",200).withOption("defaultContent",""),a.newColumn("description").withTitle("Item").withOption("width",200).withOption("defaultContent",""),a.newColumn("value").withTitle("Valor").withOption("width",200).withOption("defaultContent",""),a.newColumn("isActive").withTitle("Estado").withOption("width",200).renderWith(function(t,n,i,e){var a="",o="";t||1==t?(a="label label-success",o="Activo"):(a="label label-danger",o="Inactivo");var r='<span class="'+a+'">'+o+"</span>";return r})];var f=function(){$("#dtMinimumStandardItem a.editRow").on("click",function(){var n=$(this).data("id");t.editMinimumStandardItem(n)}),$("#dtMinimumStandardItem a.configRow").on("click",function(){var t=$(this).data("id");g(t)}),$("#dtMinimumStandardItem a.delRow").on("click",function(){var n=$(this).data("id");m.swal({title:"Está seguro?",text:"Eliminará el registro seleccionado.",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Si, eliminar!",cancelButtonText:"No, continuar!",closeOnConfirm:!0,closeOnCancel:!0},function(e){if(e){var a={};a.id=n,c({method:"POST",url:"api/minimum-standard-item/delete",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(a)}).then(function(t){swal("Eliminado","Registro eliminado satisfactoriamente","info")})["catch"](function(t){i.error(t),m.swal("Error en la eliminación","Se ha presentado un error durante la eliminación del registro. Por favor inténtelo de nuevo, si el error persiste, comuníquese con el administrador del sistema","error")})["finally"](function(){t.reloadData()})}else swal("Cancelación","La operación ha sido cancelada","error")})})};t.reloadData=function(){t.dtInstanceMinimumStandardItem.reloadData(null,!1)},t.editMinimumStandardItem=function(n){null!=t.$parent&&t.$parent.navToSection("edit","edit",n)},t.onCreate=function(){null!=t.$parent&&t.$parent.navToSection("edit","edit",0)};var g=function(n){var i={id:n?n:0},e=w.open({templateUrl:u.app.views.urlRoot+"modules/configuration/minimum-standard/item/configuration_minimum_standard_associate_modal.htm",placement:"right",size:"lg",backdrop:!0,controller:"ModalInstanceSideMinimumStandardItemAssociationCtrl",scope:t,resolve:{standard:function(){return i}}});e.result.then(function(){t.reloadData()})}}]),app.controller("ModalInstanceSideMinimumStandardItemAssociationCtrl",["$rootScope","$stateParams","$scope","$uibModalInstance","standard","$log","$timeout","SweetAlert","$http","toaster","$filter","$aside","$document","DTColumnBuilder","DTOptionsBuilder","$compile",function(t,n,i,e,a,o,r,d,l,u,s,c,m,w,p,h){var f=o;i.maxDate=new Date,i.datePickerConfig={culture:"es-CO",format:"dd/MM/yyyy HH:mm"},i.loading=!0,i.standard={minimumStandardItemId:a.id,questions:[]},i.master=i.standard,i.form={submit:function(t){var n=null;if(t.$invalid){var i=null,n=null;for(i in t)"$"!=i[0]&&(null!==n||t[i].$valid||(n=t[i].$name),t[i].$pristine&&(t[i].$dirty=!0));return angular.element(".ng-invalid[name="+n+"]").focus(),void d.swal("El formulario contiene errores!","Por favor corrige los errores del formulario e Intentalo de nuevo.","error")}d.swal("Validación exitosa","Procediendo con el guardado...","success"),g()},reset:function(t){i.standard=angular.copy(i.master),t.$setPristine(!0)}};var g=function(){var t={},n=JSON.stringify(i.standard);return t.data=Base64.encode(n),l({method:"POST",url:"api/minimum-standard-item-question/insert",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(t)}).then(function(t){r(function(){i.reloadData(),i.reloadDataSelected()})})["catch"](function(t){o.error(t),d.swal("Error de guardado","Error guardando el registro. Por favor verifique los datos ingresados!","error")})["finally"](function(){})},S={};S.operation="management",S.minimum_standard_item_id=a.id?a.id:0,i.dtInstanceMinimumStandardQuestionSelected={},i.dtOptionsMinimumStandardQuestionSelected=p.newOptions().withBootstrap().withOption("responsive",!0).withOption("ajax",{data:S,url:"api/minimum-standard-item-question",type:"POST",beforeSend:function(){},complete:function(t){r(function(){})}}).withDataProp("data").withOption("order",[[0,"desc"]]).withOption("serverSide",!0).withOption("processing",!0).withOption("fnPreDrawCallback",function(){return!0}).withOption("fnDrawCallback",function(){O()}).withDOM("tr").withOption("language",{}).withOption("createdRow",function(t,n,e){h(angular.element(t).contents())(i)}),i.dtColumnsMinimumStandardQuestionSelected=[w.newColumn(null).withTitle("").withOption("width",100).notSortable().renderWith(function(t,n,e,a){var o="",r='<a class="btn btn-light-red btn-xs delRow lnk" href="#" uib-tooltip="Quitar item" data-id="'+t.id+'" >   <i class="fa fa-ban"></i></a> ';return i.isAdmin,o+=r}),w.newColumn("programPreventionQuestionId").withTitle("ID").withOption("width",200),w.newColumn("program").withTitle("Programa").withOption("width",400),w.newColumn("category").withTitle("Categoría"),w.newColumn("article").withTitle("Artículo"),w.newColumn("question").withTitle("Pregunta"),w.newColumn("guide").withTitle("Guía").withOption("width",200).renderWith(function(t,n,i,e){var a="",o="";null!=t&&""!=t?(o="Tiene",a="label label-success"):(o="No tiene",a="label label-danger");var r='<span class="'+a+'">'+o+"</span>";return r})];var O=function(){$("#dtMinimumStandardQuestionSelected a.configureRow").on("click",function(){var t=$(this).data("id");i.onEditQuestion(t)}),$("#dtMinimumStandardQuestionSelected a.delRow").on("click",function(){var t=$(this).data("id");f.info("intenta eliminar el registro: "+t),d.swal({title:"Está seguro?",text:"Eliminará el registro seleccionado.",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Si, eliminar!",cancelButtonText:"No, cancelar!",closeOnConfirm:!0,closeOnCancel:!0},function(n){if(n){var e={};e.id=t,l({method:"POST",url:"api/minimum-standard-item-question/delete",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(e)}).then(function(t){swal("Eliminado","Registro eliminado satisfactoriamente","info")})["catch"](function(t){o.error(t),d.swal("Error en la eliminación","Se ha presentado un error durante la eliminación del registro. Por favor inténtelo de nuevo, si el error persiste, comuníquese con el administrador del sistema","error")})["finally"](function(){i.reloadDataSelected(),i.reloadData()})}else swal("Cancelación","La operación ha sido cancelada","error")})})};i.dtInstanceMinimumStandardQuestionSelectedCallback=function(t){i.dtInstanceMinimumStandardQuestionSelected=t},i.reloadDataSelected=function(){i.dtInstanceMinimumStandardQuestionSelected.reloadData()},i.dtInstanceMinimumStandardQuestion={},i.dtOptionsMinimumStandardQuestion=p.newOptions().withBootstrap().withOption("responsive",!0).withOption("ajax",{data:S,url:"api/minimum-standard-item-question-available",type:"POST",beforeSend:function(){},complete:function(t){r(function(){})}}).withDataProp("data").withOption("order",[[0,"desc"]]).withOption("serverSide",!0).withOption("processing",!0).withOption("fnPreDrawCallback",function(){return!0}).withOption("fnDrawCallback",function(){v()}).withDOM("tr").withOption("language",{}).withOption("createdRow",function(t,n,e){h(angular.element(t).contents())(i)}),i.dtColumnsMinimumStandardQuestion=[w.newColumn("programPreventionQuestionId").withTitle("ID").withOption("width",150),w.newColumn("program").withTitle("Programa").withOption("width",400),w.newColumn("category").withTitle("Categoría"),w.newColumn("article").withTitle("Artículo"),w.newColumn("question").withTitle("Pregunta"),w.newColumn("guide").withTitle("Guía").withOption("width",200).renderWith(function(t,n,i,e){var a="",o="";null!=t&&""!=t?(o="Tiene",a="label label-success"):(o="No tiene",a="label label-danger");var r='<span class="'+a+'">'+o+"</span>";return r}),w.newColumn(null).withTitle("Acciones").notSortable().renderWith(function(t,n,i,e){var a="",o="1"==t.selected?"checked":"",r='<input bs-switch ng-model="isSelected" type="checkbox" switch-active="true" ng-click="edit('+t.id+')" name="'+t.id+'" ng-true-value="true" ng-false-value="false" switch-on-text="Si" switch-off-text="No"> ',r='<div class="checkbox clip-check check-success "><input class="editRow" type="checkbox" id="chk_'+t.programPreventionQuestionId+'" data-id="'+t.programPreventionQuestionId+'" data-value="'+t.selected+'" '+o+' ><label for="chk_'+t.programPreventionQuestionId+'"> Seleccionar </label></div>';return a+=r}).notSortable()];var v=function(){$("input[type=checkbox]").on("change",function(){var t=$(this).data("id"),n=($(this).data("value"),$(this).is(":checked"));if(n){var e={programPreventionQuestionId:t};i.standard.questions.push(e)}else i.standard.questions=s("filter")(i.standard.questions,{programPreventionQuestionId:"!"+t});f.info(i.standard.questions)})};i.dtInstanceMinimumStandardQuestionCallback=function(t){i.dtInstanceMinimumStandardQuestion=t},i.reloadData=function(){i.dtInstanceMinimumStandardQuestion.reloadData()}}]);
"use strict";app.controller("configurationMinimumStandardItemEditCtrl",["$scope","$stateParams","$log","DTOptionsBuilder","DTColumnBuilder","DTColumnDefBuilder","$compile","toaster","$state","SweetAlert","$rootScope","$http","$timeout","$uibModal","flowFactory","cfpLoadingBar","$filter","$document","FileUploader","$localStorage","$aside",function(a,n,e,r,t,i,o,d,l,s,c,u,m,f,p,g,v,w,h,L,S){a.loading=!0,a.isCreate=0==a.$parent.currentId,a.parentList=[],a.standardList=[],a.standardListAll=[];var C=function(){var n={};return u({method:"POST",url:"api/minimum-standard/list-data",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(n)}).then(function(n){m(function(){a.parentList=n.data.data.parent,a.standardListAll=n.data.data.standard,T()})})["catch"](function(a){s.swal("Error de guardado","Error guardando el registro. Por favor verifique los datos ingresados!","error")})["finally"](function(){})};C();var y=function(){a.standard={id:a.$parent.currentId?a.$parent.currentId:0,minimumStandard:null,minimumStandardParent:null,numeral:"",description:"",value:0,criterion:"",isActive:!0,legalFrameworkList:[],verificationModeList:[]}};y(),a.onSelectParent=function(){T(),a.standard.minimumStandard=null};var T=function(){null!=a.standard.minimumStandardParent&&(a.standardList=v("filter")(a.standardListAll,{parentId:a.standard.minimumStandardParent.id}))},P=function(){if(a.standard.id){var n={id:a.standard.id};u({method:"GET",url:"api/minimum-standard-item",params:n})["catch"](function(a,n){if(403==n){var e=null!==a.message&&void 0!==a.message?a.message:"app.clientes.list";s.swal("No Autorizado","No estas autorizado para ver esta información.","error"),m(function(){l.go(e)},3e3)}else 404==n?(s.swal("Información no disponible","Anexo no encontrado","error"),m(function(){l.go("app.clientes.list")})):s.swal("Error","Se ha presentado un error al intentar acceder al registro","error")}).then(function(n){m(function(){a.standard=n.data.result,T()})})["finally"](function(){m(function(){a.loading=!1},400)})}};P(),a.master=a.standard,a.form={submit:function(a){var n=null;if(a.$invalid){var e=null,n=null;for(e in a)"$"!=e[0]&&(null!==n||a[e].$valid||(n=a[e].$name),a[e].$pristine&&(a[e].$dirty=!0));return angular.element(".ng-invalid[name="+n+"]").focus(),void s.swal("El formulario contiene errores!","Por favor corrige los errores del formulario e Intentalo de nuevo.","error")}s.swal("Validación exitosa","Procediendo con el guardado...","success"),B()},reset:function(n){a.standard=angular.copy(a.master),n.$setPristine(!0)}};var B=function(){var n={},r=JSON.stringify(a.standard);return n.data=Base64.encode(r),u({method:"POST",url:"api/minimum-standard-item/save",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(n)}).then(function(n){m(function(){a.standard=n.data.result})})["catch"](function(a){e.error(a),s.swal("Error de guardado","Error guardando el registro. Por favor verifique los datos ingresados!","error")})["finally"](function(){a.reloadData()})};a.onCancel=function(){null!=a.$parent&&a.$parent.navToSection("list","list",0)},a.onAddLegalFramework=function(){m(function(){null==a.standard.legalFrameworkList&&(a.standard.legalFrameworkList=[]),a.standard.legalFrameworkList.push({id:0,minimumStandardItemId:0,type:"legal-framework",description:""})})},a.onRemoveLegalFramework=function(n){s.swal({title:"Está seguro?",text:"Confirma que desea elimintar el registro seleccionado?",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Si, eliminar!",cancelButtonText:"No, cancelar!",closeOnConfirm:!0,closeOnCancel:!0},function(r){r?m(function(){var r=a.standard.legalFrameworkList[n];if(a.standard.legalFrameworkList.splice(n,1),0!=r.id){var t={};t.id=r.id,u({method:"POST",url:"api/minimum-standard-item-detail/delete",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(t)}).then(function(a){swal("Eliminado","Registro eliminado satisfactoriamente","info")})["catch"](function(a){e.error(a),s.swal("Error en la eliminación","Se ha presentado un error durante la eliminación del registro. Por favor inténtelo de nuevo, si el error persiste, comuníquese con el administrador del sistema","error")})["finally"](function(){})}}):swal("Cancelación","La operación ha sido cancelada","error")})},a.onAddVerificationMode=function(){m(function(){null==a.standard.verificationModeList&&(a.standard.verificationModeList=[]),a.standard.verificationModeList.push({id:0,minimumStandardItemId:0,type:"verification-mode",description:""})})},a.onRemoveVerificationMode=function(n){s.swal({title:"Está seguro?",text:"Confirma que desea elimintar el registro seleccionado?",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Si, eliminar!",cancelButtonText:"No, cancelar!",closeOnConfirm:!0,closeOnCancel:!0},function(r){r?m(function(){var r=a.standard.verificationModeList[n];if(a.standard.verificationModeList.splice(n,1),0!=r.id){var t={};t.id=r.id,u({method:"POST",url:"api/minimum-standard-item-detail/delete",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(t)}).then(function(a){swal("Eliminado","Registro eliminado satisfactoriamente","info")})["catch"](function(a){e.error(a),s.swal("Error en la eliminación","Se ha presentado un error durante la eliminación del registro. Por favor inténtelo de nuevo, si el error persiste, comuníquese con el administrador del sistema","error")})["finally"](function(){})}}):swal("Cancelación","La operación ha sido cancelada","error")})}}]);
"use strict";app.controller("configurationMinimumStandardCtrl",["$scope","$stateParams","$log","$compile","$rootScope","$timeout",function(t,n,o,a,r,i){var c=o;c.info("loading..customerMinimumStandardCtrl!!! "),t.standard_section="list",t.currentId=0,t.dataSummary=[],t.navToSection=function(n,o,a){i(function(){t.standard_section=n,t.currentId=a})}}]);
"use strict";app.controller("configurationMinimumStandardListCtrl",["$scope","$stateParams","$log","DTOptionsBuilder","DTColumnBuilder","DTColumnDefBuilder","$compile","toaster","$state","$rootScope","$timeout","$http","SweetAlert","$aside",function(n,t,a,i,e,r,o,l,d,s,c,u,m,p){var f=a,w={};f.info("loading..configurationMinimumStandardListCtrl "),n.isNewMinimumStandard=!0,w.operation="diagnostic",n.dtInstanceMinimumStandard={},n.dtOptionsMinimumStandard=i.newOptions().withBootstrap().withOption("responsive",!0).withOption("ajax",{data:w,url:"api/minimum-standard",type:"POST",beforeSend:function(){},complete:function(){}}).withDataProp("data").withOption("order",[[0,"desc"]]).withOption("serverSide",!0).withOption("processing",!0).withOption("fnPreDrawCallback",function(){return!0}).withOption("fnDrawCallback",function(){h()}).withOption("language",{}).withPaginationType("full_numbers").withOption("createdRow",function(t,a,i){o(angular.element(t).contents())(n)}),n.dtColumnsMinimumStandard=[e.newColumn(null).withTitle("Acciones").withOption("width",150).notSortable().renderWith(function(n,t,a,i){var e="",r="",o='<a class="btn btn-primary btn-xs editRow lnk" href="#" uib-tooltip="Editar"  data-id="'+n.id+'"'+r+' >   <i class="fa fa-play-circle"></i></a> ',l='<a class="btn btn-danger btn-xs delRow lnk" href="#"  uib-tooltip="Eliminar" data-id="'+n.id+'"'+r+' >   <i class="fa fa-trash-o"></i></a> ';return s.can("diagnostico_continue"),e+=o,s.can("clientes_delete"),e+=l}),e.newColumn("cycle.name").withTitle("Ciclo").withOption("width",200).withOption("defaultContent",""),e.newColumn("parent.numeral").withTitle("Numeral (Padre)").withOption("width",200).withOption("defaultContent",""),e.newColumn("numeral").withTitle("Numeral (Hijo)").withOption("width",200).withOption("defaultContent",""),e.newColumn("description").withTitle("Estándar").withOption("width",200).withOption("defaultContent",""),e.newColumn("type.item").withTitle("Tipo").withOption("width",200).withOption("defaultContent",""),e.newColumn("isActive").withTitle("Estado").withOption("width",200).renderWith(function(n,t,a,i){var e="",r="";n||1==n?(e="label label-success",r="Activo"):(e="label label-danger",r="Inactivo");var o='<span class="'+e+'">'+r+"</span>";return o})];var h=function(){$("#dtMinimumStandard a.editRow").on("click",function(){var t=$(this).data("id");n.editMinimumStandard(t)}),$("#dtMinimumStandard a.delRow").on("click",function(){var t=$(this).data("id");m.swal({title:"Está seguro?",text:"Eliminará el registro seleccionado.",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Si, eliminar!",cancelButtonText:"No, continuar!",closeOnConfirm:!0,closeOnCancel:!0},function(i){if(i){var e={};e.id=t,u({method:"POST",url:"api/minimum-standard/delete",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(e)}).then(function(n){swal("Eliminado","Registro eliminado satisfactoriamente","info")})["catch"](function(n,t){a.error(n),500==t?m.swal("Error en la eliminación",n.message,"error"):m.swal("Error en la eliminación","Se ha presentado un error durante la eliminación del registro. Por favor inténtelo de nuevo, si el error persiste, comuníquese con el administrador del sistema","error")})["finally"](function(){n.reloadData()})}else swal("Cancelación","La operación ha sido cancelada","error")})})};n.reloadData=function(){n.dtInstanceMinimumStandard.reloadData(null,!1)},n.editMinimumStandard=function(n){g(n)},n.onCreate=function(){g()};var g=function(t){var a={id:t?t:0},i=p.open({templateUrl:s.app.views.urlRoot+"modules/configuration/minimum-standard/standard/configuration_minimum_standard_modal.htm",placement:"right",size:"lg",backdrop:!0,controller:"ModalInstanceSideMinimumStandardEditCtrl",scope:n,resolve:{standard:function(){return a}}});i.result.then(function(){n.reloadData()})}}]),app.controller("ModalInstanceSideMinimumStandardEditCtrl",["$rootScope","$stateParams","$scope","$uibModalInstance","standard","$log","$timeout","SweetAlert","$http","toaster","$filter","$aside","$document","DTColumnBuilder","DTOptionsBuilder","$compile",function(n,t,a,i,e,r,o,l,d,s,c,u,m,p,f,w){var h=r;a.maxDate=new Date,a.datePickerConfig={culture:"es-CO",format:"dd/MM/yyyy HH:mm"},a.loading=!0,a.standard={},a.typeList=n.parameters("minimum_standard_type"),a.cycleList=[],a.parentList=[],a.parentListAll=[];var g=function(){var n={};return d({method:"POST",url:"api/minimum-standard/list-data",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(n)}).then(function(n){o(function(){a.cycleList=n.data.data.cycle,a.parentListAll=n.data.data.parent})})["catch"](function(n){l.swal("Error de guardado","Error guardando el registro. Por favor verifique los datos ingresados!","error")})["finally"](function(){})};g(),a.onCloseModal=function(){i.close(1)},a.onCancel=function(){i.dismiss("cancel")},a.onLoadRecord=function(){if(0!=a.standard.id){var n={id:a.standard.id};d({method:"GET",url:"api/minimum-standard",params:n})["catch"](function(n,t){if(403==t){var a=null!==n.message&&void 0!==n.message?n.message:"app.clientes.list";l.swal("No Autorizado","No estas autorizado para ver esta información.","error"),o(function(){$state.go(a)},3e3)}else 404==t?l.swal("Información no disponible","Centro de trabajo no encontrado","error"):l.swal("Error","Se ha presentado un error al intentar acceder a la información del centro de trabajo","error")}).then(function(n){o(function(){a.standard=n.data.result},400)})["finally"](function(){o(function(){a.loading=!1},400),o(function(){m.scrollTop(40,2e3)})})}else a.loading=!1};var v=function(){a.standard={id:e.id,type:null,cycle:null,parent:null,numeral:"",description:"",isActive:!0}};v(),a.onLoadRecord(),a.$watch("standard.cycle",function(n,t,i){a.parentList=[],null==t||angular.equals(n,t)||(a.standard.parent=null),null!=a.standard.cycle&&(a.parentList=c("filter")(a.parentListAll,{cycleId:a.standard.cycle.id}))}),a.master=a.standard,a.form={submit:function(n){var t=null;if(n.$invalid){var i=null,t=null;for(i in n)"$"!=i[0]&&(null!==t||n[i].$valid||(t=n[i].$name),n[i].$pristine&&(n[i].$dirty=!0));return h.info(a.standard),angular.element(".ng-invalid[name="+t+"]").focus(),void l.swal("El formulario contiene errores!","Por favor corrige los errores del formulario e Intentalo de nuevo.","error")}l.swal("Validación exitosa","Guardando información del centro de trabajo...","success"),C()},reset:function(n){a.clear()}};var C=function(){var n=JSON.stringify(a.standard),t={data:Base64.encode(n)};return d({method:"POST",url:"api/minimum-standard/save",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(t)}).then(function(n){o(function(){a.onCloseModal()})})["catch"](function(n){l.swal("Error de guardado","Error guardando el registro. Por favor verifique los datos ingresados!","error")})["finally"](function(){})}}]);
"use strict";app.controller("configurationMinimumStandardItem0312Ctrl",["$scope","$stateParams","$log","$compile","$rootScope","$timeout",function(t,n,o,a,i,r){var c=o;c.info("loading..configurationMinimumStandardItemCtrl!!! "),t.standard_section="list",t.currentId=0,t.dataSummary=[],t.navToSection=function(n,o,a){r(function(){t.standard_section=n,t.currentId=a})}}]);
"use strict";app.controller("configurationMinimumStandardItemList0312Ctrl",["$scope","$stateParams","$log","DTOptionsBuilder","DTColumnBuilder","DTColumnDefBuilder","$compile","toaster","$state","$rootScope","$timeout","$http","SweetAlert","$aside",function(t,n,i,e,a,o,r,l,d,u,s,c,m,w){t.isNewMinimumStandardItem=!0,t.dtInstanceMinimumStandardItem0312={},t.dtOptionsMinimumStandardItem0312=e.newOptions().withBootstrap().withOption("responsive",!0).withOption("ajax",{data:function(t){return JSON.stringify(t)},url:"api/minimum-standard-item-0312",contentType:"application/json",type:"POST",beforeSend:function(){},complete:function(){}}).withDataProp("data").withOption("order",[[0,"desc"]]).withOption("serverSide",!0).withOption("processing",!0).withOption("fnPreDrawCallback",function(){return!0}).withOption("fnDrawCallback",function(){p()}).withOption("language",{}).withPaginationType("full_numbers").withOption("createdRow",function(n,i,e){r(angular.element(n).contents())(t)}),t.dtColumnsMinimumStandardItem0312=[a.newColumn(null).withTitle("Acciones").withOption("width",180).notSortable().renderWith(function(t,n,i,e){var a="",o="",r='<a class="btn btn-primary btn-xs editRow lnk" href="#" uib-tooltip="Editar"  data-id="'+t.id+'"'+o+' >   <i class="fa fa-play-circle"></i></a> ',l='<a class="btn btn-danger btn-xs delRow lnk" href="#"  uib-tooltip="Eliminar" data-id="'+t.id+'"'+o+' >   <i class="fa fa-trash-o"></i></a> ',d=' | <a class="btn btn-info btn-xs configRow lnk" href="#"  uib-tooltip="Configurar item" data-id="'+t.id+'"'+o+' >   <i class="fa fa-cog"></i></a> ';return a+=r,a+=l,a+=d}),a.newColumn("cycle").withTitle("Ciclo").withOption("width",200).withOption("defaultContent",""),a.newColumn("parentNumeral").withTitle("Numeral (Padre)").withOption("width",200).withOption("defaultContent",""),a.newColumn("parentDescription").withTitle("Estándar (Padre)").withOption("width",200).withOption("defaultContent",""),a.newColumn("standardNumeral").withTitle("Numeral (Hijo)").withOption("width",200).withOption("defaultContent",""),a.newColumn("standardDescription").withTitle("Estándar (Hijo)").withOption("width",200).withOption("defaultContent",""),a.newColumn("numeral").withTitle("Numeral").withOption("width",200).withOption("defaultContent",""),a.newColumn("description").withTitle("Item").withOption("width",200).withOption("defaultContent",""),a.newColumn("value").withTitle("Valor").withOption("width",200).withOption("defaultContent",""),a.newColumn(null).withTitle("Activo").withOption("width",200).renderWith(function(t,n,i,e){var a="",o=t.status;return a=t||1==t.isActive?"label label-success":"label label-danger",'<span class="'+a+'">'+o+"</span>"})];var p=function(){$("#dtMinimumStandardItem0312 a.editRow").on("click",function(){var n=$(this).data("id");t.editMinimumStandardItem(n)}),$("#dtMinimumStandardItem0312 a.configRow").on("click",function(){var t=$(this).data("id");h(t)}),$("#dtMinimumStandardItem0312 a.delRow").on("click",function(){var n=$(this).data("id");m.swal({title:"Está seguro?",text:"Eliminará el registro seleccionado.",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Si, eliminar!",cancelButtonText:"No, continuar!",closeOnConfirm:!0,closeOnCancel:!0},function(e){if(e){var a={};a.id=n,c({method:"POST",url:"api/minimum-standard-item/delete",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(a)}).then(function(t){swal("Eliminado","Registro eliminado satisfactoriamente","info")})["catch"](function(t){i.error(t),m.swal("Error en la eliminación","Se ha presentado un error durante la eliminación del registro. Por favor inténtelo de nuevo, si el error persiste, comuníquese con el administrador del sistema","error")})["finally"](function(){t.reloadData()})}else swal("Cancelación","La operación ha sido cancelada","error")})})};t.dtInstanceMinimumStandardItem0312Callback=function(n){t.dtInstanceMinimumStandardItem0312=n},t.reloadData=function(){t.dtInstanceMinimumStandardItem0312.reloadData(null,!1)},t.editMinimumStandardItem=function(n){null!=t.$parent&&t.$parent.navToSection("edit","edit",n)},t.onCreate=function(){null!=t.$parent&&t.$parent.navToSection("edit","edit",0)};var h=function(n){var i={id:n?n:0},e=w.open({templateUrl:u.app.views.urlRoot+"modules/configuration/minimum-standard-0312/item/configuration_minimum_standard_associate_modal.htm",placement:"right",size:"lg",backdrop:!0,controller:"ModalInstanceSideMinimumStandardItemAssociation0312Ctrl",scope:t,resolve:{standard:function(){return i}}});e.result.then(function(){t.reloadData()},function(){})}}]),app.controller("ModalInstanceSideMinimumStandardItemAssociation0312Ctrl",["$rootScope","$stateParams","$scope","$uibModalInstance","standard","$log","$timeout","SweetAlert","$http","toaster","$filter","$aside","$document","DTColumnBuilder","DTOptionsBuilder","$compile",function(t,n,i,e,a,o,r,l,d,u,s,c,m,w,p,h){var f=o;i.maxDate=new Date,i.datePickerConfig={culture:"es-CO",format:"dd/MM/yyyy HH:mm"},i.loading=!0,i.standard={minimumStandardItemId:a.id,questions:[]},i.form={submit:function(t){var n=null;if(t.$invalid){var i=null,n=null;for(i in t)"$"!=i[0]&&(null!==n||t[i].$valid||(n=t[i].$name),t[i].$pristine&&(t[i].$dirty=!0));return angular.element(".ng-invalid[name="+n+"]").focus(),void l.swal("El formulario contiene errores!","Por favor corrige los errores del formulario e Intentalo de nuevo.","error")}g()},reset:function(t){t.$setPristine(!0)}};var g=function(){var t={},n=JSON.stringify(i.standard);return t.data=Base64.encode(n),d({method:"POST",url:"api/minimum-standard-item-question-0312/batch",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(t)}).then(function(t){l.swal("Registro","La información ha sido guardada satisfactoriamente","success"),r(function(){i.reloadData(),i.reloadDataSelected()})})["catch"](function(t){o.error(t),l.swal("Error de guardado","Error guardando el registro. Por favor verifique los datos ingresados!","error")})["finally"](function(){})};i.dtInstanceMinimumStandardQuestionSelected={},i.dtOptionsMinimumStandardQuestionSelected=p.newOptions().withBootstrap().withOption("responsive",!0).withOption("ajax",{data:function(t){return t.minimumStandardItemId=a.id?a.id:0,JSON.stringify(t)},url:"api/minimum-standard-item-question-0312",contentType:"application/json",type:"POST",beforeSend:function(){},complete:function(t){r(function(){})}}).withDataProp("data").withOption("order",[[0,"desc"]]).withOption("serverSide",!0).withOption("processing",!0).withOption("fnPreDrawCallback",function(){return!0}).withOption("fnDrawCallback",function(){O()}).withDOM("tr").withOption("language",{}).withOption("paging",!1).withOption("createdRow",function(t,n,e){h(angular.element(t).contents())(i)}),i.dtColumnsMinimumStandardQuestionSelected=[w.newColumn(null).withTitle("").withOption("width",100).notSortable().renderWith(function(t,n,i,e){var a="",o='<a class="btn btn-light-red btn-xs delRow lnk" href="#" uib-tooltip="Quitar item" data-id="'+t.id+'" >   <i class="fa fa-ban"></i></a> ';return a+=o}),w.newColumn("programPreventionQuestionId").withTitle("ID").withOption("width",200),w.newColumn("program").withTitle("Programa").withOption("width",400),w.newColumn("category").withTitle("Categoría"),w.newColumn("article").withTitle("Artículo"),w.newColumn("question").withTitle("Pregunta"),w.newColumn("guide").withTitle("Guía").withOption("width",200).renderWith(function(t,n,i,e){var a="",o="";null!=t&&"Tiene"==t?(o="Tiene",a="label label-success"):(o="No tiene",a="label label-danger");var r='<span class="'+a+'">'+o+"</span>";return r})];var O=function(){$("#dtMinimumStandardQuestionSelected a.configureRow").on("click",function(){var t=$(this).data("id");i.onEditQuestion(t)}),$("#dtMinimumStandardQuestionSelected a.delRow").on("click",function(){var t=$(this).data("id");f.info("intenta eliminar el registro: "+t),l.swal({title:"Está seguro?",text:"Eliminará el registro seleccionado.",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Si, eliminar!",cancelButtonText:"No, cancelar!",closeOnConfirm:!0,closeOnCancel:!0},function(n){if(n){var e={};e.id=t,d({method:"POST",url:"api/minimum-standard-item-question/delete",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(e)}).then(function(t){swal("Eliminado","Registro eliminado satisfactoriamente","info")})["catch"](function(t){o.error(t),l.swal("Error en la eliminación","Se ha presentado un error durante la eliminación del registro. Por favor inténtelo de nuevo, si el error persiste, comuníquese con el administrador del sistema","error")})["finally"](function(){i.reloadDataSelected(),i.reloadData()})}else swal("Cancelación","La operación ha sido cancelada","error")})})};i.dtInstanceMinimumStandardQuestionSelectedCallback=function(t){i.dtInstanceMinimumStandardQuestionSelected=t},i.reloadDataSelected=function(){i.dtInstanceMinimumStandardQuestionSelected.reloadData()},i.dtInstanceMinimumStandardQuestion={},i.dtOptionsMinimumStandardQuestion=p.newOptions().withBootstrap().withOption("responsive",!0).withOption("ajax",{data:function(t){return t.minimumStandardItemId=a.id?a.id:0,JSON.stringify(t)},url:"api/minimum-standard-item-question-0312-available",contentType:"application/json",type:"POST",beforeSend:function(){},complete:function(t){r(function(){})}}).withDataProp("data").withOption("order",[[0,"desc"]]).withOption("serverSide",!0).withOption("processing",!0).withOption("fnPreDrawCallback",function(){return!0}).withOption("fnDrawCallback",function(){S()}).withDOM("tr").withOption("language",{}).withOption("paging",!1).withOption("createdRow",function(t,n,e){h(angular.element(t).contents())(i)}),i.dtColumnsMinimumStandardQuestion=[w.newColumn("programPreventionQuestionId").withTitle("ID").withOption("width",150),w.newColumn("program").withTitle("Programa").withOption("width",400),w.newColumn("category").withTitle("Categoría"),w.newColumn("article").withTitle("Artículo"),w.newColumn("question").withTitle("Pregunta"),w.newColumn("guide").withTitle("Guía").withOption("width",200).renderWith(function(t,n,i,e){var a="",o="";null!=t&&"Tiene"==t?(o="Tiene",a="label label-success"):(o="No tiene",a="label label-danger");var r='<span class="'+a+'">'+o+"</span>";return r}),w.newColumn(null).withTitle("Acciones").notSortable().renderWith(function(t,n,i,e){var a="",o="1"==t.selected?"checked":"",r='<input bs-switch ng-model="isSelected" type="checkbox" switch-active="true" ng-click="edit('+t.id+')" name="'+t.id+'" ng-true-value="true" ng-false-value="false" switch-on-text="Si" switch-off-text="No"> ',r='<div class="checkbox clip-check check-success "><input class="editRow" type="checkbox" id="chk_'+t.programPreventionQuestionId+'" data-id="'+t.programPreventionQuestionId+'" data-value="'+t.selected+'" '+o+' ><label for="chk_'+t.programPreventionQuestionId+'"> Seleccionar </label></div>';return a+=r}).notSortable()];var S=function(){$("input[type=checkbox]").on("change",function(){var t=$(this).data("id"),n=($(this).data("value"),$(this).is(":checked"));if(n){var e={programPreventionQuestionId:t};i.standard.questions.push(e)}else i.standard.questions=s("filter")(i.standard.questions,{programPreventionQuestionId:"!"+t})})};i.dtInstanceMinimumStandardQuestionCallback=function(t){i.dtInstanceMinimumStandardQuestion=t},i.reloadData=function(){i.dtInstanceMinimumStandardQuestion.reloadData()}}]);
"use strict";app.controller("configurationMinimumStandardItemEdit0312Ctrl",["$scope","$stateParams","$log","DTOptionsBuilder","DTColumnBuilder","DTColumnDefBuilder","$compile","toaster","$state","SweetAlert","$rootScope","$http","$timeout","$uibModal","flowFactory","cfpLoadingBar","$filter","$document","FileUploader","$localStorage","$aside","ListService",function(a,n,t,e,r,i,o,d,l,s,u,m,c,f,p,g,v,w,h,L,S,C){function P(){var n=[{name:"minimum-standard-parent-0312",value:null},{name:"minimum-standard-0312",value:null}];C.getDataList(n).then(function(n){a.parentList=n.data.data.minimum_standard_parent_0312,a.standardListAll=n.data.data.minimum_standard_0312,B()},function(n){a.status="Unable to load customer data: "+n.message})}var T=null;a.isCreate=0==a.$parent.currentId,a.parentList=[],a.standardList=[],a.standardListAll=[],P();var y=function(){a.standard={id:a.$parent.currentId?a.$parent.currentId:0,minimumStandard:null,minimumStandardParent:null,numeral:"",description:"",value:0,criterion:"",isActive:!0,legalFrameworkList:[]},null!=T&&T.$setPristine(!0)};y(),a.onSelectParent=function(){B(),a.standard.minimumStandard=null};var B=function(){null!=a.standard.minimumStandardParent&&(a.standardList=v("filter")(a.standardListAll,{parentId:a.standard.minimumStandardParent.id},!0))},F=function(){if(a.standard.id){var n={id:a.standard.id};m({method:"GET",url:"api/minimum-standard-item-0312/get",params:n})["catch"](function(a,n){}).then(function(n){c(function(){a.standard=n.data.result,B(),E()})})["finally"](function(){})}};F(),a.form={submit:function(a){T=a;var n=null;if(a.$invalid){var t=null,n=null;for(t in a)"$"!=t[0]&&(null!==n||a[t].$valid||(n=a[t].$name),a[t].$pristine&&(a[t].$dirty=!0));return angular.element(".ng-invalid[name="+n+"]").focus(),void s.swal("El formulario contiene errores!","Por favor corrige los errores del formulario e Intentalo de nuevo.","error")}k()},reset:function(a){a.$setPristine(!0)}};var k=function(){var n={},t=JSON.stringify(a.standard);return n.data=Base64.encode(t),m({method:"POST",url:"api/minimum-standard-item-0312/save",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(n)}).then(function(n){s.swal("Registro","La información ha sido guardada satisfactoriamente","success"),c(function(){a.standard=n.data.result,E()})})["catch"](function(a){s.swal("Error de guardado","Error guardando el registro. Por favor verifique los datos ingresados!","error")})["finally"](function(){})},E=function(){u.$emit("onMinimumStandardChanged",{newValue:a.standard.id,message:"Minimum standard 0312 has changed"})};a.onCancel=function(){null!=a.$parent&&a.$parent.navToSection("list","list",0)},a.onAddLegalFramework=function(){c(function(){null==a.standard.legalFrameworkList&&(a.standard.legalFrameworkList=[]),a.standard.legalFrameworkList.push({id:0,minimumStandardItemId:0,type:"legal-framework",description:""})})},a.onRemoveLegalFramework=function(n){s.swal({title:"Está seguro?",text:"Confirma que desea elimintar el registro seleccionado?",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Si, eliminar!",cancelButtonText:"No, cancelar!",closeOnConfirm:!0,closeOnCancel:!0},function(e){e?c(function(){var e=a.standard.legalFrameworkList[n];if(a.standard.legalFrameworkList.splice(n,1),0!=e.id){var r={};r.id=e.id,m({method:"POST",url:"api/minimum-standard-item-detail-0312/delete",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(r)}).then(function(a){swal("Eliminado","Registro eliminado satisfactoriamente","info")})["catch"](function(a){t.error(a),s.swal("Error en la eliminación","Se ha presentado un error durante la eliminación del registro. Por favor inténtelo de nuevo, si el error persiste, comuníquese con el administrador del sistema","error")})["finally"](function(){})}}):swal("Cancelación","La operación ha sido cancelada","error")})}}]);
"use strict";app.controller("configurationMinimumStandardItemCriterionEdit0312Ctrl",["$scope","$stateParams","$log","DTOptionsBuilder","DTColumnBuilder","DTColumnDefBuilder","$compile","toaster","$state","SweetAlert","$rootScope","$http","$timeout","$uibModal","flowFactory","cfpLoadingBar","$filter","$document","ListService","$aside",function(t,n,i,e,a,r,o,d,l,c,u,s,m,f,p,w,h,g,C,v){function S(){var n=[{name:"wg_customer_employee_number",value:null},{name:"wg_customer_risk_level",value:null}];C.getDataList(n).then(function(n){t.sizeList=n.data.data.wg_customer_employee_number,t.riskLevelList=n.data.data.wg_customer_risk_level},function(n){t.status="Unable to load customer data: "+n.message})}var I=null;t.currentParentId=t.$parent.currentId?t.$parent.currentId:0;var O=u.$on("onMinimumStandardChanged",function(n,i){0==t.currentParentId&&(t.currentParentId=i.newValue,y(),t.reloadData())});t.$on("$destroy",function(){O()}),t.isAgent="agent"==u.currentUser().wg_type,t.isAdmin="system"==u.currentUser().wg_type,t.isCustomer="customerAdmin"==u.currentUser().wg_type||"customerUser"==u.currentUser().wg_type,S(),t.isView="view"==t.$parent.modeDsp;var y=function(){t.entity={id:0,minimumStandardItemId:t.currentParentId,size:null,riskLevel:null,description:""}};y(),t.onLoadRecord=function(n){if(0!=n){var i={id:n};s({method:"GET",url:"api/minimum-standard-item-criterion-0312/get",params:i})["catch"](function(t){403==t.data.status?(c.swal("No Autorizado","No estas autorizado para ver esta información.","error"),m(function(){l.go("app.clientes.list")},3e3)):404==t.data.status?c.swal("Información no disponible","Registro no encontrado","error"):c.swal("Error","Se ha presentado un error al intentar acceder a la información del registro","error")}).then(function(n){m(function(){t.entity=n.data.result,t.canShow=!0})})["finally"](function(){})}},t.form={submit:function(t){I=t;var n=null;if(t.$invalid){var i=null,n=null;for(i in t)"$"!=i[0]&&(null!==n||t[i].$valid||(n=t[i].$name),t[i].$pristine&&(t[i].$dirty=!0));return angular.element(".ng-invalid[name="+n+"]").focus(),void c.swal("El formulario contiene errores!","Por favor corrige los errores del formulario e Intentalo de nuevo.","error")}D()},reset:function(t){t.$setPristine(!0)}};var D=function(){var n={},e=JSON.stringify(t.entity);return n.data=Base64.encode(e),s({method:"POST",url:"api/minimum-standard-item-criterion-0312/save",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(n)}).then(function(n){m(function(){c.swal("Registro","La información ha sido guardada satisfactoriamente","success"),t.onCancel(),t.reloadData()})})["catch"](function(t){i.error(t),c.swal("Error de guardado",t.data.message,"error")})["finally"](function(){})};t.dtOptionsMinimumStandardItemCriterion0312=e.newOptions().withBootstrap().withOption("responsive",!0).withOption("ajax",{data:function(n){return n.minimumStandardItemId=t.currentParentId,JSON.stringify(n)},url:"api/minimum-standard-item-criterion-0312",contentType:"application/json",type:"POST",beforeSend:function(){},complete:function(){}}).withDataProp("data").withOption("order",[[0,"desc"]]).withOption("serverSide",!0).withOption("processing",!0).withOption("fnPreDrawCallback",function(){return!0}).withOption("fnDrawCallback",function(){b()}).withOption("language",{}).withPaginationType("full_numbers").withOption("createdRow",function(n,i,e){o(angular.element(n).contents())(t)}),t.dtColumnsMinimumStandardItemCriterion0312=[a.newColumn(null).withTitle("Acciones").withOption("width",150).notSortable().renderWith(function(t,n,i,e){var a="",r="",o='<a class="btn btn-primary btn-xs editRow lnk" href="#" tooltip="Editar" data-id="'+t.id+'" >   <i class="fa fa-edit"></i></a> ',d='<a class="btn btn-danger btn-xs delRow lnk" href="#" tooltip="Eliminar" data-id="'+t.id+'" >   <i class="fa fa-trash-o"></i></a> ',l=' | <a class="btn btn-info btn-xs configRow lnk" href="#"  uib-tooltip="Configurar modos de verificación" data-id="'+t.id+'"'+r+' >   <i class="fa fa-cog"></i></a> ';return a+=o,a+=d,a+=l}),a.newColumn("size").withTitle("Tamaño Empresa").withOption("width",200).withOption("defaultContent",""),a.newColumn("riskLevel").withTitle("Clase de Riesgo").withOption("width",200).withOption("defaultContent",""),a.newColumn("description").withTitle("Criterio").withOption("width",200).withOption("defaultContent","")];var b=function(){$("#dtMinimumStandardItemCriterion0312 a.editRow").on("click",function(){var n=$(this).data("id");t.onLoadRecord(n)}),$("#dtMinimumStandardItemCriterion0312 a.configRow").on("click",function(){var t=$(this).data("id");T(t)}),$("#dtMinimumStandardItemCriterion0312 a.delRow").on("click",function(){var n=$(this).data("id");c.swal({title:"Está seguro?",text:"Eliminará el registro seleccionado.",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Si, eliminar!",cancelButtonText:"No, continuar!",closeOnConfirm:!0,closeOnCancel:!0},function(i){if(i){var e={};e.id=n,s({method:"POST",url:"api/minimum-standard-item-criterion-0312/delete",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(e)}).then(function(t){swal("Eliminado","Regitro eliminado satisfactoriamente","info")})["catch"](function(t){c.swal("Error en la eliminación","Se ha presentado un error durante la eliminación del registro por favor intentelo de nuevo","error")})["finally"](function(){t.reloadData()})}else swal("Cancelado","Operacion cancelada","error")})})};t.dtInstanceMinimumStandardItemCriterion0312Callback=function(n){t.dtInstanceMinimumStandardItemCriterion0312=n},t.reloadData=function(){null!=t.dtInstanceMinimumStandardItemCriterion0312&&t.dtInstanceMinimumStandardItemCriterion0312.reloadData()},t.onCancel=function(){y()};var T=function(n){var i={id:n?n:0},e=v.open({templateUrl:u.app.views.urlRoot+"modules/configuration/minimum-standard-0312/item/configuration_minimum_standard_item_criterion_edit_modal.htm",placement:"right",size:"lg",backdrop:!0,controller:"ModalInstanceSideMinimumStandardItemCriterionDetailEdit0312Ctrl",scope:t,resolve:{entity:function(){return i}}});e.result.then(function(){t.reloadData()},function(){})}}]),app.controller("ModalInstanceSideMinimumStandardItemCriterionDetailEdit0312Ctrl",["$rootScope","$stateParams","$scope","$uibModalInstance","entity","$log","$timeout","SweetAlert","$http","toaster","$filter","$aside","$document","DTColumnBuilder","DTOptionsBuilder","$compile",function(t,n,i,e,a,r,o,d,l,c,u,s,m,f,p,w){var h=null;i.criterion={id:a.id},i.onCloseModal=function(){e.close()},i.onCancel=function(){e.dismiss("cancel")},i.onClear=function(){g()};var g=function(){i.entity={id:0,minimumStandardItemCriterionId:a.id,type:"verification-mode",description:""},null!=h&&h.$setPristine(!0)};g();var C=function(t){if(0!=t){var n={id:t};l({method:"GET",url:"api/minimum-standard-item-criterion-0312/get",params:n})["catch"](function(t){}).then(function(t){o(function(){i.criterion=t.data.result})})["finally"](function(){})}};C(a.id);var v=function(t){if(0!=t){var n={id:t};l({method:"GET",url:"api/minimum-standard-item-criterion-detail-0312/get",params:n})["catch"](function(t){}).then(function(t){o(function(){i.entity=t.data.result})})["finally"](function(){})}};i.form={submit:function(t){h=t;var n=null;if(t.$invalid){var i=null,n=null;for(i in t)"$"!=i[0]&&(null!==n||t[i].$valid||(n=t[i].$name),t[i].$pristine&&(t[i].$dirty=!0));return angular.element(".ng-invalid[name="+n+"]").focus(),void d.swal("El formulario contiene errores!","Por favor corrige los errores del formulario e Intentalo de nuevo.","error")}S()},reset:function(t){t.$setPristine(!0)}};var S=function(){var t={},n=JSON.stringify(i.entity);return t.data=Base64.encode(n),l({method:"POST",url:"api/minimum-standard-item-criterion-detail-0312/save",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(t)}).then(function(t){o(function(){d.swal("Registro","La información ha sido guardada satisfactoriamente","success"),i.onClear(),i.reloadData()})})["catch"](function(t){r.error(t),d.swal("Error de guardado","Error guardando el registro por favor verifique los datos ingresados!","error")})["finally"](function(){})};i.dtOptionsMinimumStandardItemCriterionDetail0312=p.newOptions().withBootstrap().withOption("responsive",!0).withOption("ajax",{data:function(t){return t.minimumStandardItemCriterionId=a.id,JSON.stringify(t)},url:"api/minimum-standard-item-criterion-detail-0312",contentType:"application/json",type:"POST",beforeSend:function(){},complete:function(){}}).withDataProp("data").withOption("order",[[0,"desc"]]).withOption("serverSide",!0).withOption("processing",!0).withOption("fnPreDrawCallback",function(){return!0}).withOption("fnDrawCallback",function(){I()}).withOption("language",{}).withPaginationType("full_numbers").withOption("createdRow",function(t,n,e){w(angular.element(t).contents())(i)}),i.dtColumnsMinimumStandardItemCriterionDetail0312=[f.newColumn(null).withTitle("Acciones").withOption("width",150).notSortable().renderWith(function(t,n,i,e){var a="",r='<a class="btn btn-primary btn-xs editRow lnk" href="#" tooltip="Editar" data-id="'+t.id+'" >   <i class="fa fa-edit"></i></a> ',o='<a class="btn btn-danger btn-xs delRow lnk" href="#" tooltip="Eliminar" data-id="'+t.id+'" >   <i class="fa fa-trash-o"></i></a> ';return a+=r,a+=o}),f.newColumn("description").withTitle("").withOption("defaultContent","")];var I=function(){$("#dtMinimumStandardItemCriterionDetail0312 a.editRow").on("click",function(){var t=$(this).data("id");v(t)}),$("#dtMinimumStandardItemCriterionDetail0312 a.delRow").on("click",function(){var t=$(this).data("id");d.swal({title:"Está seguro?",text:"Eliminará el registro seleccionado.",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Si, eliminar!",cancelButtonText:"No, continuar!",closeOnConfirm:!0,closeOnCancel:!0},function(n){if(n){var e={};e.id=t,l({method:"POST",url:"api/minimum-standard-item-criterion-detail-0312/delete",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(e)}).then(function(t){swal("Eliminado","Regitro eliminado satisfactoriamente","info")})["catch"](function(t){d.swal("Error en la eliminación","Se ha presentado un error durante la eliminación del registro por favor intentelo de nuevo","error")})["finally"](function(){i.reloadData()})}else swal("Cancelado","Operacion cancelada","error")})})};i.dtInstanceMinimumStandardItemCriterionDetail0312Callback=function(t){i.dtInstanceMinimumStandardItemCriterionDetail0312=t},i.reloadData=function(){null!=i.dtInstanceMinimumStandardItemCriterionDetail0312&&i.dtInstanceMinimumStandardItemCriterionDetail0312.reloadData()}}]);
"use strict";app.controller("configurationMinimumStandard0312Ctrl",["$scope","$stateParams","$log","$compile","$rootScope","$timeout",function(t,n,o,c,i,r){t.standard_section="list",t.currentId=0,t.navToSection=function(n,o,c){r(function(){t.standard_section=n,t.currentId=c})}}]);
"use strict";app.controller("configurationMinimumStandardList0312Ctrl",["$scope","$stateParams","$log","DTOptionsBuilder","DTColumnBuilder","DTColumnDefBuilder","$compile","toaster","$state","$rootScope","$timeout","$http","SweetAlert","$aside",function(n,t,a,i,e,o,r,l,d,s,c,u,m,p){n.isNewMinimumStandard=!0,n.dtOptionsMinimumStandard0312=i.newOptions().withBootstrap().withOption("responsive",!0).withOption("ajax",{data:function(n){return JSON.stringify(n)},url:"api/minimum-standard-0312",contentType:"application/json",type:"POST",beforeSend:function(){},complete:function(){}}).withDataProp("data").withOption("order",[[0,"desc"]]).withOption("serverSide",!0).withOption("processing",!0).withOption("fnPreDrawCallback",function(){return!0}).withOption("fnDrawCallback",function(){f()}).withOption("language",{}).withPaginationType("full_numbers").withOption("createdRow",function(t,a,i){r(angular.element(t).contents())(n)}),n.dtColumnsMinimumStandard0312=[e.newColumn(null).withTitle("Acciones").withOption("width",150).notSortable().renderWith(function(n,t,a,i){var e="",o="",r='<a class="btn btn-primary btn-xs editRow lnk" href="#" uib-tooltip="Editar"  data-id="'+n.id+'"'+o+' >   <i class="fa fa-play-circle"></i></a> ',l='<a class="btn btn-danger btn-xs delRow lnk" href="#"  uib-tooltip="Eliminar" data-id="'+n.id+'"'+o+' >   <i class="fa fa-trash-o"></i></a> ';return e+=r,e+=l}),e.newColumn("cycle").withTitle("Ciclo").withOption("width",200).withOption("defaultContent",""),e.newColumn("parentNumeral").withTitle("Numeral (Padre)").withOption("width",200).withOption("defaultContent",""),e.newColumn("numeral").withTitle("Numeral (Hijo)").withOption("width",200).withOption("defaultContent",""),e.newColumn("description").withTitle("Estándar").withOption("width",200).withOption("defaultContent",""),e.newColumn("type").withTitle("Tipo").withOption("width",200).withOption("defaultContent",""),e.newColumn(null).withTitle("Activo").withOption("width",200).renderWith(function(n,t,a,i){var e="",o=n.status;return e=n||1==n.isActive?"label label-success":"label label-danger",'<span class="'+e+'">'+o+"</span>"})];var f=function(){$("#dtMinimumStandard0312 a.editRow").on("click",function(){var t=$(this).data("id");n.onEdit(t)}),$("#dtMinimumStandard0312 a.delRow").on("click",function(){var t=$(this).data("id");m.swal({title:"Está seguro?",text:"Eliminará el registro seleccionado.",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Si, eliminar!",cancelButtonText:"No, continuar!",closeOnConfirm:!0,closeOnCancel:!0},function(i){if(i){var e={};e.id=t,u({method:"POST",url:"api/minimum-standard-0312/delete",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(e)}).then(function(n){swal("Eliminado","Registro eliminado satisfactoriamente","info")})["catch"](function(n,t){a.error(n),500==t?m.swal("Error en la eliminación",n.message,"error"):m.swal("Error en la eliminación","Se ha presentado un error durante la eliminación del registro. Por favor inténtelo de nuevo, si el error persiste, comuníquese con el administrador del sistema","error")})["finally"](function(){n.reloadData()})}else swal("Cancelación","La operación ha sido cancelada","error")})})};n.dtInstanceMinimumStandard0312Callback=function(t){n.dtInstanceMinimumStandard0312=t},n.reloadData=function(){n.dtInstanceMinimumStandard0312.reloadData(null,!1)},n.onEdit=function(n){w(n)},n.onCreate=function(){w()};var w=function(t){var a={id:t?t:0},i=p.open({templateUrl:s.app.views.urlRoot+"modules/configuration/minimum-standard-0312/standard/configuration_minimum_standard_modal.htm",placement:"right",size:"lg",backdrop:!0,controller:"ModalInstanceSideMinimumStandardEdit0312Ctrl",scope:n,resolve:{standard:function(){return a}}});i.result.then(function(){n.reloadData()})}}]),app.controller("ModalInstanceSideMinimumStandardEdit0312Ctrl",["$rootScope","$stateParams","$scope","$uibModalInstance","standard","$log","$timeout","SweetAlert","$http","toaster","$filter","$aside","$document","DTColumnBuilder","DTOptionsBuilder","$compile","ListService",function(n,t,a,i,e,o,r,l,d,s,c,u,m,p,f,w,h){function v(){var n=[{name:"minimum-standard-cycle-0312",value:null},{name:"minimum-standard-parent-0312",value:null},{name:"minimum_standard_type",value:null}];h.getDataList(n).then(function(n){a.cycleList=n.data.data.minimum_standard_cycle_0312,a.parentListAll=n.data.data.minimum_standard_parent_0312,a.typeList=n.data.data.minimum_standard_type},function(n){a.status="Unable to load customer data: "+n.message})}var C=o;a.parentList=[],v();var g=function(){a.standard={id:e.id,type:null,cycle:null,parent:null,numeral:"",description:"",isActive:!0}};g(),a.onCloseModal=function(){i.close(1)},a.onCancel=function(){i.dismiss("cancel")},a.onLoadRecord=function(){if(0!=a.standard.id){var n={id:a.standard.id};d({method:"GET",url:"api/minimum-standard-0312/get",params:n})["catch"](function(n,t){}).then(function(n){r(function(){a.standard=n.data.result,a.onSelectCycle()},400)})["finally"](function(){r(function(){m.scrollTop(40,2e3)})})}},a.onLoadRecord(),a.onSelectCycle=function(){a.parentList=[],null!=a.standard.cycle&&(a.parentList=c("filter")(a.parentListAll,{cycleId:a.standard.cycle.id}))},a.form={submit:function(n){var t=null;if(n.$invalid){var i=null,t=null;for(i in n)"$"!=i[0]&&(null!==t||n[i].$valid||(t=n[i].$name),n[i].$pristine&&(n[i].$dirty=!0));return C.info(a.standard),angular.element(".ng-invalid[name="+t+"]").focus(),void l.swal("El formulario contiene errores!","Por favor corrige los errores del formulario e Intentalo de nuevo.","error")}O()},reset:function(n){a.clear()}};var O=function(){var n=JSON.stringify(a.standard),t={data:Base64.encode(n)};return d({method:"POST",url:"api/minimum-standard-0312/save",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(t)}).then(function(n){l.swal("Registro","La información ha sido guardada satisfactoriamente","success"),r(function(){a.onCloseModal()})})["catch"](function(n){l.swal("Error de guardado","Error guardando el registro. Por favor verifique los datos ingresados!","error")})["finally"](function(){})}}]);
"use strict";app.controller("configurationRoadSafetyCtrl",["$scope","$stateParams","$log","$compile","$rootScope","$timeout",function(t,o,a,n,r,c){var e=a;e.info("loading..customerRoadSafetyCtrl!!! "),t.standard_section="list",t.currentId=0,t.dataSummary=[],t.navToSection=function(o,a,n){c(function(){t.standard_section=o,t.currentId=n})}}]);
"use strict";app.controller("configurationRoadSafetyListCtrl",["$scope","$stateParams","$log","DTOptionsBuilder","DTColumnBuilder","DTColumnDefBuilder","$compile","toaster","$state","$rootScope","$timeout","$http","SweetAlert","$aside",function(t,a,e,n,o,i,r,l,d,c,s,u,f,p){var m=e,w={};m.info("loading..configurationRoadSafetyListCtrl "),t.isNewRoadSafety=!0,w.operation="diagnostic",t.dtInstanceRoadSafety={},t.dtOptionsRoadSafety=n.newOptions().withBootstrap().withOption("responsive",!0).withOption("ajax",{data:w,url:"api/road-safety",type:"POST",beforeSend:function(){},complete:function(){}}).withDataProp("data").withOption("order",[[0,"desc"]]).withOption("serverSide",!0).withOption("processing",!0).withOption("fnPreDrawCallback",function(){return!0}).withOption("fnDrawCallback",function(){h()}).withOption("language",{}).withPaginationType("full_numbers").withOption("createdRow",function(a,e,n){r(angular.element(a).contents())(t)}),t.dtColumnsRoadSafety=[o.newColumn(null).withTitle("Acciones").withOption("width",100).notSortable().renderWith(function(t,a,e,n){var o="",i="",r='<a class="btn btn-primary btn-xs editRow lnk" href="#" uib-tooltip="Editar"  data-id="'+t.id+'"'+i+' >   <i class="fa fa-play-circle"></i></a> ',l='<a class="btn btn-danger btn-xs delRow lnk" href="#"  uib-tooltip="Eliminar" data-id="'+t.id+'"'+i+' >   <i class="fa fa-trash-o"></i></a> ';return o+=r,o+=l}),o.newColumn("cycle.name").withTitle("Módulo").withOption("width",200).withOption("defaultContent",""),o.newColumn("type.item").withTitle("Tipo").withOption("width",200).withOption("defaultContent",""),o.newColumn("parent.numeral").withTitle("Numeral (Parámetro)").withOption("width",200).withOption("defaultContent",""),o.newColumn("description").withTitle("Descripción").withOption("width",200).withOption("defaultContent",""),o.newColumn("isActive").withTitle("Estado").withOption("width",200).renderWith(function(t,a,e,n){var o="",i="";t||1==t?(o="label label-success",i="Activo"):(o="label label-danger",i="Inactivo");var r='<span class="'+o+'">'+i+"</span>";return r})];var h=function(){$("#dtRoadSafety a.editRow").on("click",function(){var a=$(this).data("id");t.editRoadSafety(a)}),$("#dtRoadSafety a.delRow").on("click",function(){var a=$(this).data("id");f.swal({title:"Está seguro?",text:"Eliminará el registro seleccionado.",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Si, eliminar!",cancelButtonText:"No, continuar!",closeOnConfirm:!0,closeOnCancel:!0},function(n){if(n){var o={};o.id=a,u({method:"POST",url:"api/road-safety/delete",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(o)}).then(function(t){swal("Eliminado","Registro eliminado satisfactoriamente","info")})["catch"](function(t,a){e.error(t),500==a?f.swal("Error en la eliminación",t.message,"error"):f.swal("Error en la eliminación","Se ha presentado un error durante la eliminación del registro. Por favor inténtelo de nuevo, si el error persiste, comuníquese con el administrador del sistema","error")})["finally"](function(){t.reloadData()})}else swal("Cancelación","La operación ha sido cancelada","error")})})};t.reloadData=function(){t.dtInstanceRoadSafety.reloadData(null,!1)},t.editRoadSafety=function(t){y(t)},t.onCreate=function(){y()};var y=function(a){var e={id:a?a:0},n=p.open({templateUrl:c.app.views.urlRoot+"modules/configuration/road-safety/parameter/configuration_road_safety_modal.htm",placement:"right",size:"lg",backdrop:!0,controller:"ModalInstanceSideRoadSafetyEditCtrl",scope:t,resolve:{roadSafety:function(){return e}}});n.result.then(function(){t.reloadData()})}}]),app.controller("ModalInstanceSideRoadSafetyEditCtrl",["$rootScope","$stateParams","$scope","$uibModalInstance","roadSafety","$log","$timeout","SweetAlert","$http","toaster","$filter","$aside","$document","DTColumnBuilder","DTOptionsBuilder","$compile",function(t,a,e,n,o,i,r,l,d,c,s,u,f,p,m,w){var h=i;e.maxDate=new Date,e.datePickerConfig={culture:"es-CO",format:"dd/MM/yyyy HH:mm"},e.loading=!0,e.roadSafety={},e.typeList=t.parameters("road_safety_type"),e.cycleList=[],e.parentList=[],e.parentListAll=[];var y=function(){var t={};return d({method:"POST",url:"api/road-safety/list-data",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(t)}).then(function(t){r(function(){e.cycleList=t.data.data.cycle,e.parentListAll=t.data.data.parent})})["catch"](function(t){l.swal("Error de guardado","Error guardando el registro. Por favor verifique los datos ingresados!","error")})["finally"](function(){})};y(),e.onCloseModal=function(){n.close(1)},e.onCancel=function(){n.dismiss("cancel")},e.onLoadRecord=function(){if(0!=e.roadSafety.id){var t={id:e.roadSafety.id};d({method:"GET",url:"api/road-safety",params:t})["catch"](function(t,a){if(403==a){var e=null!==t.message&&void 0!==t.message?t.message:"app.clientes.list";l.swal("No Autorizado","No estas autorizado para ver esta información.","error"),r(function(){$state.go(e)},3e3)}else 404==a?l.swal("Información no disponible","Centro de trabajo no encontrado","error"):l.swal("Error","Se ha presentado un error al intentar acceder a la información del centro de trabajo","error")}).then(function(t){r(function(){e.roadSafety=t.data.result},400)})["finally"](function(){r(function(){e.loading=!1},400),r(function(){f.scrollTop(40,2e3)})})}else e.loading=!1};var g=function(){e.roadSafety={id:o.id,type:null,cycle:null,parent:null,numeral:"",description:"",isActive:!0}};g(),e.onLoadRecord(),e.$watch("roadSafety.cycle",function(t,a,n){e.parentList=[],null==a||angular.equals(t,a)||(e.roadSafety.parent=null),null!=e.roadSafety.cycle&&(e.parentList=s("filter")(e.parentListAll,{cycleId:e.roadSafety.cycle.id}))}),e.master=e.roadSafety,e.form={submit:function(t){var a=null;if(t.$invalid){var n=null,a=null;for(n in t)"$"!=n[0]&&(null!==a||t[n].$valid||(a=t[n].$name),t[n].$pristine&&(t[n].$dirty=!0));return h.info(e.roadSafety),angular.element(".ng-invalid[name="+a+"]").focus(),void l.swal("El formulario contiene errores!","Por favor corrige los errores del formulario e Intentalo de nuevo.","error")}l.swal("Validación exitosa","Guardando información del centro de trabajo...","success"),S()},reset:function(t){e.clear()}};var S=function(){var t=JSON.stringify(e.roadSafety),a={data:Base64.encode(t)};return d({method:"POST",url:"api/road-safety/save",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(a)}).then(function(t){r(function(){e.onCloseModal()})})["catch"](function(t){l.swal("Error de guardado","Error guardando el registro. Por favor verifique los datos ingresados!","error")})["finally"](function(){})}}]);
"use strict";app.controller("configurationRoadSafetyItemCtrl",["$scope","$stateParams","$log","$compile","$rootScope","$timeout",function(t,o,n,a,r,e){var i=n;i.info("loading..configurationRoadSafetyItemCtrl!!! "),t.standard_section="list",t.currentId=0,t.dataSummary=[],t.navToSection=function(o,n,a){e(function(){t.standard_section=o,t.currentId=a})}}]);
"use strict";app.controller("configurationRoadSafetyItemListCtrl",["$scope","$stateParams","$log","DTOptionsBuilder","DTColumnBuilder","DTColumnDefBuilder","$compile","toaster","$state","$rootScope","$timeout","$http","SweetAlert","$aside",function(t,e,n,i,a,o,r,l,d,c,s,u,f,w){var p=n,h={};p.info("loading..configurationRoadSafetyItemItemListCtrl "),t.isNewRoadSafetyItem=!0,h.operation="diagnostic",t.dtInstanceRoadSafetyItem={},t.dtOptionsRoadSafetyItem=i.newOptions().withBootstrap().withOption("responsive",!0).withOption("ajax",{data:h,url:"api/road-safety-item",type:"POST",beforeSend:function(){},complete:function(){}}).withDataProp("data").withOption("order",[[0,"desc"]]).withOption("serverSide",!0).withOption("processing",!0).withOption("fnPreDrawCallback",function(){return!0}).withOption("fnDrawCallback",function(){m()}).withOption("language",{}).withPaginationType("full_numbers").withOption("createdRow",function(e,n,i){r(angular.element(e).contents())(t)}),t.dtColumnsRoadSafetyItem=[a.newColumn(null).withTitle("Acciones").withOption("width",180).notSortable().renderWith(function(t,e,n,i){var a="",o="",r='<a class="btn btn-primary btn-xs editRow lnk" href="#" uib-tooltip="Editar"  data-id="'+t.id+'"'+o+' >   <i class="fa fa-play-circle"></i></a> ',l='<a class="btn btn-danger btn-xs delRow lnk" href="#"  uib-tooltip="Eliminar" data-id="'+t.id+'"'+o+' >   <i class="fa fa-trash-o"></i></a> ';return a+=r,a+=l}),a.newColumn("roadSafety.cycle.name").withTitle("Módulo").withOption("width",200).withOption("defaultContent",""),a.newColumn("roadSafety.parent.numeral").withTitle("Numeral (Parámetro)").withOption("width",200).withOption("defaultContent",""),a.newColumn("roadSafety.parent.description").withTitle("Descripción (Parámetro)").withOption("width",200).withOption("defaultContent",""),a.newColumn("roadSafety.description").withTitle("Descripción (Variable)").withOption("width",200).withOption("defaultContent",""),a.newColumn("numeral").withTitle("Numeral").withOption("width",200).withOption("defaultContent",""),a.newColumn("criterion").withTitle("Criterio").withOption("width",200).withOption("defaultContent",""),a.newColumn("value").withTitle("Valor").withOption("width",200).withOption("defaultContent",""),a.newColumn("isActive").withTitle("Estado").withOption("width",200).renderWith(function(t,e,n,i){var a="",o="";t||1==t?(a="label label-success",o="Activo"):(a="label label-danger",o="Inactivo");var r='<span class="'+a+'">'+o+"</span>";return r})];var m=function(){$("#dtRoadSafetyItem a.editRow").on("click",function(){var e=$(this).data("id");t.editRoadSafetyItem(e)}),$("#dtRoadSafetyItem a.configRow").on("click",function(){var t=$(this).data("id");S(t)}),$("#dtRoadSafetyItem a.delRow").on("click",function(){var e=$(this).data("id");f.swal({title:"Está seguro?",text:"Eliminará el registro seleccionado.",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Si, eliminar!",cancelButtonText:"No, continuar!",closeOnConfirm:!0,closeOnCancel:!0},function(i){if(i){var a={};a.id=e,u({method:"POST",url:"api/road-safety-item/delete",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(a)}).then(function(t){swal("Eliminado","Registro eliminado satisfactoriamente","info")})["catch"](function(t){n.error(t),f.swal("Error en la eliminación","Se ha presentado un error durante la eliminación del registro. Por favor inténtelo de nuevo, si el error persiste, comuníquese con el administrador del sistema","error")})["finally"](function(){t.reloadData()})}else swal("Cancelación","La operación ha sido cancelada","error")})})};t.reloadData=function(){t.dtInstanceRoadSafetyItem.reloadData(null,!1)},t.editRoadSafetyItem=function(e){null!=t.$parent&&t.$parent.navToSection("edit","edit",e)},t.onCreate=function(){null!=t.$parent&&t.$parent.navToSection("edit","edit",0)};var S=function(e){var n={id:e?e:0},i=w.open({templateUrl:"app_modal_road_safety_association.htm",placement:"right",size:"lg",backdrop:!0,controller:"ModalInstanceSideRoadSafetyItemAssociationCtrl",scope:t,resolve:{roadSafety:function(){return n}}});i.result.then(function(){t.reloadData()})}}]),app.controller("ModalInstanceSideRoadSafetyItemAssociationCtrl",["$rootScope","$stateParams","$scope","$uibModalInstance","roadSafety","$log","$timeout","SweetAlert","$http","toaster","$filter","$aside","$document","DTColumnBuilder","DTOptionsBuilder","$compile",function(t,e,n,i,a,o,r,l,d,c,s,u,f,w,p,h){var m=o;n.maxDate=new Date,n.datePickerConfig={culture:"es-CO",format:"dd/MM/yyyy HH:mm"},n.loading=!0,n.roadSafety={roadSafetyItemId:a.id,questions:[]},n.master=n.roadSafety,n.form={submit:function(t){var e=null;if(t.$invalid){var n=null,e=null;for(n in t)"$"!=n[0]&&(null!==e||t[n].$valid||(e=t[n].$name),t[n].$pristine&&(t[n].$dirty=!0));return angular.element(".ng-invalid[name="+e+"]").focus(),void l.swal("El formulario contiene errores!","Por favor corrige los errores del formulario e Intentalo de nuevo.","error")}l.swal("Validación exitosa","Procediendo con el guardado...","success"),S()},reset:function(t){n.roadSafety=angular.copy(n.master),t.$setPristine(!0)}};var S=function(){var t={},e=JSON.stringify(n.roadSafety);return t.data=Base64.encode(e),d({method:"POST",url:"api/road-safety-item-question/insert",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(t)}).then(function(t){r(function(){n.reloadData(),n.reloadDataSelected()})})["catch"](function(t){o.error(t),l.swal("Error de guardado","Error guardando el registro. Por favor verifique los datos ingresados!","error")})["finally"](function(){})},y={};y.operation="management",y.road_safety_item_id=a.id?a.id:0,n.dtInstanceRoadSafetyQuestionSelected={},n.dtOptionsRoadSafetyQuestionSelected=p.newOptions().withBootstrap().withOption("responsive",!0).withOption("ajax",{data:y,url:"api/road-safety-item-question",type:"POST",beforeSend:function(){},complete:function(t){r(function(){})}}).withDataProp("data").withOption("order",[[0,"desc"]]).withOption("serverSide",!0).withOption("processing",!0).withOption("fnPreDrawCallback",function(){return!0}).withOption("fnDrawCallback",function(){g()}).withDOM("tr").withOption("language",{}).withOption("createdRow",function(t,e,i){h(angular.element(t).contents())(n)}),n.dtColumnsRoadSafetyQuestionSelected=[w.newColumn(null).withTitle("").withOption("width",100).notSortable().renderWith(function(t,e,i,a){var o="",r='<a class="btn btn-light-red btn-xs delRow lnk" href="#" uib-tooltip="Quitar item" data-id="'+t.id+'" >   <i class="fa fa-ban"></i></a> ';return n.isAdmin,o+=r}),w.newColumn("programPreventionQuestionId").withTitle("ID").withOption("width",200),w.newColumn("program").withTitle("Programa").withOption("width",400),w.newColumn("category").withTitle("Categoría"),w.newColumn("article").withTitle("Artículo"),w.newColumn("question").withTitle("Pregunta"),w.newColumn("guide").withTitle("Guía").withOption("width",200).renderWith(function(t,e,n,i){var a="",o="";null!=t&&""!=t?(o="Tiene",a="label label-success"):(o="No tiene",a="label label-danger");var r='<span class="'+a+'">'+o+"</span>";return r})];var g=function(){$("#dtRoadSafetyQuestionSelected a.configureRow").on("click",function(){var t=$(this).data("id");n.onEditQuestion(t)}),$("#dtRoadSafetyQuestionSelected a.delRow").on("click",function(){var t=$(this).data("id");m.info("intenta eliminar el registro: "+t),l.swal({title:"Está seguro?",text:"Eliminará el registro seleccionado.",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Si, eliminar!",cancelButtonText:"No, cancelar!",closeOnConfirm:!0,closeOnCancel:!0},function(e){if(e){var i={};i.id=t,d({method:"POST",url:"api/road-safety-item-question/delete",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(i)}).then(function(t){swal("Eliminado","Registro eliminado satisfactoriamente","info")})["catch"](function(t){o.error(t),l.swal("Error en la eliminación","Se ha presentado un error durante la eliminación del registro. Por favor inténtelo de nuevo, si el error persiste, comuníquese con el administrador del sistema","error")})["finally"](function(){n.reloadDataSelected(),n.reloadData()})}else swal("Cancelación","La operación ha sido cancelada","error")})})};n.dtInstanceRoadSafetyQuestionSelectedCallback=function(t){n.dtInstanceRoadSafetyQuestionSelected=t},n.reloadDataSelected=function(){n.dtInstanceRoadSafetyQuestionSelected.reloadData()},n.dtInstanceRoadSafetyQuestion={},n.dtOptionsRoadSafetyQuestion=p.newOptions().withBootstrap().withOption("responsive",!0).withOption("ajax",{data:y,url:"api/road-safety-item-question-available",type:"POST",beforeSend:function(){},complete:function(t){r(function(){})}}).withDataProp("data").withOption("order",[[0,"desc"]]).withOption("serverSide",!0).withOption("processing",!0).withOption("fnPreDrawCallback",function(){return!0}).withOption("fnDrawCallback",function(){O()}).withDOM("tr").withOption("language",{}).withOption("createdRow",function(t,e,i){h(angular.element(t).contents())(n)}),n.dtColumnsRoadSafetyQuestion=[w.newColumn("programPreventionQuestionId").withTitle("ID").withOption("width",150),w.newColumn("program").withTitle("Programa").withOption("width",400),w.newColumn("category").withTitle("Categoría"),w.newColumn("article").withTitle("Artículo"),w.newColumn("question").withTitle("Pregunta"),w.newColumn("guide").withTitle("Guía").withOption("width",200).renderWith(function(t,e,n,i){var a="",o="";null!=t&&""!=t?(o="Tiene",a="label label-success"):(o="No tiene",a="label label-danger");var r='<span class="'+a+'">'+o+"</span>";return r}),w.newColumn(null).withTitle("Acciones").notSortable().renderWith(function(t,e,n,i){var a="",o="1"==t.selected?"checked":"",r='<input bs-switch ng-model="isSelected" type="checkbox" switch-active="true" ng-click="edit('+t.id+')" name="'+t.id+'" ng-true-value="true" ng-false-value="false" switch-on-text="Si" switch-off-text="No"> ',r='<div class="checkbox clip-check check-success "><input class="editRow" type="checkbox" id="chk_'+t.programPreventionQuestionId+'" data-id="'+t.programPreventionQuestionId+'" data-value="'+t.selected+'" '+o+' ><label for="chk_'+t.programPreventionQuestionId+'"> Seleccionar </label></div>';return a+=r}).notSortable()];var O=function(){$("input[type=checkbox]").on("change",function(){var t=$(this).data("id"),e=($(this).data("value"),$(this).is(":checked"));if(e){var i={programPreventionQuestionId:t};n.roadSafety.questions.push(i)}else n.roadSafety.questions=s("filter")(n.roadSafety.questions,{programPreventionQuestionId:"!"+t});m.info(n.roadSafety.questions)})};n.dtInstanceRoadSafetyQuestionCallback=function(t){n.dtInstanceRoadSafetyQuestion=t},n.reloadData=function(){n.dtInstanceRoadSafetyQuestion.reloadData()}}]);
"use strict";app.controller("configurationRoadSafetyItemEditCtrl",["$scope","$stateParams","$log","DTOptionsBuilder","DTColumnBuilder","DTColumnDefBuilder","$compile","toaster","$state","SweetAlert","$rootScope","$http","$timeout","$uibModal","flowFactory","cfpLoadingBar","$filter","$document","FileUploader","$localStorage","$aside",function(e,a,r,o,t,n,i,l,d,s,c,f,u,m,p,y,S,g,v,w,h){e.loading=!0,e.isCreate=0==e.$parent.currentId,e.parentList=[],e.roadSafetyList=[],e.roadSafetyListAll=[];var L=function(){var a={};return f({method:"POST",url:"api/road-safety/list-data",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(a)}).then(function(a){u(function(){e.parentList=a.data.data.parent,e.roadSafetyListAll=a.data.data.roadSafety})})["catch"](function(e){s.swal("Error de guardado","Error guardando el registro. Por favor verifique los datos ingresados!","error")})["finally"](function(){})};L();var C=function(){e.roadSafety={id:e.$parent.currentId?e.$parent.currentId:0,roadSafety:null,roadSafetyParent:null,numeral:"",description:"",value:0,criterion:"",isActive:!0,legalFrameworkList:[],verificationModeList:[]}};C(),e.$watch("roadSafety.roadSafetyParent",function(a,r,o){e.roadSafetyList=[],null==r||angular.equals(a,r)||(e.roadSafety.roadSafety=null),null!=e.roadSafety.roadSafetyParent&&(e.roadSafetyList=S("filter")(e.roadSafetyListAll,{parentId:e.roadSafety.roadSafetyParent.id}))});var T=function(){if(e.roadSafety.id){var a={id:e.roadSafety.id};f({method:"GET",url:"api/road-safety-item",params:a})["catch"](function(e,a){if(403==a){var r=null!==e.message&&void 0!==e.message?e.message:"app.clientes.list";s.swal("No Autorizado","No estas autorizado para ver esta información.","error"),u(function(){d.go(r)},3e3)}else 404==a?(s.swal("Información no disponible","Anexo no encontrado","error"),u(function(){d.go("app.clientes.list")})):s.swal("Error","Se ha presentado un error al intentar acceder al registro","error")}).then(function(a){u(function(){e.roadSafety=a.data.result})})["finally"](function(){u(function(){e.loading=!1},400)})}};T(),e.master=e.roadSafety,e.form={submit:function(e){var a=null;if(e.$invalid){var r=null,a=null;for(r in e)"$"!=r[0]&&(null!==a||e[r].$valid||(a=e[r].$name),e[r].$pristine&&(e[r].$dirty=!0));return angular.element(".ng-invalid[name="+a+"]").focus(),void s.swal("El formulario contiene errores!","Por favor corrige los errores del formulario e Intentalo de nuevo.","error")}s.swal("Validación exitosa","Procediendo con el guardado...","success"),P()},reset:function(a){e.roadSafety=angular.copy(e.master),a.$setPristine(!0)}};var P=function(){var a={},o=JSON.stringify(e.roadSafety);return a.data=Base64.encode(o),f({method:"POST",url:"api/road-safety-item/save",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(a)}).then(function(a){u(function(){e.roadSafety=a.data.result})})["catch"](function(e){r.error(e),s.swal("Error de guardado","Error guardando el registro. Por favor verifique los datos ingresados!","error")})["finally"](function(){e.reloadData()})};e.onCancel=function(){null!=e.$parent&&e.$parent.navToSection("list","list",0)},e.onAddLegalFramework=function(){u(function(){null==e.roadSafety.legalFrameworkList&&(e.roadSafety.legalFrameworkList=[]),e.roadSafety.legalFrameworkList.push({id:0,roadSafetyItemId:0,type:"legal-framework",description:""})})},e.onRemoveLegalFramework=function(a){s.swal({title:"Está seguro?",text:"Confirma que desea elimintar el registro seleccionado?",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Si, eliminar!",cancelButtonText:"No, cancelar!",closeOnConfirm:!0,closeOnCancel:!0},function(o){o?u(function(){var o=e.roadSafety.legalFrameworkList[a];if(e.roadSafety.legalFrameworkList.splice(a,1),0!=o.id){var t={};t.id=o.id,f({method:"POST",url:"api/road-safety-item-detail/delete",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(t)}).then(function(e){swal("Eliminado","Registro eliminado satisfactoriamente","info")})["catch"](function(e){r.error(e),s.swal("Error en la eliminación","Se ha presentado un error durante la eliminación del registro. Por favor inténtelo de nuevo, si el error persiste, comuníquese con el administrador del sistema","error")})["finally"](function(){})}}):swal("Cancelación","La operación ha sido cancelada","error")})},e.onAddVerificationMode=function(){u(function(){null==e.roadSafety.verificationModeList&&(e.roadSafety.verificationModeList=[]),e.roadSafety.verificationModeList.push({id:0,roadSafetyItemId:0,type:"verification-mode",description:""})})},e.onRemoveVerificationMode=function(a){s.swal({title:"Está seguro?",text:"Confirma que desea elimintar el registro seleccionado?",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Si, eliminar!",cancelButtonText:"No, cancelar!",closeOnConfirm:!0,closeOnCancel:!0},function(o){o?u(function(){var o=e.roadSafety.verificationModeList[a];if(e.roadSafety.verificationModeList.splice(a,1),0!=o.id){var t={};t.id=o.id,f({method:"POST",url:"api/road-safety-item-detail/delete",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(t)}).then(function(e){swal("Eliminado","Registro eliminado satisfactoriamente","info")})["catch"](function(e){r.error(e),s.swal("Error en la eliminación","Se ha presentado un error durante la eliminación del registro. Por favor inténtelo de nuevo, si el error persiste, comuníquese con el administrador del sistema","error")})["finally"](function(){})}}):swal("Cancelación","La operación ha sido cancelada","error")})}}]);
"use strict";app.controller("ConfigurationComplementaryTestCtrl",["$scope","$stateParams","$log","$compile","$rootScope","$timeout","$filter","$state",function(e,t,o,i,a,n,s,r){e.isCreate=r.is("app.configuration.complementary-test"),e.views=[{name:"basic",url:a.app.views.urlRoot+"modules/configuration/complementary-test/_form.htm"},{name:"classification",url:a.app.views.urlRoot+"modules/configuration/complementary-test/_result.htm"}],e.section=e.views[0],e.currentId=0,e.modeView="form",e.tabsLoaded=["basic"],e.tabName=e.tabsLoaded[0],e.navToSection=function(t,o,i){n(function(){e.section=e.getView(t),e.modeView=o,e.currentId=i})},e.getView=function(t){var o=s("filter")(e.views,{name:t});return o[0]},e.switchTab=function(t){n(function(){e.tabName=t,e.tabsLoaded.push(t),e.section=e.getView(t)})}}]);
"use strict";app.controller("ConfigurationComplementaryTestFormCtrl",["$scope","$stateParams","$log","$compile","toaster","$state","SweetAlert","$rootScope","$http","$timeout","$filter","DTOptionsBuilder","DTColumnBuilder","DTColumnDefBuilder",function(e,t,n,a,o,i,r,l,s,c,d,u,p,m){var f=n,w=function(){e.parameter={id:0,namespace:"wgroup",group:"work_medicine_complementary_test",code:"",item:"",value:""}};w(),e.form={submit:function(e){var t=null;if(e.$invalid){var n=null,t=null;for(n in e)"$"!=n[0]&&(null!==t||e[n].$valid||(t=e[n].$name),e[n].$pristine&&(e[n].$dirty=!0));return angular.element(".ng-invalid[name="+t+"]").focus(),void c(function(){o.pop("error","Error","Por favor verifique los datos requeridos del formulario y vuelva a intentarlo")},500)}h()},reset:function(e){e.$setPristine(!0)}};var h=function(){var t={},a=JSON.stringify(e.parameter);return t.data=Base64.encode(a),s({method:"POST",url:"api/system-parameter/save",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(t)}).then(function(t){e.onCancel(),c(function(){o.pop("success","Operación Exitosa","Procediendo con el guardado...")},500)})["catch"](function(e){n.error(e),o.pop("error","Error","Error guardando el registro. Por favor verifique los datos ingresados!")})["finally"](function(){})},C=function(t){if(t){var n={id:t};s({method:"GET",url:"api/system-parameter/get",params:n})["catch"](function(t,n){403==n?(o.pop("error","No Autorizado","No esta autorizado para ver esta información."),c(function(){e.onCancel()},3e3)):404==n?(o.pop("error","Información no disponible","Registro no encontrado."),c(function(){e.onCancel()})):o.pop("error","Error","Se ha presentado un error al intentar acceder a la información.")}).then(function(t){c(function(){e.parameter=t.data.result})})["finally"](function(){})}};e.request={operation:"parameter",namespace:"wgroup",group:"work_medicine_complementary_test"},e.dtInstanceComplementaryTest={},e.dtOptionsComplementaryTest=u.newOptions().withBootstrap().withOption("responsive",!0).withOption("ajax",{data:e.request,url:"api/system-parameter",type:"POST",beforeSend:function(){},complete:function(){}}).withDataProp("data").withOption("order",[[0,"desc"]]).withOption("serverSide",!0).withOption("processing",!0).withOption("fnPreDrawCallback",function(){return!0}).withOption("fnDrawCallback",function(){v()}).withOption("language",{}).withPaginationType("full_numbers").withOption("createdRow",function(t,n,o){a(angular.element(t).contents())(e)}),e.dtColumnsComplementaryTest=[p.newColumn(null).withTitle("Acciones").withOption("width",150).notSortable().renderWith(function(e,t,n,a){var o="",i="",r='<a class="btn btn-primary btn-xs editRow lnk" href="#" uib-tooltip="Editar"  data-id="'+e.id+'"'+i+' >   <i class="fa fa-edit"></i></a> ',l='<a class="btn btn-info btn-xs viewRow lnk" href="#"  uib-tooltip="Ver" data-id="'+e.id+'" >   <i class="fa fa-eye"></i></a> ',s='<a class="btn btn-danger btn-xs delRow lnk" href="#"  uib-tooltip="Eliminar" data-id="'+e.id+'"'+i+' >   <i class="fa fa-trash-o"></i></a> ';return o+=l,o+=r,o+=s}),p.newColumn("value").withTitle("Código").withOption("width",200),p.newColumn("item").withTitle("Descripción")];var v=function(){$("#dtComplementaryTest a.editRow").on("click",function(){var t=$(this).data("id");e.onEdit(t)}),$("#dtComplementaryTest a.viewRow").on("click",function(){var t=$(this).data("id");e.parameter.id=t,e.onView(t)}),$("#dtComplementaryTest a.delRow").on("click",function(){var t=$(this).data("id");f.info("intenta eliminar el registro: "+t),r.swal({title:"Está seguro?",text:"Eliminará el registro seleccionado.",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Si, eliminar!",cancelButtonText:"No, continuar!",closeOnConfirm:!0,closeOnCancel:!0},function(a){if(a){var o={};o.id=t,s({method:"POST",url:"api/system-parameter/delete",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(o)}).then(function(e){swal("Eliminado","Registro eliminado satisfactoriamente","info")})["catch"](function(e){n.error(e),r.swal("Error en la eliminación","Se ha presentado un error durante la eliminación del registro. Por favor inténtelo de nuevo, si el error persiste, comuníquese con el administrador del sistema","error")})["finally"](function(){e.reloadData()})}else swal("Cancelación","La operación ha sido cancelada","error")})})};e.dtInstanceComplementaryTestCallback=function(t){e.dtInstanceComplementaryTest=t},e.reloadData=function(){e.dtInstanceComplementaryTest.reloadData()},e.onView=function(t){e.isView=!0,C(t)},e.onEdit=function(t){e.isView=!1,C(t)},e.onCancel=function(){w(),e.reloadData()}}]);
"use strict";app.controller("ConfigurationComplementaryTestResultCtrl",["$scope","$stateParams","$log","$compile","toaster","$state","SweetAlert","$rootScope","$http","$timeout","$filter","ListService","DTOptionsBuilder","DTColumnBuilder","DTColumnDefBuilder",function(e,t,n,a,o,i,r,l,s,c,u,d,m,p,f){function w(){var t=[{name:"work_medicine_complementary_test"}];d.getDataList(t).then(function(t){e.complementaryTestList=t.data.data.work_medicine_complementary_test},function(t){e.status="Unable to load customer data: "+t.message})}var h=n;e.dateConfig={culture:"es-CO",format:"dd/MM/yyyy"};var y=function(){e.parameter={id:0,group:"work_medicine_complementary_test_result",namespace:"wgroup",code:null,item:"",value:null}};y(),w(),e.form={submit:function(e){var t=null;if(e.$invalid){var n=null,t=null;for(n in e)"$"!=n[0]&&(null!==t||e[n].$valid||(t=e[n].$name),e[n].$pristine&&(e[n].$dirty=!0));return angular.element(".ng-invalid[name="+t+"]").focus(),void c(function(){o.pop("error","Error","Por favor verifique los datos requeridos del formulario y vuelva a intentarlo")},500)}C()},reset:function(e){e.$setPristine(!0)}};var C=function(){var t={},a=JSON.stringify(e.parameter);return t.data=Base64.encode(a),s({method:"POST",url:"api/system-parameter/save",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(t)}).then(function(t){e.onCancel(),c(function(){o.pop("success","Operación Exitosa","Procediendo con el guardado...")},500)})["catch"](function(e){n.error(e),o.pop("error","Error","Error guardando el registro. Por favor verifique los datos ingresados!")})["finally"](function(){})},v=function(t){if(t){var n={id:t};s({method:"GET",url:"api/system-parameter/get",params:n})["catch"](function(t,n){403==n?(o.pop("error","No Autorizado","No esta autorizado para ver esta información."),c(function(){e.onCancel()},3e3)):404==n?(o.pop("error","Información no disponible","Registro no encontrado."),c(function(){e.onCancel()})):o.pop("error","Error","Se ha presentado un error al intentar acceder a la información.")}).then(function(t){c(function(){e.parameter=t.data.result})})["finally"](function(){})}};e.request={operation:"parameter",namespace:"wgroup",group:"work_medicine_complementary_test_result",parent:"work_medicine_complementary_test"},e.dtInstanceComplementaryTestResult={},e.dtOptionsComplementaryTestResult=m.newOptions().withBootstrap().withOption("responsive",!0).withOption("ajax",{data:e.request,url:"api/system-parameter/relation",type:"POST",beforeSend:function(){},complete:function(){}}).withDataProp("data").withOption("order",[[0,"desc"]]).withOption("serverSide",!0).withOption("processing",!0).withOption("fnPreDrawCallback",function(){return!0}).withOption("fnDrawCallback",function(){g()}).withOption("language",{}).withPaginationType("full_numbers").withOption("createdRow",function(t,n,o){a(angular.element(t).contents())(e)}),e.dtColumnsComplementaryTestResult=[p.newColumn(null).withTitle("Acciones").withOption("width",150).notSortable().renderWith(function(e,t,n,a){var o="",i="",r='<a class="btn btn-primary btn-xs editRow lnk" href="#" uib-tooltip="Editar"  data-id="'+e.id+'"'+i+' >   <i class="fa fa-edit"></i></a> ',l='<a class="btn btn-info btn-xs viewRow lnk" href="#"  uib-tooltip="Ver" data-id="'+e.id+'" >   <i class="fa fa-eye"></i></a> ',s='<a class="btn btn-danger btn-xs delRow lnk" href="#"  uib-tooltip="Eliminar" data-id="'+e.id+'"'+i+' >   <i class="fa fa-trash-o"></i></a> ';return o+=l,o+=r,o+=s}),p.newColumn("value").withTitle("Código").withOption("width",200),p.newColumn("item").withTitle("Descripción"),p.newColumn("parent").withTitle("Prueba Complementaria").withOption("width",200)];var g=function(){$("#dtComplementaryTestResult a.editRow").on("click",function(){var t=$(this).data("id");e.onEdit(t)}),$("#dtComplementaryTestResult a.viewRow").on("click",function(){var t=$(this).data("id");e.parameter.id=t,e.onView(t)}),$("#dtComplementaryTestResult a.delRow").on("click",function(){var t=$(this).data("id");h.info("intenta eliminar el registro: "+t),r.swal({title:"Está seguro?",text:"Eliminará el registro seleccionado.",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Si, eliminar!",cancelButtonText:"No, continuar!",closeOnConfirm:!0,closeOnCancel:!0},function(a){if(a){var o={};o.id=t,s({method:"POST",url:"api/system-parameter/delete",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(o)}).then(function(e){swal("Eliminado","Registro eliminado satisfactoriamente","info")})["catch"](function(e){n.error(e),r.swal("Error en la eliminación","Se ha presentado un error durante la eliminación del registro. Por favor inténtelo de nuevo, si el error persiste, comuníquese con el administrador del sistema","error")})["finally"](function(){e.reloadData()})}else swal("Cancelación","La operación ha sido cancelada","error")})})};e.dtInstanceComplementaryTestResultCallback=function(t){e.dtInstanceComplementaryTestResult=t},e.reloadData=function(){e.dtInstanceComplementaryTestResult.reloadData()},e.onView=function(t){e.isView=!0,v(t)},e.onEdit=function(t){e.isView=!1,v(t)},e.onCancel=function(){y(),e.reloadData()},e.refreshComplementaryTest=function(){w()}}]);
"use strict";app.factory("ConfigurationComplementaryTestService",["$http",function(t){var r={};return r.get=function(r){var e={id:r};return t({method:"GET",url:"api/system-parameter/get",params:e})},r}]);
"use strict";app.controller("ConfigurationPrioritizationFactorCtrl",["$scope","$stateParams","$log","$compile","$rootScope","$timeout","$filter","$state",function(t,i,o,e,a,n,r,c){t.isCreate=c.is("app.configuration.prioritization-factor"),t.views=[{name:"basic",url:a.app.views.urlRoot+"modules/configuration/prioritization-factor/_form.htm"}],t.section=t.views[0],t.currentId=0,t.modeView="form",t.tabsLoaded=["basic"],t.tabName=t.tabsLoaded[0],t.navToSection=function(i,o,e){n(function(){t.section=t.getView(i),t.modeView=o,t.currentId=e})},t.getView=function(i){var o=r("filter")(t.views,{name:i});return o[0]},t.switchTab=function(i){n(function(){t.tabName=i,t.tabsLoaded.push(i),t.section=t.getView(i)})}}]);
"use strict";app.controller("ConfigurationPrioritizationFactorFormCtrl",["$scope","$stateParams","$log","$compile","toaster","$state","SweetAlert","$rootScope","$http","$timeout","$filter","DTOptionsBuilder","DTColumnBuilder","DTColumnDefBuilder",function(e,t,a,n,i,r,o,c,l,s,u,p,d,m){var f=a;e.probabilityOccurrenceList=c.parameters("improvement_plan_root_cause_probability_occur"),e.effectList=c.parameters("improvement_plan_root_cause_effect"),e.levelList=c.parameters("improvement_plan_root_detection_level");var w=function(){e.parameter={id:0,namespace:"wgroup",group:"improvement_plan_root_prioritization_factor",code:"",item:"",value:""},e.cause={probabilityOccurrence:null,effect:null,detectionLevel:null}};w(),e.form={submit:function(e){var t=null;if(e.$invalid){var a=null,t=null;for(a in e)"$"!=a[0]&&(null!==t||e[a].$valid||(t=e[a].$name),e[a].$pristine&&(e[a].$dirty=!0));return angular.element(".ng-invalid[name="+t+"]").focus(),void s(function(){i.pop("error","Error","Por favor verifique los datos requeridos del formulario y vuelva a intentarlo")},500)}v()},reset:function(e){e.$setPristine(!0)}};var v=function(){var t={},n=JSON.stringify(e.parameter);return t.data=Base64.encode(n),l({method:"POST",url:"api/system-parameter/save",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(t)}).then(function(t){e.onCancel(),s(function(){i.pop("success","Operación Exitosa","Información guardada satisfactoriamente")},500)})["catch"](function(e){a.error(e),i.pop("error","Error",e.message)})["finally"](function(){})},h=function(t){if(t){var a={id:t};l({method:"GET",url:"api/system-parameter/get",params:a})["catch"](function(t,a){403==a?(i.pop("error","No Autorizado","No esta autorizado para ver esta información."),s(function(){e.onCancel()},3e3)):404==a?(i.pop("error","Información no disponible","Registro no encontrado."),s(function(){e.onCancel()})):i.pop("error","Error","Se ha presentado un error al intentar acceder a la información.")}).then(function(t){s(function(){e.parameter=t.data.result})})["finally"](function(){})}};e.request={operation:"parameter",namespace:"wgroup",group:"improvement_plan_root_prioritization_factor"},e.dtInstanceComplementaryTest={},e.dtOptionsComplementaryTest=p.newOptions().withBootstrap().withOption("responsive",!0).withOption("ajax",{data:e.request,url:"api/system-parameter",type:"POST",beforeSend:function(){},complete:function(){}}).withDataProp("data").withOption("order",[[0,"desc"]]).withOption("serverSide",!0).withOption("processing",!0).withOption("fnPreDrawCallback",function(){return!0}).withOption("fnDrawCallback",function(){b()}).withOption("language",{}).withPaginationType("full_numbers").withOption("createdRow",function(t,a,i){n(angular.element(t).contents())(e)}),e.dtColumnsComplementaryTest=[d.newColumn(null).withTitle("Acciones").withOption("width",150).notSortable().renderWith(function(e,t,a,n){var i="",r="",o='<a class="btn btn-primary btn-xs editRow lnk" href="#" uib-tooltip="Editar"  data-id="'+e.id+'"'+r+' >   <i class="fa fa-edit"></i></a> ',c='<a class="btn btn-info btn-xs viewRow lnk" href="#"  uib-tooltip="Ver" data-id="'+e.id+'" >   <i class="fa fa-eye"></i></a> ',l='<a class="btn btn-danger btn-xs delRow lnk" href="#"  uib-tooltip="Eliminar" data-id="'+e.id+'"'+r+' >   <i class="fa fa-trash-o"></i></a> ';return i+=c,i+=o,i+=l}),d.newColumn("value").withTitle("Factor Priorización").withOption("width",200),d.newColumn("item").withTitle("Descripción")];var b=function(){$("#dtComplementaryTest a.editRow").on("click",function(){var t=$(this).data("id");e.onEdit(t)}),$("#dtComplementaryTest a.viewRow").on("click",function(){var t=$(this).data("id");e.parameter.id=t,e.onView(t)}),$("#dtComplementaryTest a.delRow").on("click",function(){var t=$(this).data("id");f.info("intenta eliminar el registro: "+t),o.swal({title:"Está seguro?",text:"Eliminará el registro seleccionado.",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Si, eliminar!",cancelButtonText:"No, continuar!",closeOnConfirm:!0,closeOnCancel:!0},function(n){if(n){var i={};i.id=t,l({method:"POST",url:"api/system-parameter/delete",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(i)}).then(function(e){swal("Eliminado","Registro eliminado satisfactoriamente","info")})["catch"](function(e){a.error(e),o.swal("Error en la eliminación","Se ha presentado un error durante la eliminación del registro. Por favor inténtelo de nuevo, si el error persiste, comuníquese con el administrador del sistema","error")})["finally"](function(){e.reloadData()})}else swal("Cancelación","La operación ha sido cancelada","error")})})};e.dtInstanceComplementaryTestCallback=function(t){e.dtInstanceComplementaryTest=t},e.reloadData=function(){e.dtInstanceComplementaryTest.reloadData()},e.onView=function(t){e.isView=!0,h(t)},e.onEdit=function(t){e.isView=!1,h(t)},e.onCancel=function(){w(),e.reloadData()},e.$watch("cause.probabilityOccurrence",function(e,t,a){y()}),e.$watch("cause.effect",function(e,t,a){y()}),e.$watch("cause.detectionLevel",function(e,t,a){y()});var y=function(){var t=e.cause.probabilityOccurrence?parseInt(e.cause.probabilityOccurrence.value):0,a=e.cause.effect?parseInt(e.cause.effect.value):0,n=e.cause.detectionLevel?parseInt(e.cause.detectionLevel.value):0;e.parameter.value=t*a*n,0==e.parameter.value&&(e.parameter.value="")}}]);
"use strict";app.controller("resourceLibraryListCtrl",["$scope","$stateParams","$log","DTOptionsBuilder","DTColumnBuilder","DTColumnDefBuilder","$compile","toaster","$state","$rootScope","SweetAlert","$http","$aside","moment","ListService",function(e,t,n,o,r,i,a,l,s,c,u,d,f,p,m){function w(){var t=[{name:"criteria_operators",value:null},{name:"criteria_conditions",value:null},{name:"resource_library_custom_filter_field",value:null}];m.getDataList(t).then(function(t){e.criteria=t.data.data.criteriaOperatorList,e.conditions=t.data.data.criteriaConditionList,e.audit.fields=t.data.data.resourceLibraryCustomFilterField},function(t){e.status="Unable to load customer data: "+t.message})}var h=n;h.info("entrando en... certificateAdminProgramCtrl"),e.isAgent="agent"==c.currentUser().wg_type,e.isAdmin="system"==c.currentUser().wg_type,e.isCustomer="customerAdmin"==c.currentUser().wg_type||"customerUser"==c.currentUser().wg_type,e.currentCustomerId=c.currentUser().company,e.audit={fields:[],filters:[]},w(),e.dtOptionsResourceLibrary=o.newOptions().withBootstrap().withOption("responsive",!0).withOption("ajax",{data:function(t){return angular.isDefined(e.audit)&&angular.isDefined(e.audit.filters)&&(t.filter={filters:e.audit.filters.filter(function(e){return null!=e&&null!=e.field&&null!=e.criteria}).map(function(e,t,n){return{field:e.field.name,operator:e.criteria.value,value:e.value,condition:{value:"and"}}})}),JSON.stringify(t)},url:"api/resource-library",contentType:"application/json",type:"POST",beforeSend:function(){},complete:function(){}}).withDataProp("data").withOption("order",[[3,"desc"]]).withOption("serverSide",!0).withOption("processing",!0).withOption("fnPreDrawCallback",function(){return!0}).withOption("fnDrawCallback",function(){g()}).withOption("language",{}).withPaginationType("full_numbers").withOption("createdRow",function(t,n,o){a(angular.element(t).contents())(e)}),e.dtColumnsResourceLibrary=[r.newColumn(null).withTitle("Acciones").withOption("width",150).notSortable().renderWith(function(e,t,n,o){var r=e.documentUrl?e.documentUrl:"",i="api/resource-library/download?id="+e.id,a="",l="",s='<a target="_self" class="btn btn-primary btn-xs editRow lnk" href="#" uib-tooltip="Editar" data-id="'+e.id+'" '+l+'  >   <i class="fa fa-edit"></i></a> ',c='<a target="_self" class="btn btn-info btn-xs downloadDocumentRow lnk" href="'+i+'" uib-tooltip="Descargar recurso" data-id="'+e.id+'" >   <i class="fa fa-download"></i></a> ',u='<a class="btn btn-danger btn-xs delRow lnk" href="#"  uib-tooltip="Eliminar" data-id="'+e.id+'"'+l+' >   <i class="fa fa-trash-o"></i></a> ';return a+=s,""!=r&&(a+=c),a+=u}),r.newColumn("createdAt").withTitle("Fecha Creación").withOption("type","date").withOption("width",200).renderWith(function(e,t,n,o){return p(e.date).format("DD/MM/YYYY")}),r.newColumn("type").withTitle("Tipo").withOption("width",200).withOption("defaultContent",""),r.newColumn("dateOf").withTitle("Fecha Recurso").withOption("type","date").withOption("width",200).renderWith(function(e,t,n,o){return p(e).format("DD/MM/YYYY")}),r.newColumn("name").withTitle("Nombre").withOption("width",200).withOption("defaultContent",""),r.newColumn("author").withTitle("Autor/Emisor").withOption("width",200).withOption("defaultContent",""),r.newColumn("subject").withTitle("Asunto").withOption("width",200).withOption("defaultContent",""),r.newColumn("description").withTitle("Descripción").withOption("width",200).withOption("defaultContent",""),r.newColumn(null).withTitle("Estado").withOption("width",200).renderWith(function(e,t,n,o){var r="label label-success",i=e.status;e.isActive||(r="label label-danger");var a='<span class="'+r+'">'+i+"</span>";return a})];var g=function(){$("#dtResourceLibrary a.editRow").on("click",function(){var t=$(this).data("id");e.onAddResourceLibrary(t)}),$("#dtResourceLibrary a.downloadRow").on("click",function(){var e=$(this).data("id");jQuery("#downloadDocument")[0].src="api/resource-library/download?id="+e}),$("#dtResourceLibrary a.delRow").on("click",function(){var t=$(this).data("id");h.info("intenta eliminar el registro: "+t),u.swal({title:"Está seguro?",text:"Eliminara el recurso de la biblioteca seleccionado.",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Si, eliminar!",cancelButtonText:"No, cancelar!",closeOnConfirm:!0,closeOnCancel:!0},function(o){if(o){var r={};r.id=t,d({method:"POST",url:"api/resource-library/delete",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(r)}).then(function(e){swal("Eliminado","Registro eliminado satisfactoriamente","info")})["catch"](function(e){n.error(e),u.swal("Error en la eliminación","Se ha presentado un error durante la eliminación del registro. Por favor inténtelo de nuevo, si el error persiste, comuníquese con el administrador del sistema","error")})["finally"](function(){e.reloadData()})}else swal("Cancelación","La operación ha sido cancelada","error")})})};e.dtInstanceResourceLibraryCallback=function(t){e.dtInstanceResourceLibrary=t},e.reloadData=function(){e.dtInstanceResourceLibrary.reloadData()},e.onCreate=function(){e.onAddResourceLibrary(0)},e.addFilter=function(){null==e.audit.filters&&(e.audit.filters=[]),e.audit.filters.push({id:0,field:null,criteria:null,condition:null,value:""})},e.onFilter=function(){e.reloadData()},e.removeFilter=function(t){e.audit.filters.splice(t,1),0==e.audit.filters.length&&e.reloadData()},e.onCleanFilter=function(){e.audit.filters=[],e.reloadData()},e.onAddResourceLibrary=function(t){var n={id:t},o=f.open({templateUrl:c.app.views.urlRoot+"modules/configuration/resource-library/resource_library_modal.htm",placement:"right",size:"lg",backdrop:!0,controller:"ModalInstanceSideResourceLibraryCtrl",scope:e,resolve:{resource:function(){return n}}});o.result.then(function(){e.reloadData()},function(){e.reloadData()})}}]),app.controller("ModalInstanceSideResourceLibraryCtrl",["$rootScope","$stateParams","$scope","$uibModalInstance","resource","$log","$timeout","SweetAlert","$http","toaster","$filter","FileUploader","DTColumnBuilder","DTOptionsBuilder","$compile",function(e,t,n,o,r,i,a,l,s,c,u,d,f,p,m){n.flowConfig={target:"/api/resource-library/upload-cover",singleFile:!0},n.uploader=new Flow,n.resourceLibraryTypeList=e.parameters("resource_library_type"),n.noImage=!0;var w=0,h=function(){n.resource={id:r.id?r.id:0,type:null,dateOf:null,name:"",author:"",subject:"",description:"",isActive:!0,keywords:[]}};h();var g=function(){if(n.resource.id){var e={id:n.resource.id};s({method:"GET",url:"api/resource-library",params:e})["catch"](function(e,t){if(403==t){var n=null!==e.message&&void 0!==e.message?e.message:"app.clientes.list";l.swal("No Autorizado","No estas autorizado para ver esta información.","error"),a(function(){$state.go(n)},3e3)}else 404==t?(l.swal("Información no disponible","Anexo no encontrado","error"),a(function(){$state.go("app.clientes.list")})):l.swal("Error","Se ha presentado un error al intentar acceder a la información del anexo","error")}).then(function(e){a(function(){n.resource=e.data.result,n.noImage=""==n.resource.cover,v()})})["finally"](function(){a(function(){n.loading=!1},400)})}};g();var v=function(){null!=n.resource.dateOf&&(n.resource.dateOf=new Date(n.resource.dateOf.date))};n.removeImage=function(){n.noImage=!0};var y=n.uploaderResource=new d({url:"api/resource-library/upload",formData:[]});y.filters.push({name:"customFilter",fn:function(e,t){return this.queue.length<10}}),y.onWhenAddingFileFailed=function(e,t,n){console.info("onWhenAddingFileFailed",e,t,n)},y.onAfterAddingFile=function(e){console.info("onAfterAddingFile",e)},y.onAfterAddingAll=function(e){console.info("onAfterAddingAll",e)},y.onBeforeUploadItem=function(e){console.info("onBeforeUploadItem",e);var t={id:w};e.formData.push(t)},y.onProgressItem=function(e,t){console.info("onProgressItem",e,t)},y.onProgressAll=function(e){console.info("onProgressAll",e)},y.onSuccessItem=function(e,t,n,o){console.info("onSuccessItem",e,t,n,o)},y.onErrorItem=function(e,t,n,o){console.info("onErrorItem",e,t,n,o)},y.onCancelItem=function(e,t,n,o){console.info("onCancelItem",e,t,n,o)},y.onCompleteItem=function(e,t,n,o){console.info("onCompleteItem",e,t,n,o)},y.onCompleteAll=function(){console.info("onCompleteAll"),c.pop("success","Operación Exitosa","La información ha sido guardada satisfactoriamente"),n.onCloseModal()},n.onCloseModal=function(){o.close(1)},n.onCancel=function(){o.dismiss("cancel")},n.form={submit:function(e){var t=null;if(e.$invalid){var o=null,t=null;for(o in e)"$"!=o[0]&&(null!==t||e[o].$valid||(t=e[o].$name),e[o].$pristine&&(e[o].$dirty=!0));return angular.element(".ng-invalid[name="+t+"]").focus(),void a(function(){c.pop("error","Error","Por favor verifique los datos requeridos del formulario y vuelva a intentarlo")},500)}return 0==n.resource.id&&0==n.uploaderResource.queue.length?void l.swal("El formulario contiene errores!","Por favor seleccione un archivo e Intentalo de nuevo.","error"):void n.onSave()},reset:function(e){e.$setPristine(!0)}},n.onSave=function(){var e="";if(null!=n.resource.dateOf&&""!=n.resource.dateOf||(e+="Debe ingresar la fecha \n"),""!=e)return void l.swal({html:!1,title:"Error de validación",text:e,type:"error"});var t={},o=JSON.stringify(n.resource);return t.data=Base64.encode(o),s({method:"POST",url:"api/resource-library/save",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(t)}).then(function(e){a(function(){n.uploader.flow.opts.query.id=e.data.result.id,n.uploader.flow.resume(),y.queue.length>0?(w=e.data.result.id,y.uploadAll()):(c.pop("success","Operación Exitosa","La información ha sido guardada satisfactoriamente"),n.onCloseModal())})})["catch"](function(e){i.error(e),c.pop("error","Error","Por favor ingrese los campos requeridos.")})["finally"](function(){})},n.onAddKeyword=function(){a(function(){null==n.resource.keywords&&(n.resource.keywords=[]),n.resource.keywords.push({text:""})})},n.onRemoveKeyword=function(e){l.swal({title:"Está seguro?",text:"Desea confirmar la eliminación de este registro ?",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Si, eliminar!",cancelButtonText:"No, cancelar!",closeOnConfirm:!0,closeOnCancel:!0},function(t){t?a(function(){n.resource.keywords.splice(e,1)}):swal("Cancelación","La operación ha sido cancelada","error")})}}]);
"use strict";app.controller("economicSectorTask",["$scope","$aside","$stateParams","$log","$compile","toaster","$state","SweetAlert","$rootScope","$http","$timeout","$uibModal","$filter","$document","ListService",function(t,e,n,o,i,a,r,c,l,s,u,d,m,f,v){function p(){var e=[{name:"economic_sector",value:null}];v.getDataList(e).then(function(e){t.economicSectorList=e.data.data.economicSectorList},function(e){t.status="Unable to load customer data: "+e.message})}var y=null;p();var h=function(){t.entity={economicSector:null,taskList:null},y&&y.$setPristine(!0)};h(),t.form={submit:function(t){y=t;var e=null;if(t.$invalid){var n=null,e=null;for(n in t)"$"!=n[0]&&(null!==e||t[n].$valid||(e=t[n].$name),t[n].$pristine&&(t[n].$dirty=!0));return angular.element(".ng-invalid[name="+e+"]").focus(),void c.swal("El formulario contiene errores!","Por favor corrige los errores del formulario e Intentalo de nuevo.","error")}S()},reset:function(t){t.$setPristine(!0)}};var S=function(){var e={data:Base64.encode(JSON.stringify(t.entity.taskList))};return s({method:"POST",url:"api/economic-sector-task/batch",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(e)}).then(function(e){u(function(){t.entity.taskList=e.data.result.data,c.swal("Validación exitosa","Guardando información del cliente...","success")})})["catch"](function(t){c.swal("Error de guardado","Error guardando el registro. Por favor verifique los datos ingresados!","error")})["finally"](function(){})};t.onSelectEconomicSector=function(){var e={economicSectorId:t.entity.economicSector.id};return s({method:"POST",url:"api/economic-sector-task",headers:{"Content-Type":"aapplication/json"},data:e}).then(function(e){u(function(){t.entity.taskList=e.data.data})})["catch"](function(t){})["finally"](function(){})},t.onAddTask=function(e){null==t.entity.taskList&&(t.entity.taskList=[]),t.entity.taskList.push({id:0,economicSectorId:t.entity.economicSector.id,name:null,isActive:!0}),u(function(){var t=null;if(e.$invalid){var n=null;for(n in e)"$"!=n[0]&&(e[n].$valid||(t=e[n].$name),e[n].$pristine&&(e[n].$dirty=!0));return void angular.element(".ng-invalid[name="+t+"]").focus()}})},t.onRemoveTask=function(e){c.swal({title:"Está seguro?",text:"Eliminará el registro seleccionado.",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Si, eliminar!",cancelButtonText:"No, cancelar!",closeOnConfirm:!0,closeOnCancel:!0},function(n){n?u(function(){var n=t.entity.taskList[e];if(t.entity.taskList.splice(e,1),0!=n.id){var o={id:n.id};s({method:"POST",url:"api/economic-sector-task/delete",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(o)}).then(function(t){swal("Eliminado","Registro eliminado satisfactoriamente","info")})["catch"](function(t){c.swal("Error en la eliminación","Se ha presentado un error durante la eliminación del registro. Por favor inténtelo de nuevo, si el error persiste, comuníquese con el administrador del sistema","error")})["finally"](function(){})}}):swal("Cancelación","La operación ha sido cancelada","error")})}}]);
"use strict";app.controller("configurationHelpRolesProfileCtrl",["$scope","$stateParams","$log","DTOptionsBuilder","DTColumnBuilder","DTColumnDefBuilder","$compile","toaster","$state","$rootScope","$timeout","$http","SweetAlert","$aside","$document","flowFactory","ListService","FileUploader",function(e,n,o,t,i,r,a,l,s,c,d,u,f,p,m,h,w,g){function v(){var n=[{name:"configuration_help_roles_profile_type"}];w.getDataList(n).then(function(n){e.typeList=n.data.data.typeList},function(e){y.info("Unable to load types data: "+e.message)})}var y=o;y.info("loading..configurationHelpRolesProfileCtrl "),e.flowConfig={target:"/api/system-parameter/upload",singleFile:!0},e.loading=!0,e.isEdit=!1,e.entity={},e.typeList=[],e.descriptionList=[],e.Form=null;var A=0;e.uploader=new Flow;var C=function(){e.entity={id:0,type:null,description:null,text:null,attatchment:null}};C(),v(),e.onSelectType=function(){var n=null;n="Roles"==e.entity.type.item?"customer_user_role":"wg_customer_user_profile";var o=[{name:n}];w.getDataList(o).then(function(o){e.descriptionList=o.data.data[n]},function(e){y.info("Unable to load roles profiles data: "+e.message)})},e.form={submit:function(n){var o=null;if(e.Form=n,n.$invalid){var t=null,o=null;for(t in n)"$"!=t[0]&&(null!==o||n[t].$valid||(o=n[t].$name),n[t].$pristine&&(n[t].$dirty=!0));return angular.element(".ng-invalid[name="+o+"]").focus(),void f.swal("El formulario contiene errores!","Por favor corrige los errores del formulario e Intentalo de nuevo.","error")}b()},reset:function(){e.Form.$setPristine(!0),C()}};var b=function(){if(0==T.queue.length&&1==e.entity.type.value&&!e.isEdit)return void f.swal("Validación de datos","El anexo es obligatorio para el rol.","warning");var n={},t=JSON.stringify(e.entity);return n.data=Base64.encode(t),u({method:"POST",url:"api/help-roles-profile/save",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(n)}).then(function(n){d(function(){T.queue.length>0?(A=n.data.result.id,T.uploadAll()):e.reloadData(),e.form.reset(),e.isEdit=!1})})["catch"](function(e){o.error(e),f.swal("Error de guardado","Error guardando el registro. Por favor verifique los datos ingresados!","error")})["finally"](function(){})};e.onLoadRecord=function(n){var o={id:n};u({method:"GET",url:"api/help-roles-profile/get",params:o})["catch"](function(e,n){f.swal("Error","Se ha presentado un error al intentar acceder a la información.","error")}).then(function(n){d(function(){e.entity=n.data.result,e.onSelectType(),e.isEdit=!0})})["finally"](function(){d(function(){e.loading=!1})})},e.dtInstanceArl={},e.dtOptionsArl=t.newOptions().withBootstrap().withOption("responsive",!0).withOption("ajax",{data:function(e){return e.customerId=n.customerId,JSON.stringify(e)},url:"api/help-roles-profile",type:"POST",beforeSend:function(){},complete:function(){}}).withDataProp("data").withOption("order",[[0,"desc"]]).withOption("serverSide",!0).withOption("processing",!0).withOption("fnPreDrawCallback",function(){return!0}).withOption("fnDrawCallback",function(){O()}).withOption("language",{}).withPaginationType("full_numbers").withOption("createdRow",function(n,o,t){a(angular.element(n).contents())(e)}),e.dtColumnsArl=[i.newColumn(null).withTitle("Acciones").withOption("width",120).notSortable().renderWith(function(e,n,o,t){var i="",r="",a='<a class="btn btn-primary btn-xs editRow lnk" href="#" uib-tooltip="Editar"  data-id="'+e.id+'"'+r+' >   <i class="fa fa-edit"></i></a> ',l='<a class="btn btn-danger btn-xs delRow lnk" href="#"  uib-tooltip="Eliminar" data-id="'+e.id+'"'+r+' >   <i class="fa fa-trash-o"></i></a> ',s="";if(e.documentUrl)var s='<a class="btn btn-info btn-xs openFile lnk" href="'+e.documentUrl+'" target="_blank" uib-tooltip="Abrir archivo" data-id="'+e.id+'"'+r+' >   <i class="fa fa-file"></i></a> ';return i+=a,i+=l,i+=s}),i.newColumn("typeName").withTitle("Tipo"),i.newColumn("descriptionName").withTitle("Descripción"),i.newColumn("text").withTitle("Texto").withOption("width",300)];var O=function(){$("#dtArl a.editRow").on("click",function(){var n=$(this).data("id");e.onLoadRecord(n)}),$("#dtArl a.delRow").on("click",function(){var n=$(this).data("id");f.swal({title:"Está seguro?",text:"Eliminará el registro seleccionado.",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Si, eliminar!",cancelButtonText:"No, continuar!",closeOnConfirm:!0,closeOnCancel:!0},function(t){if(t){var i={};i.id=n,u({method:"POST",url:"api/help-roles-profile/delete",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(i)}).then(function(e){swal("Eliminado","Registro eliminado satisfactoriamente","info")})["catch"](function(e){o.error(e),f.swal("Error en la eliminación","Se ha presentado un error durante la eliminación del registro. Por favor inténtelo de nuevo, si el error persiste, comuníquese con el administrador del sistema","error")})["finally"](function(){e.reloadData()})}else swal("Cancelación","La operación ha sido cancelada","error")})})};e.reloadData=function(){e.dtInstanceArl.reloadData()};var T=e.uploaderResource=new g({url:"api/help-roles-profile/upload",formData:[]});T.filters.push({name:"customFilter",fn:function(e,n){return this.queue.length<10}}),T.onWhenAddingFileFailed=function(e,n,o){console.info("onWhenAddingFileFailed",e,n,o)},T.onAfterAddingFile=function(e){console.info("onAfterAddingFile",e)},T.onAfterAddingAll=function(e){console.info("onAfterAddingAll",e)},T.onBeforeUploadItem=function(e){console.info("onBeforeUploadItem",e);var n={id:A};e.formData.push(n)},T.onProgressItem=function(e,n){console.info("onProgressItem",e,n)},T.onProgressAll=function(e){console.info("onProgressAll",e)},T.onSuccessItem=function(e,n,o,t){console.info("onSuccessItem",e,n,o,t)},T.onErrorItem=function(e,n,o,t){console.info("onErrorItem",e,n,o,t)},T.onCancelItem=function(e,n,o,t){console.info("onCancelItem",e,n,o,t)},T.onCompleteItem=function(e,n,o,t){console.info("onCompleteItem",e,n,o,t)},T.onCompleteAll=function(){console.info("onCompleteAll"),l.pop("success","Operación Exitosa","La información ha sido guardada satisfactoriamente"),e.reloadData()}}]);
"use strict";app.controller("configurationSignatureCertificateVRCtrl",["$scope","$stateParams","$log","DTOptionsBuilder","DTColumnBuilder","DTColumnDefBuilder","$compile","toaster","$state","$rootScope","$timeout","$http","SweetAlert","$aside","$document","flowFactory","ListService","FileUploader","$filter","bsLoadingOverlayService","$q",function(e,t,o,r,a,n,i,l,u,c,s,d,f,m,p,g,w,v,y,h,S){function T(){d({method:"GET",url:"api/config/signature-certificate-vr/get"}).then(function(t){console.log(t),e.entity=t.data.result})}e.uploader=new Flow,e.uploaderLogo=new Flow,e.dynamicPopover={templateUrl:"myPopoverTemplate.html"};var C=function(){e.entity={id:null,fullName:null,job:null,signature:null,logo:null}};C(),T(),e.form={submit:function(e){F()},reset:function(){e.Form.$setPristine(!0),C()}};var F=function(){var t=JSON.stringify(e.entity),o={data:Base64.encode(t)};return d({method:"POST",url:"api/config/signature-certificate-vr/save",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(o)}).then(function(t){console.log(t),s(function(){f.swal("Registro","La información ha sido guardada satisfactoriamente","success"),e.entity=t.data.result,e.uploader.flow.resume(),e.uploaderLogo.flow.resume()})})["catch"](function(e){f.swal("Error de guardado",e.data.message,"error")})}}]);
"use strict";app.controller("configurationSignatureIndicatorVRCtrl",["$scope","$stateParams","$log","DTOptionsBuilder","DTColumnBuilder","DTColumnDefBuilder","$compile","toaster","$state","$rootScope","$timeout","$http","SweetAlert","$aside","$document","flowFactory","ListService","FileUploader","$filter","bsLoadingOverlayService","$q",function(t,e,o,n,r,a,i,l,u,s,c,d,f,m,p,g,v,w,y,h,S){function T(){d({method:"GET",url:"api/config/signature-indicator-vr/get"}).then(function(e){console.log(e),t.entity=e.data.result})}t.uploader=new Flow,t.dynamicPopover={templateUrl:"myPopoverTemplate.html"};var P=function(){t.entity={id:null,text1:null,text2:null,signature:null}};P(),T(),t.form={submit:function(t){B()},reset:function(){t.Form.$setPristine(!0),P()}};var B=function(){var e=JSON.stringify(t.entity),o={data:Base64.encode(e)};return d({method:"POST",url:"api/config/signature-indicator-vr/save",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(o)}).then(function(e){console.log(e),c(function(){f.swal("Registro","La información ha sido guardada satisfactoriamente","success"),t.entity=e.data.result,t.uploader.flow.resume()})})["catch"](function(t){f.swal("Error de guardado",t.data.message,"error")})}}]);
"use strict";app.controller("templateManageListCtrl",["$scope","$stateParams","$log","DTOptionsBuilder","DTColumnBuilder","DTColumnDefBuilder","$compile","toaster","$state","$rootScope","SweetAlert","$http","$aside","moment","ListService","$localStorage",function(e,t,a,n,i,o,l,r,s,u,c,d,p,f,m,w){function h(){var t=[{name:"criteria_operators",value:null},{name:"criteria_conditions",value:null},{name:"template_manage_custom_filter_field",value:null}];m.getDataList(t).then(function(t){e.criteria=t.data.data.criteriaOperatorList,e.conditions=t.data.data.criteriaConditionList,e.audit.fields=t.data.data.templateManageCustomFilterField},function(t){e.status="Unable to load customer data: "+t.message})}var g=a;e.$storage=w.$default({showAllTemplate:!1}),e.isAgent="agent"==u.currentUser().wg_type,e.isAdmin="system"==u.currentUser().wg_type,e.isCustomer="customerAdmin"==u.currentUser().wg_type||"customerUser"==u.currentUser().wg_type,e.currentCustomerId=u.currentUser().company,e.audit={fields:[],filters:[]},h(),e.dtOptionsTemplateManage=n.newOptions().withBootstrap().withOption("responsive",!0).withOption("ajax",{data:function(t){return angular.isDefined(e.audit)&&angular.isDefined(e.audit.filters)&&(t.filter={filters:e.audit.filters.filter(function(e){return null!=e&&null!=e.field&&null!=e.criteria}).map(function(e,t,a){return{field:e.field.name,operator:e.criteria.value,value:e.value,condition:{value:"and"}}})}),e.$storage.showAllTemplate&&(t.showAllTemplate=!0),JSON.stringify(t)},url:"api/template-manage",contentType:"application/json",type:"POST",beforeSend:function(){},complete:function(){}}).withDataProp("data").withOption("order",[[3,"desc"]]).withOption("serverSide",!0).withOption("processing",!0).withOption("fnPreDrawCallback",function(){return!0}).withOption("fnDrawCallback",function(){v()}).withOption("language",{}).withPaginationType("full_numbers").withOption("createdRow",function(t,a,n){l(angular.element(t).contents())(e)}),e.dtColumnsTemplateManage=[i.newColumn(null).withTitle("Acciones").withOption("width",150).notSortable().renderWith(function(e,t,a,n){var i=e.hasFile,o="api/template-manage/download?id="+e.id,l="",r="",s=('<a target="_self" class="btn btn-primary btn-xs editRow lnk" href="#" uib-tooltip="Editar" data-id="'+e.id+'" '+r+'  >   <i class="fa fa-edit"></i></a> ','<a target="_self" class="btn btn-success btn-xs downloadDocumentRow lnk" href="'+o+'" uib-tooltip="Descargar" data-id="'+e.id+'" >   <i class="fa fa-download"></i></a> '),u='<a class="btn btn-info btn-xs pubRow lnk" href="#"  uib-tooltip="Publicar" data-id="'+e.id+'"'+r+' >   <i class="fa fa-play"></i></a> ';return i&&(l+=s,l+="Activo"==e.status?u:""),l}),i.newColumn("createdAt").withTitle("Fecha Creación").withOption("type","date").withOption("width",200).renderWith(function(e,t,a,n){return f(e.date).format("DD/MM/YYYY")}),i.newColumn("template").withTitle("Plantilla").withOption("width",200).withOption("defaultContent",""),i.newColumn("filename").withTitle("Archivo").withOption("width",200).withOption("defaultContent",""),i.newColumn("dateOf").withTitle("Fecha Publicación").withOption("type","date").withOption("width",200).renderWith(function(e,t,a,n){return f(e).format("DD/MM/YYYY")}),i.newColumn("description").withTitle("Descripción").withOption("width",200).withOption("defaultContent",""),i.newColumn("version").withTitle("Versión").withOption("width",200).withOption("defaultContent",""),i.newColumn(null).withTitle("Estado").withOption("width",200).renderWith(function(e,t,a,n){var i="label label-success",o=e.status;"Activo"==e.status&&(i="label label-info");var l='<span class="'+i+'">'+o+"</span>";return l})];var v=function(){$("#dtTemplateManage a.editRow").on("click",function(){var t=$(this).data("id");e.onAddTemplateManage(t)}),$("#dtTemplateManage a.downloadRow").on("click",function(){var e=$(this).data("id");jQuery("#downloadDocument")[0].src="api/template-manage/download?id="+e}),$("#dtTemplateManage a.pubRow").on("click",function(){var t=$(this).data("id");g.info("intenta eliminar el registro: "+t),c.swal({title:"Está seguro?",text:"Publicará la plantilla seleccionada.",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Si, publicar!",cancelButtonText:"No, cancelar!",closeOnConfirm:!0,closeOnCancel:!0},function(n){if(n){var i={};i.id=t,d({method:"POST",url:"api/template-manage/publish",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(i)}).then(function(e){swal("Publicado","Plantilla publicada satisfactoriamente","info")})["catch"](function(e){a.error(e),c.swal("Error en la publicación","Se ha presentado un error durante la publicación de la plantilla. Por favor inténtelo de nuevo, si el error persiste, comuníquese con el administrador del sistema","error")})["finally"](function(){e.reloadData()})}else swal("Cancelación","La operación ha sido cancelada","error")})})};e.dtInstanceTemplateManageCallback=function(t){e.dtInstanceTemplateManage=t},e.reloadData=function(){e.dtInstanceTemplateManage.reloadData()},e.onShowAllChange=function(){e.reloadData()},e.onCreate=function(){e.onAddTemplateManage(0)},e.addFilter=function(){null==e.audit.filters&&(e.audit.filters=[]),e.audit.filters.push({id:0,field:null,criteria:null,condition:null,value:""})},e.onFilter=function(){e.reloadData()},e.removeFilter=function(t){e.audit.filters.splice(t,1),0==e.audit.filters.length&&e.reloadData()},e.onCleanFilter=function(){e.audit.filters=[],e.reloadData()},e.onAddTemplateManage=function(t){var a={id:t},n=p.open({templateUrl:u.app.views.urlRoot+"modules/configuration/template-manage/template_manage_modal.htm",placement:"right",size:"lg",backdrop:!0,controller:"ModalInstanceSideTemplateManageCtrl",scope:e,resolve:{resource:function(){return a}}});n.result.then(function(){e.reloadData()},function(){e.reloadData()})}}]),app.controller("ModalInstanceSideTemplateManageCtrl",["$rootScope","$stateParams","$scope","$uibModalInstance","resource","$log","$timeout","SweetAlert","$http","toaster","$filter","FileUploader","DTColumnBuilder","DTOptionsBuilder","$compile",function(e,t,a,n,i,o,l,r,s,u,c,d,p,f,m){a.uploader=new Flow,a.templateList=e.parameters("wg_import_template");var w=0,h=function(){a.templateManage={id:i.id?i.id:0,type:null,dateOf:null,name:"",author:"",subject:"",description:"",isActive:!0,keywords:[]}};h();var g=function(){if(a.templateManage.id){var e={id:a.templateManage.id};s({method:"GET",url:"api/template-manage",params:e})["catch"](function(e,t){if(403==t){var a=null!==e.message&&void 0!==e.message?e.message:"app.clientes.list";r.swal("No Autorizado","No estas autorizado para ver esta información.","error"),l(function(){$state.go(a)},3e3)}else 404==t?(r.swal("Información no disponible","Anexo no encontrado","error"),l(function(){$state.go("app.clientes.list")})):r.swal("Error","Se ha presentado un error al intentar acceder a la información del anexo","error")}).then(function(e){l(function(){a.templateManage=e.data.result,a.noImage=""==a.templateManage.cover,v()})})["finally"](function(){l(function(){a.loading=!1},400)})}};g();var v=function(){null!=a.templateManage.dateOf&&(a.templateManage.dateOf=new Date(a.templateManage.dateOf.date))};a.removeImage=function(){a.noImage=!0};var C=a.uploaderResource=new d({url:"api/template-manage/upload",formData:[]});C.filters.push({name:"customFilter",fn:function(e,t){return this.queue.length<10}}),C.onBeforeUploadItem=function(e){console.info("onBeforeUploadItem",e);var t={id:w};e.formData.push(t)},C.onCompleteAll=function(){console.info("onCompleteAll"),u.pop("success","Operación Exitosa","La información ha sido guardada satisfactoriamente"),a.onCloseModal()},a.onCloseModal=function(){n.close(1)},a.onCancel=function(){n.dismiss("cancel")},a.form={submit:function(e){var t=null;if(e.$invalid){var n=null,t=null;for(n in e)"$"!=n[0]&&(null!==t||e[n].$valid||(t=e[n].$name),e[n].$pristine&&(e[n].$dirty=!0));return angular.element(".ng-invalid[name="+t+"]").focus(),void l(function(){u.pop("error","Error","Por favor verifique los datos requeridos del formulario y vuelva a intentarlo")},500)}return 0==a.templateManage.id&&0==a.uploaderResource.queue.length?void r.swal("El formulario contiene errores!","Por favor seleccione un archivo e Intentalo de nuevo.","error"):void a.onSave()},reset:function(e){e.$setPristine(!0)}},a.onSave=function(){var e={},t=JSON.stringify(a.templateManage);return e.data=Base64.encode(t),s({method:"POST",url:"api/template-manage/save",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(e)}).then(function(e){l(function(){C.queue.length>0?(w=e.data.result.id,C.uploadAll()):(u.pop("success","Operación Exitosa","La información ha sido guardada satisfactoriamente"),a.onCloseModal())})})["catch"](function(e){o.error(e),u.pop("error","Error","Por favor ingrese los campos requeridos.")})["finally"](function(){})}}]);