<!-- start: PAGE TITLE -->
<section id="page-title">
    <div class="row">
        <div class="col-sm-8">
            <h1 class="mainTitle" translate="Plan de trabajo">Plan de trabajo</h1>
            <span class="mainDescription">Desde aquí podrá administrar el plan de trabajo.</span>
        </div>
        <!--<div ncy-breadcrumb></div>-->
    </div>
</section>
<!-- end: PAGE TITLE -->
<!-- start: PROJECT -->
<div class="container-fluid container-fullw bg-white">
    <div class="row">
        <div class="col-md-12">
            <!-- /// controller:  'UserCtrl' -  localtion: assets/js/controllers/userCtrl.js /// -->
            <div ng-controller="projectCtrl">
                <!-- start: USER uib-tabset -->
                <div class="row">
                    <div class="col-md-12">
                        <div class="margin-bottom-30" ng-if="isAdmin">
                            <button class="btn btn-primary btn-o btn-wide" ng-click="onAddProject()">
                                <i class="ti-plus"></i> Nueva actividad
                            </button>

                            <button class="btn btn-info btn-o btn-wide" ng-click="onBilling()">
                                <i class="ti-receipt"></i> Facturación
                            </button>

                            <button class="btn btn-primary btn-o btn-wide" ng-click="addEvent()" ng-if="false">
                                <i class="ti-control-shuffle"></i> Asignar proyecto
                            </button>
                        </div>
                    </div>
                </div>

                <uib-tabset class="tabbable">
                    <!-- start: TAB OVERVIEW -->
                    <uib-tab heading="Dashboard">
                        <div class="container-fluid container-fullw bg-white" ng-if="isAgent || isCustomer">
                            <div class="row">
                                <div class="col-sm-12">
                                    <div class="row">
                                        <div class="col-sm-3">
                                            <div class="form-group">
                                                <label>
                                                    <h5 class="over-title margin-bottom-15">
                                                        Filtrar <span class="text-bold">por año</span>
                                                    </h5>
                                                </label>

                                                <div class="input-group">
                                                    <ui-select ng-disabled="isview" ng-model="filter.selectedYear"
                                                        theme="bootstrap" on-select="changeYear($item, $model)">
                                                        <ui-select-match placeholder="- Seleccionar -">
                                                            [[$select.selected.item]]
                                                        </ui-select-match>
                                                        <ui-select-choices
                                                            repeat="item in years | filter: $select.search track by $index">
                                                            <div ng-bind-html="item.item | highlight: $select.search">
                                                            </div>
                                                        </ui-select-choices>
                                                    </ui-select>
                                                    <span class="input-group-btn">
                                                        <button ng-click="clearYear()" class="btn btn-default">
                                                            <span class="glyphicon glyphicon-trash"></span>
                                                        </button>
                                                    </span>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="col-sm-3">
                                            <div class="form-group">
                                                <label>
                                                    <h5 class="over-title margin-bottom-15">
                                                        Filtrar <span class="text-bold">por mes</span>
                                                    </h5>
                                                </label>

                                                <div class="input-group">
                                                    <ui-select ng-disabled="isview" ng-model="filter.selectedMonth"
                                                        theme="bootstrap" on-select="changeMonth($item, $model)">
                                                        <ui-select-match placeholder="- Seleccionar -">
                                                            [[$select.selected.item]]
                                                        </ui-select-match>
                                                        <ui-select-choices
                                                            repeat="item in months | filter: $select.search track by $index">
                                                            <div ng-bind-html="item.item | highlight: $select.search">
                                                            </div>
                                                        </ui-select-choices>
                                                    </ui-select>
                                                    <span class="input-group-btn">
                                                        <button ng-click="clearMonth()" class="btn btn-default">
                                                            <span class="glyphicon glyphicon-trash"></span>
                                                        </button>
                                                    </span>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="col-sm-3">
                                            <div class="form-group">
                                                <label>
                                                    <h5 class="over-title margin-bottom-15">
                                                        Filtrar <span class="text-bold">por Tipo</span>
                                                    </h5>
                                                </label>

                                                <div class="input-group">
                                                    <ui-select ng-disabled="isview" ng-model="filter.selectedType"
                                                        theme="bootstrap" on-select="changeType($item, $model)">
                                                        <ui-select-match placeholder="- Seleccionar -">
                                                            [[$select.selected.item]]
                                                        </ui-select-match>
                                                        <ui-select-choices
                                                            repeat="item in types | filter: $select.search track by $index">
                                                            <div ng-bind-html="item.item | highlight: $select.search">
                                                            </div>
                                                        </ui-select-choices>
                                                    </ui-select>
                                                    <span class="input-group-btn">
                                                        <button ng-click="clearType()" class="btn btn-default">
                                                            <span class="glyphicon glyphicon-trash"></span>
                                                        </button>
                                                    </span>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="col-sm-3">
                                            <div class="form-group">
                                                <label>
                                                    <h5 class="over-title margin-bottom-15">
                                                        Filtrar <span class="text-bold">por OdeS / Consecutivo</span>
                                                    </h5>
                                                </label>

                                                <div class="input-group">
                                                    <input type="text" placeholder="Ingrese la OdeS / Consecutivo"
                                                        class="form-control" name="os" ng-model="filter.selectedOS" />
                                                    <span class="input-group-btn">
                                                        <button ng-click="searchOS()" class="btn btn-default">
                                                            <span class="glyphicon glyphicon-search"></span>
                                                        </button>
                                                        <button ng-click="clearOS()" class="btn btn-default">
                                                            <span class="glyphicon glyphicon-trash"></span>
                                                        </button>
                                                    </span>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="col-sm-3" ng-if="isAgent">
                                            <div class="form-group">
                                                <label>
                                                    <h5 class="over-title margin-bottom-15">
                                                        Filtrar <span class="text-bold">por ARL</span>
                                                    </h5>
                                                </label>

                                                <div class="input-group">
                                                    <ui-select ng-disabled="isview" ng-model="filter.selectedARL"
                                                        theme="bootstrap" on-select="changeARL($item, $model)">
                                                        <ui-select-match placeholder="- Seleccionar -">
                                                            [[$select.selected.item]]
                                                        </ui-select-match>
                                                        <ui-select-choices
                                                            repeat="item in arls | filter: $select.search track by $index">
                                                            <div ng-bind-html="item.item | highlight: $select.search">
                                                            </div>
                                                        </ui-select-choices>
                                                    </ui-select>
                                                    <span class="input-group-btn">
                                                        <button ng-click="clearARL()" class="btn btn-default">
                                                            <span class="glyphicon glyphicon-trash"></span>
                                                        </button>
                                                    </span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="row" ng-if="isAgent">
                                <div class="col-sm-12">
                                    <div class="form-group">
                                        <label>
                                            <h5 class="over-title margin-bottom-15">
                                                Filtrar <span class="text-bold">por cliente</span>
                                            </h5>
                                        </label>

                                        <div class="input-group">
                                            <ui-select ng-disabled="isview" ng-model="filter.selectedCustomer"
                                                theme="bootstrap" on-select="changeCustomer($item, $model)">
                                                <ui-select-match placeholder="- Seleccionar -">
                                                    [[$select.selected.item]]
                                                </ui-select-match>
                                                <ui-select-choices
                                                    repeat="item in customerList | filter: $select.search track by $index">
                                                    <div ng-bind-html="item.item | highlight: $select.search"></div>
                                                </ui-select-choices>
                                            </ui-select>
                                            <span class="input-group-btn">
                                                <button ng-click="onSearchCustomer()" class="btn btn-default">
                                                    <span class="glyphicon glyphicon-search"></span>
                                                </button>
                                                <button ng-click="clearCustomer()" class="btn btn-default">
                                                    <span class="glyphicon glyphicon-trash"></span>
                                                </button>
                                            </span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="container-fluid container-fullw bg-white" ng-if="isAdmin">
                            <div class="row">
                                <div class="col-sm-12">
                                    <div class="row">
                                        <div class="col-sm-3">
                                            <div class="form-group">
                                                <label>
                                                    <h5 class="over-title margin-bottom-15">
                                                        Filtrar <span class="text-bold">por año</span>
                                                    </h5>
                                                </label>
                                                <div class="input-group">
                                                    <ui-select ng-disabled="isview" ng-model="filter.selectedYear"
                                                        theme="bootstrap" on-select="changeYear($item, $model)">
                                                        <ui-select-match placeholder="- Seleccionar -">
                                                            [[$select.selected.item]]
                                                        </ui-select-match>
                                                        <ui-select-choices
                                                            repeat="item in years | filter: $select.search track by $index">
                                                            <div ng-bind-html="item.item | highlight: $select.search">
                                                            </div>
                                                        </ui-select-choices>
                                                    </ui-select>
                                                    <span class="input-group-btn">
                                                        <button ng-click="clearYear()" class="btn btn-default">
                                                            <span class="glyphicon glyphicon-trash"></span>
                                                        </button>
                                                    </span>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="col-sm-3">
                                            <div class="form-group">
                                                <label>
                                                    <h5 class="over-title margin-bottom-15">
                                                        Filtrar <span class="text-bold">por mes</span>
                                                    </h5>
                                                </label>

                                                <div class="input-group">
                                                    <ui-select ng-disabled="isview" ng-model="filter.selectedMonth"
                                                        theme="bootstrap" on-select="changeMonth($item, $model)">
                                                        <ui-select-match placeholder="- Seleccionar -">
                                                            [[$select.selected.item]]
                                                        </ui-select-match>
                                                        <ui-select-choices
                                                            repeat="item in months | filter: $select.search track by $index">
                                                            <div ng-bind-html="item.item | highlight: $select.search">
                                                            </div>
                                                        </ui-select-choices>
                                                    </ui-select>
                                                    <span class="input-group-btn">
                                                        <button ng-click="clearMonth()" class="btn btn-default">
                                                            <span class="glyphicon glyphicon-trash"></span>
                                                        </button>
                                                    </span>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="col-sm-6">
                                            <div class="form-group">
                                                <label>
                                                    <h5 class="over-title margin-bottom-15">
                                                        Filtrar <span class="text-bold">por asesor</span>
                                                    </h5>
                                                </label>

                                                <div class="input-group">
                                                    <ui-select ng-disabled="isview" ng-model="filter.selectedAgent"
                                                        theme="bootstrap" on-select="changeAgent($item, $model)">
                                                        <ui-select-match placeholder="- Seleccionar -">
                                                            [[$select.selected.name]]
                                                        </ui-select-match>
                                                        <ui-select-choices
                                                            repeat="item in agentsFilter | filter: $select.search track by $index">
                                                            <div ng-bind-html="item.name | highlight: $select.search">
                                                            </div>
                                                        </ui-select-choices>
                                                    </ui-select>
                                                    <span class="input-group-btn">
                                                        <button ng-click="sendStatus()" class="btn btn-info"
                                                            ng-disabled="filter.selectedAgent == null || projects.length == 0">
                                                            <span class="glyphicon glyphicon-envelope"></span>
                                                            Enviar Estado
                                                        </button>
                                                        <button ng-click="clearAgent()" class="btn btn-default">
                                                            <span class="glyphicon glyphicon-trash"></span>
                                                        </button>
                                                    </span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="row">
                                        <div class="col-sm-3">
                                            <div class="form-group">
                                                <label>
                                                    <h5 class="over-title margin-bottom-15">
                                                        Filtrar <span class="text-bold">por Tipo</span>
                                                    </h5>
                                                </label>

                                                <div class="input-group">
                                                    <ui-select ng-disabled="isview" ng-model="filter.selectedType"
                                                        theme="bootstrap" on-select="changeType($item, $model)">
                                                        <ui-select-match placeholder="- Seleccionar -">
                                                            [[$select.selected.item]]
                                                        </ui-select-match>
                                                        <ui-select-choices
                                                            repeat="item in types | filter: $select.search track by $index">
                                                            <div ng-bind-html="item.item | highlight: $select.search">
                                                            </div>
                                                        </ui-select-choices>
                                                    </ui-select>
                                                    <span class="input-group-btn">
                                                        <button ng-click="clearType()" class="btn btn-default">
                                                            <span class="glyphicon glyphicon-trash"></span>
                                                        </button>
                                                    </span>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="col-sm-3">
                                            <div class="form-group">
                                                <label>
                                                    <h5 class="over-title margin-bottom-15">
                                                        Filtrar <span class="text-bold">por OdeS / Consecutivo</span>
                                                    </h5>
                                                </label>

                                                <div class="input-group">
                                                    <input type="text" placeholder="Ingrese la OdeS / Consecutivo"
                                                        class="form-control" name="os" ng-model="filter.selectedOS" />
                                                    <span class="input-group-btn">
                                                        <button ng-click="searchOS()" class="btn btn-default">
                                                            <span class="glyphicon glyphicon-search"></span>
                                                        </button>
                                                        <button ng-click="clearOS()" class="btn btn-default">
                                                            <span class="glyphicon glyphicon-trash"></span>
                                                        </button>
                                                    </span>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="col-sm-6">
                                            <div class="form-group">
                                                <label>
                                                    <h5 class="over-title margin-bottom-15">
                                                        Filtrar <span class="text-bold">por cliente</span>
                                                    </h5>
                                                </label>

                                                <div class="input-group">
                                                    <ui-select ng-disabled="isview" ng-model="filter.selectedCustomer"
                                                        theme="bootstrap" on-select="changeCustomer($item, $model)">
                                                        <ui-select-match placeholder="- Seleccionar -">
                                                            [[$select.selected.item]]
                                                        </ui-select-match>
                                                        <ui-select-choices
                                                            repeat="item in customerList | filter: $select.search track by $index">
                                                            <div ng-bind-html="item.item | highlight: $select.search">
                                                            </div>
                                                        </ui-select-choices>
                                                    </ui-select>
                                                    <span class="input-group-btn">
                                                        <button ng-click="onSearchCustomer()" class="btn btn-default"
                                                            uib-tooltip="Buscar cliente">
                                                            <span class="glyphicon glyphicon-search"></span>
                                                        </button>
                                                        <button ng-click="clearCustomer()" class="btn btn-default">
                                                            <span class="glyphicon glyphicon-trash"></span>
                                                        </button>
                                                    </span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="row">
                                        <div class="col-sm-3">
                                            <div class="form-group">
                                                <label>
                                                    <h5 class="over-title margin-bottom-15">
                                                        Filtrar <span class="text-bold">por ARL</span>
                                                    </h5>
                                                </label>

                                                <div class="input-group">
                                                    <ui-select ng-disabled="isview" ng-model="filter.selectedARL"
                                                        theme="bootstrap" on-select="changeARL($item, $model)">
                                                        <ui-select-match placeholder="- Seleccionar -">
                                                            [[$select.selected.item]]
                                                        </ui-select-match>
                                                        <ui-select-choices
                                                            repeat="item in arls | filter: $select.search track by $index">
                                                            <div ng-bind-html="item.item | highlight: $select.search">
                                                            </div>
                                                        </ui-select-choices>
                                                    </ui-select>
                                                    <span class="input-group-btn">
                                                        <button ng-click="clearARL()" class="btn btn-default">
                                                            <span class="glyphicon glyphicon-trash"></span>
                                                        </button>
                                                    </span>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="col-sm-3">
                                            <div class="form-group">
                                                <label>
                                                    <h5 class="over-title margin-bottom-15">
                                                        Filtrar <span class="text-bold">por administrador</span>
                                                    </h5>
                                                </label>

                                                <div class="input-group">
                                                    <ui-select ng-disabled="isview" ng-model="filter.administrator"
                                                        theme="bootstrap" on-select="changeAgent($item, $model)">
                                                        <ui-select-match placeholder="- Seleccionar -">
                                                            [[$select.selected.item]]
                                                        </ui-select-match>
                                                        <ui-select-choices
                                                            repeat="item in administratorList | filter: $select.search track by $index">
                                                            <div ng-bind-html="item.item | highlight: $select.search">
                                                            </div>
                                                        </ui-select-choices>
                                                    </ui-select>
                                                    <span class="input-group-btn">
                                                        <button ng-click="clearAdministrator()" class="btn btn-default">
                                                            <span class="glyphicon glyphicon-trash"></span>
                                                        </button>
                                                    </span>
                                                </div>
                                            </div>
                                        </div>

                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-12" style="background-color: #e6e8e8; padding-top: 10px;">
                                <div class="col-sm-12">
                                    <div class="panel panel-white no-radius">
                                        <div class="panel-heading border-bottom">
                                            <h4 class="panel-title"><span class="text-bold"></span></h4>
                                        </div>
                                        <div class="panel-body">
                                            <div class="row">
                                                <div class="col-md-4">
                                                    <div class="user-left">
                                                        <div class="center">
                                                            <div class="text-center">
                                                                <canvas class="tc-chart" tc-chartjs-doughnut
                                                                    chart-options="chart.doughnut.options"
                                                                    chart-data="chart.summary.data" height="200">
                                                                </canvas>
                                                                <!--<span class="mini-pie">

                                                                </span>      -->
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>

                                                <div class="col-md-8">
                                                    <div class="row">
                                                        <div class="col-md-12">
                                                            <h5 class="over-title margin-bottom-15">
                                                                <span class="text-bold">Actividades del mes</span>
                                                            </h5>

                                                            <p>
                                                                Resumen de las actividades asignadas para el presente
                                                                mes
                                                            </p>
                                                        </div>
                                                    </div>

                                                    <div class="row">
                                                        <div class="col-md-12">
                                                            <div class="margin-bottom-30">
                                                                <div class="col-xs-12 text-center no-padding">
                                                                    <span
                                                                        class="text-bold block text-extra-large">[[projectSummary.availabilityHours]]</span>
                                                                    <span class="text-light">Horas disponibles</span>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="panel-footer">
                                            <div class="clearfix padding-5 space5">
                                                <div class="col-xs-4 text-center no-padding">
                                                    <div class="border-right border-dark">
                                                        <span
                                                            class="text-bold block text-extra-large">[[projectSummary.assignedHours]]</span>
                                                        <span class="text-light">Horas asignadas</span>
                                                    </div>
                                                </div>
                                                <div class="col-xs-4 text-center no-padding">
                                                    <div class="border-right border-dark">
                                                        <span
                                                            class="text-bold block text-extra-large">[[projectSummary.scheduledHours]]</span>
                                                        <span class="text-light">Horas programadas</span>
                                                    </div>
                                                </div>
                                                <div class="col-xs-4 text-center no-padding">
                                                    <span
                                                        class="text-bold block text-extra-large">[[projectSummary.runningHours]]</span>
                                                    <span class="text-light">Horas ejecutadas</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>


                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-12">
                                <div class="panel panel-white margin-top-20">
                                    <div class="panel-heading border-light">
                                        <h4 class="panel-title text-primary text-bold">ACTIVIDADES</h4>
                                        <paneltool class="panel-tools" tool-collapse="tool-collapse"
                                            tool-refresh="load1" tool-dismiss="tool-dismiss"></paneltool>
                                    </div>
                                    <div class="panel-body">
                                        <div class="table-responsive" style="width: 100%;" ng-if="canShowTable">
                                            <div kendo-grid="grid" k-options="mainGridOptions"
                                                k-ng-delay="mainGridOptions" auto-resize-div>

                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-12">
                                <div class="panel panel-white" id="activities">
                                    <div class="panel-heading border-light">
                                        <h4 class="panel-title text-primary text-bold">TAREAS RECIENTES</h4>
                                        <paneltool class="panel-tools" tool-collapse="tool-collapse"
                                            tool-refresh="load1" tool-dismiss="tool-dismiss"></paneltool>
                                    </div>
                                    <div collapse="activities" ng-init="activities=false" class="panel-wrapper">
                                        <div class="panel-body">
                                            <ul class="timeline-xs">
                                                <li ng-repeat="task in recentTasks" class="[[task.type]]">
                                                    <div class="margin-left-15">
                                                        <div class="text-muted text-small">
                                                            [[task.time]]
                                                        </div>
                                                        <p>
                                                            [[task.description]]
                                                        </p>
                                                    </div>
                                                </li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </uib-tab>
                    <!-- end: TAB OVERVIEW -->
                    <!-- start: TAB PROJECTS -->
                    <!-- end: TAB PROJECTS -->
                </uib-tabset>
                <!-- end: USER uib-tabset -->
            </div>
        </div>
    </div>
</div>
<!-- end: PROJECT -->